var commonjsGlobal=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},buffer$1={},base64Js={};base64Js.byteLength=byteLength,base64Js.toByteArray=toByteArray,base64Js.fromByteArray=fromByteArray;for(var lookup=[],revLookup=[],Arr=typeof Uint8Array!="undefined"?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i$2=0,len=code.length;i$2<len;++i$2)lookup[i$2]=code[i$2],revLookup[code.charCodeAt(i$2)]=i$2;revLookup[45]=62,revLookup[95]=63;function getLens(r){var g=r.length;if(g%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var l=r.indexOf("=");l===-1&&(l=g);var v=l===g?0:4-l%4;return[l,v]}function byteLength(r){var g=getLens(r),l=g[0],v=g[1];return(l+v)*3/4-v}function _byteLength(r,g,l){return(g+l)*3/4-l}function toByteArray(r){var g,l=getLens(r),v=l[0],I=l[1],D=new Arr(_byteLength(r,v,I)),L=0,S=I>0?v-4:v,ee;for(ee=0;ee<S;ee+=4)g=revLookup[r.charCodeAt(ee)]<<18|revLookup[r.charCodeAt(ee+1)]<<12|revLookup[r.charCodeAt(ee+2)]<<6|revLookup[r.charCodeAt(ee+3)],D[L++]=g>>16&255,D[L++]=g>>8&255,D[L++]=g&255;return I===2&&(g=revLookup[r.charCodeAt(ee)]<<2|revLookup[r.charCodeAt(ee+1)]>>4,D[L++]=g&255),I===1&&(g=revLookup[r.charCodeAt(ee)]<<10|revLookup[r.charCodeAt(ee+1)]<<4|revLookup[r.charCodeAt(ee+2)]>>2,D[L++]=g>>8&255,D[L++]=g&255),D}function tripletToBase64(r){return lookup[r>>18&63]+lookup[r>>12&63]+lookup[r>>6&63]+lookup[r&63]}function encodeChunk(r,g,l){for(var v,I=[],D=g;D<l;D+=3)v=(r[D]<<16&16711680)+(r[D+1]<<8&65280)+(r[D+2]&255),I.push(tripletToBase64(v));return I.join("")}function fromByteArray(r){for(var g,l=r.length,v=l%3,I=[],D=16383,L=0,S=l-v;L<S;L+=D)I.push(encodeChunk(r,L,L+D>S?S:L+D));return v===1?(g=r[l-1],I.push(lookup[g>>2]+lookup[g<<4&63]+"==")):v===2&&(g=(r[l-2]<<8)+r[l-1],I.push(lookup[g>>10]+lookup[g>>4&63]+lookup[g<<2&63]+"=")),I.join("")}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ieee754.read=function(r,g,l,v,I){var D,L,S=I*8-v-1,ee=(1<<S)-1,U=ee>>1,Y=-7,$e=l?I-1:0,_e=l?-1:1,ve=r[g+$e];for($e+=_e,D=ve&(1<<-Y)-1,ve>>=-Y,Y+=S;Y>0;D=D*256+r[g+$e],$e+=_e,Y-=8);for(L=D&(1<<-Y)-1,D>>=-Y,Y+=v;Y>0;L=L*256+r[g+$e],$e+=_e,Y-=8);if(D===0)D=1-U;else{if(D===ee)return L?NaN:(ve?-1:1)*(1/0);L=L+Math.pow(2,v),D=D-U}return(ve?-1:1)*L*Math.pow(2,D-v)},ieee754.write=function(r,g,l,v,I,D){var L,S,ee,U=D*8-I-1,Y=(1<<U)-1,$e=Y>>1,_e=I===23?Math.pow(2,-24)-Math.pow(2,-77):0,ve=v?0:D-1,we=v?1:-1,Se=g<0||g===0&&1/g<0?1:0;for(g=Math.abs(g),isNaN(g)||g===1/0?(S=isNaN(g)?1:0,L=Y):(L=Math.floor(Math.log(g)/Math.LN2),g*(ee=Math.pow(2,-L))<1&&(L--,ee*=2),L+$e>=1?g+=_e/ee:g+=_e*Math.pow(2,1-$e),g*ee>=2&&(L++,ee/=2),L+$e>=Y?(S=0,L=Y):L+$e>=1?(S=(g*ee-1)*Math.pow(2,I),L=L+$e):(S=g*Math.pow(2,$e-1)*Math.pow(2,I),L=0));I>=8;r[l+ve]=S&255,ve+=we,S/=256,I-=8);for(L=L<<I|S,U+=I;U>0;r[l+ve]=L&255,ve+=we,L/=256,U-=8);r[l+ve-we]|=Se*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(r){const g=base64Js,l=ieee754,v=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=S,r.SlowBuffer=Ce,r.INSPECT_MAX_BYTES=50;const I=2147483647;r.kMaxLength=I,S.TYPED_ARRAY_SUPPORT=D(),!S.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function D(){try{const z=new Uint8Array(1),y={foo:function(){return 42}};return Object.setPrototypeOf(y,Uint8Array.prototype),Object.setPrototypeOf(z,y),z.foo()===42}catch(z){return!1}}Object.defineProperty(S.prototype,"parent",{enumerable:!0,get:function(){if(S.isBuffer(this))return this.buffer}}),Object.defineProperty(S.prototype,"offset",{enumerable:!0,get:function(){if(S.isBuffer(this))return this.byteOffset}});function L(z){if(z>I)throw new RangeError('The value "'+z+'" is invalid for option "size"');const y=new Uint8Array(z);return Object.setPrototypeOf(y,S.prototype),y}function S(z,y,O){if(typeof z=="number"){if(typeof y=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return $e(z)}return ee(z,y,O)}S.poolSize=8192;function ee(z,y,O){if(typeof z=="string")return _e(z,y);if(ArrayBuffer.isView(z))return we(z);if(z==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof z);if(st(z,ArrayBuffer)||z&&st(z.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(st(z,SharedArrayBuffer)||z&&st(z.buffer,SharedArrayBuffer)))return Se(z,y,O);if(typeof z=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const Ee=z.valueOf&&z.valueOf();if(Ee!=null&&Ee!==z)return S.from(Ee,y,O);const be=Ie(z);if(be)return be;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof z[Symbol.toPrimitive]=="function")return S.from(z[Symbol.toPrimitive]("string"),y,O);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof z)}S.from=function(z,y,O){return ee(z,y,O)},Object.setPrototypeOf(S.prototype,Uint8Array.prototype),Object.setPrototypeOf(S,Uint8Array);function U(z){if(typeof z!="number")throw new TypeError('"size" argument must be of type number');if(z<0)throw new RangeError('The value "'+z+'" is invalid for option "size"')}function Y(z,y,O){return U(z),z<=0?L(z):y!==void 0?typeof O=="string"?L(z).fill(y,O):L(z).fill(y):L(z)}S.alloc=function(z,y,O){return Y(z,y,O)};function $e(z){return U(z),L(z<0?0:Ne(z)|0)}S.allocUnsafe=function(z){return $e(z)},S.allocUnsafeSlow=function(z){return $e(z)};function _e(z,y){if((typeof y!="string"||y==="")&&(y="utf8"),!S.isEncoding(y))throw new TypeError("Unknown encoding: "+y);const O=Be(z,y)|0;let Ee=L(O);const be=Ee.write(z,y);return be!==O&&(Ee=Ee.slice(0,be)),Ee}function ve(z){const y=z.length<0?0:Ne(z.length)|0,O=L(y);for(let Ee=0;Ee<y;Ee+=1)O[Ee]=z[Ee]&255;return O}function we(z){if(st(z,Uint8Array)){const y=new Uint8Array(z);return Se(y.buffer,y.byteOffset,y.byteLength)}return ve(z)}function Se(z,y,O){if(y<0||z.byteLength<y)throw new RangeError('"offset" is outside of buffer bounds');if(z.byteLength<y+(O||0))throw new RangeError('"length" is outside of buffer bounds');let Ee;return y===void 0&&O===void 0?Ee=new Uint8Array(z):O===void 0?Ee=new Uint8Array(z,y):Ee=new Uint8Array(z,y,O),Object.setPrototypeOf(Ee,S.prototype),Ee}function Ie(z){if(S.isBuffer(z)){const y=Ne(z.length)|0,O=L(y);return O.length===0||z.copy(O,0,0,y),O}if(z.length!==void 0)return typeof z.length!="number"||wt(z.length)?L(0):ve(z);if(z.type==="Buffer"&&Array.isArray(z.data))return ve(z.data)}function Ne(z){if(z>=I)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+I.toString(16)+" bytes");return z|0}function Ce(z){return+z!=z&&(z=0),S.alloc(+z)}S.isBuffer=function(y){return y!=null&&y._isBuffer===!0&&y!==S.prototype},S.compare=function(y,O){if(st(y,Uint8Array)&&(y=S.from(y,y.offset,y.byteLength)),st(O,Uint8Array)&&(O=S.from(O,O.offset,O.byteLength)),!S.isBuffer(y)||!S.isBuffer(O))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(y===O)return 0;let Ee=y.length,be=O.length;for(let Ae=0,ke=Math.min(Ee,be);Ae<ke;++Ae)if(y[Ae]!==O[Ae]){Ee=y[Ae],be=O[Ae];break}return Ee<be?-1:be<Ee?1:0},S.isEncoding=function(y){switch(String(y).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},S.concat=function(y,O){if(!Array.isArray(y))throw new TypeError('"list" argument must be an Array of Buffers');if(y.length===0)return S.alloc(0);let Ee;if(O===void 0)for(O=0,Ee=0;Ee<y.length;++Ee)O+=y[Ee].length;const be=S.allocUnsafe(O);let Ae=0;for(Ee=0;Ee<y.length;++Ee){let ke=y[Ee];if(st(ke,Uint8Array))Ae+ke.length>be.length?(S.isBuffer(ke)||(ke=S.from(ke)),ke.copy(be,Ae)):Uint8Array.prototype.set.call(be,ke,Ae);else if(S.isBuffer(ke))ke.copy(be,Ae);else throw new TypeError('"list" argument must be an Array of Buffers');Ae+=ke.length}return be};function Be(z,y){if(S.isBuffer(z))return z.length;if(ArrayBuffer.isView(z)||st(z,ArrayBuffer))return z.byteLength;if(typeof z!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof z);const O=z.length,Ee=arguments.length>2&&arguments[2]===!0;if(!Ee&&O===0)return 0;let be=!1;for(;;)switch(y){case"ascii":case"latin1":case"binary":return O;case"utf8":case"utf-8":return et(z).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O*2;case"hex":return O>>>1;case"base64":return gt(z).length;default:if(be)return Ee?-1:et(z).length;y=(""+y).toLowerCase(),be=!0}}S.byteLength=Be;function Re(z,y,O){let Ee=!1;if((y===void 0||y<0)&&(y=0),y>this.length||((O===void 0||O>this.length)&&(O=this.length),O<=0)||(O>>>=0,y>>>=0,O<=y))return"";for(z||(z="utf8");;)switch(z){case"hex":return ft(this,y,O);case"utf8":case"utf-8":return Ye(this,y,O);case"ascii":return Ze(this,y,O);case"latin1":case"binary":return at(this,y,O);case"base64":return rt(this,y,O);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ut(this,y,O);default:if(Ee)throw new TypeError("Unknown encoding: "+z);z=(z+"").toLowerCase(),Ee=!0}}S.prototype._isBuffer=!0;function Oe(z,y,O){const Ee=z[y];z[y]=z[O],z[O]=Ee}S.prototype.swap16=function(){const y=this.length;if(y%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let O=0;O<y;O+=2)Oe(this,O,O+1);return this},S.prototype.swap32=function(){const y=this.length;if(y%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let O=0;O<y;O+=4)Oe(this,O,O+3),Oe(this,O+1,O+2);return this},S.prototype.swap64=function(){const y=this.length;if(y%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let O=0;O<y;O+=8)Oe(this,O,O+7),Oe(this,O+1,O+6),Oe(this,O+2,O+5),Oe(this,O+3,O+4);return this},S.prototype.toString=function(){const y=this.length;return y===0?"":arguments.length===0?Ye(this,0,y):Re.apply(this,arguments)},S.prototype.toLocaleString=S.prototype.toString,S.prototype.equals=function(y){if(!S.isBuffer(y))throw new TypeError("Argument must be a Buffer");return this===y?!0:S.compare(this,y)===0},S.prototype.inspect=function(){let y="";const O=r.INSPECT_MAX_BYTES;return y=this.toString("hex",0,O).replace(/(.{2})/g,"$1 ").trim(),this.length>O&&(y+=" ... "),"<Buffer "+y+">"},v&&(S.prototype[v]=S.prototype.inspect),S.prototype.compare=function(y,O,Ee,be,Ae){if(st(y,Uint8Array)&&(y=S.from(y,y.offset,y.byteLength)),!S.isBuffer(y))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof y);if(O===void 0&&(O=0),Ee===void 0&&(Ee=y?y.length:0),be===void 0&&(be=0),Ae===void 0&&(Ae=this.length),O<0||Ee>y.length||be<0||Ae>this.length)throw new RangeError("out of range index");if(be>=Ae&&O>=Ee)return 0;if(be>=Ae)return-1;if(O>=Ee)return 1;if(O>>>=0,Ee>>>=0,be>>>=0,Ae>>>=0,this===y)return 0;let ke=Ae-be,ze=Ee-O;const Je=Math.min(ke,ze),Ke=this.slice(be,Ae),qe=y.slice(O,Ee);for(let Ge=0;Ge<Je;++Ge)if(Ke[Ge]!==qe[Ge]){ke=Ke[Ge],ze=qe[Ge];break}return ke<ze?-1:ze<ke?1:0};function Ue(z,y,O,Ee,be){if(z.length===0)return-1;if(typeof O=="string"?(Ee=O,O=0):O>2147483647?O=2147483647:O<-2147483648&&(O=-2147483648),O=+O,wt(O)&&(O=be?0:z.length-1),O<0&&(O=z.length+O),O>=z.length){if(be)return-1;O=z.length-1}else if(O<0)if(be)O=0;else return-1;if(typeof y=="string"&&(y=S.from(y,Ee)),S.isBuffer(y))return y.length===0?-1:Le(z,y,O,Ee,be);if(typeof y=="number")return y=y&255,typeof Uint8Array.prototype.indexOf=="function"?be?Uint8Array.prototype.indexOf.call(z,y,O):Uint8Array.prototype.lastIndexOf.call(z,y,O):Le(z,[y],O,Ee,be);throw new TypeError("val must be string, number or Buffer")}function Le(z,y,O,Ee,be){let Ae=1,ke=z.length,ze=y.length;if(Ee!==void 0&&(Ee=String(Ee).toLowerCase(),Ee==="ucs2"||Ee==="ucs-2"||Ee==="utf16le"||Ee==="utf-16le")){if(z.length<2||y.length<2)return-1;Ae=2,ke/=2,ze/=2,O/=2}function Je(qe,Ge){return Ae===1?qe[Ge]:qe.readUInt16BE(Ge*Ae)}let Ke;if(be){let qe=-1;for(Ke=O;Ke<ke;Ke++)if(Je(z,Ke)===Je(y,qe===-1?0:Ke-qe)){if(qe===-1&&(qe=Ke),Ke-qe+1===ze)return qe*Ae}else qe!==-1&&(Ke-=Ke-qe),qe=-1}else for(O+ze>ke&&(O=ke-ze),Ke=O;Ke>=0;Ke--){let qe=!0;for(let Ge=0;Ge<ze;Ge++)if(Je(z,Ke+Ge)!==Je(y,Ge)){qe=!1;break}if(qe)return Ke}return-1}S.prototype.includes=function(y,O,Ee){return this.indexOf(y,O,Ee)!==-1},S.prototype.indexOf=function(y,O,Ee){return Ue(this,y,O,Ee,!0)},S.prototype.lastIndexOf=function(y,O,Ee){return Ue(this,y,O,Ee,!1)};function Me(z,y,O,Ee){O=Number(O)||0;const be=z.length-O;Ee?(Ee=Number(Ee),Ee>be&&(Ee=be)):Ee=be;const Ae=y.length;Ee>Ae/2&&(Ee=Ae/2);let ke;for(ke=0;ke<Ee;++ke){const ze=parseInt(y.substr(ke*2,2),16);if(wt(ze))return ke;z[O+ke]=ze}return ke}function xe(z,y,O,Ee){return dt(et(y,z.length-O),z,O,Ee)}function He(z,y,O,Ee){return dt(lt(y),z,O,Ee)}function Fe(z,y,O,Ee){return dt(gt(y),z,O,Ee)}function Pe(z,y,O,Ee){return dt(vt(y,z.length-O),z,O,Ee)}S.prototype.write=function(y,O,Ee,be){if(O===void 0)be="utf8",Ee=this.length,O=0;else if(Ee===void 0&&typeof O=="string")be=O,Ee=this.length,O=0;else if(isFinite(O))O=O>>>0,isFinite(Ee)?(Ee=Ee>>>0,be===void 0&&(be="utf8")):(be=Ee,Ee=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Ae=this.length-O;if((Ee===void 0||Ee>Ae)&&(Ee=Ae),y.length>0&&(Ee<0||O<0)||O>this.length)throw new RangeError("Attempt to write outside buffer bounds");be||(be="utf8");let ke=!1;for(;;)switch(be){case"hex":return Me(this,y,O,Ee);case"utf8":case"utf-8":return xe(this,y,O,Ee);case"ascii":case"latin1":case"binary":return He(this,y,O,Ee);case"base64":return Fe(this,y,O,Ee);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Pe(this,y,O,Ee);default:if(ke)throw new TypeError("Unknown encoding: "+be);be=(""+be).toLowerCase(),ke=!0}},S.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function rt(z,y,O){return y===0&&O===z.length?g.fromByteArray(z):g.fromByteArray(z.slice(y,O))}function Ye(z,y,O){O=Math.min(z.length,O);const Ee=[];let be=y;for(;be<O;){const Ae=z[be];let ke=null,ze=Ae>239?4:Ae>223?3:Ae>191?2:1;if(be+ze<=O){let Je,Ke,qe,Ge;switch(ze){case 1:Ae<128&&(ke=Ae);break;case 2:Je=z[be+1],(Je&192)===128&&(Ge=(Ae&31)<<6|Je&63,Ge>127&&(ke=Ge));break;case 3:Je=z[be+1],Ke=z[be+2],(Je&192)===128&&(Ke&192)===128&&(Ge=(Ae&15)<<12|(Je&63)<<6|Ke&63,Ge>2047&&(Ge<55296||Ge>57343)&&(ke=Ge));break;case 4:Je=z[be+1],Ke=z[be+2],qe=z[be+3],(Je&192)===128&&(Ke&192)===128&&(qe&192)===128&&(Ge=(Ae&15)<<18|(Je&63)<<12|(Ke&63)<<6|qe&63,Ge>65535&&Ge<1114112&&(ke=Ge))}}ke===null?(ke=65533,ze=1):ke>65535&&(ke-=65536,Ee.push(ke>>>10&1023|55296),ke=56320|ke&1023),Ee.push(ke),be+=ze}return nt(Ee)}const it=4096;function nt(z){const y=z.length;if(y<=it)return String.fromCharCode.apply(String,z);let O="",Ee=0;for(;Ee<y;)O+=String.fromCharCode.apply(String,z.slice(Ee,Ee+=it));return O}function Ze(z,y,O){let Ee="";O=Math.min(z.length,O);for(let be=y;be<O;++be)Ee+=String.fromCharCode(z[be]&127);return Ee}function at(z,y,O){let Ee="";O=Math.min(z.length,O);for(let be=y;be<O;++be)Ee+=String.fromCharCode(z[be]);return Ee}function ft(z,y,O){const Ee=z.length;(!y||y<0)&&(y=0),(!O||O<0||O>Ee)&&(O=Ee);let be="";for(let Ae=y;Ae<O;++Ae)be+=yt[z[Ae]];return be}function ut(z,y,O){const Ee=z.slice(y,O);let be="";for(let Ae=0;Ae<Ee.length-1;Ae+=2)be+=String.fromCharCode(Ee[Ae]+Ee[Ae+1]*256);return be}S.prototype.slice=function(y,O){const Ee=this.length;y=~~y,O=O===void 0?Ee:~~O,y<0?(y+=Ee,y<0&&(y=0)):y>Ee&&(y=Ee),O<0?(O+=Ee,O<0&&(O=0)):O>Ee&&(O=Ee),O<y&&(O=y);const be=this.subarray(y,O);return Object.setPrototypeOf(be,S.prototype),be};function We(z,y,O){if(z%1!==0||z<0)throw new RangeError("offset is not uint");if(z+y>O)throw new RangeError("Trying to access beyond buffer length")}S.prototype.readUintLE=S.prototype.readUIntLE=function(y,O,Ee){y=y>>>0,O=O>>>0,Ee||We(y,O,this.length);let be=this[y],Ae=1,ke=0;for(;++ke<O&&(Ae*=256);)be+=this[y+ke]*Ae;return be},S.prototype.readUintBE=S.prototype.readUIntBE=function(y,O,Ee){y=y>>>0,O=O>>>0,Ee||We(y,O,this.length);let be=this[y+--O],Ae=1;for(;O>0&&(Ae*=256);)be+=this[y+--O]*Ae;return be},S.prototype.readUint8=S.prototype.readUInt8=function(y,O){return y=y>>>0,O||We(y,1,this.length),this[y]},S.prototype.readUint16LE=S.prototype.readUInt16LE=function(y,O){return y=y>>>0,O||We(y,2,this.length),this[y]|this[y+1]<<8},S.prototype.readUint16BE=S.prototype.readUInt16BE=function(y,O){return y=y>>>0,O||We(y,2,this.length),this[y]<<8|this[y+1]},S.prototype.readUint32LE=S.prototype.readUInt32LE=function(y,O){return y=y>>>0,O||We(y,4,this.length),(this[y]|this[y+1]<<8|this[y+2]<<16)+this[y+3]*16777216},S.prototype.readUint32BE=S.prototype.readUInt32BE=function(y,O){return y=y>>>0,O||We(y,4,this.length),this[y]*16777216+(this[y+1]<<16|this[y+2]<<8|this[y+3])},S.prototype.readBigUInt64LE=ht(function(y){y=y>>>0,Xe(y,"offset");const O=this[y],Ee=this[y+7];(O===void 0||Ee===void 0)&&tt(y,this.length-8);const be=O+this[++y]*2**8+this[++y]*2**16+this[++y]*2**24,Ae=this[++y]+this[++y]*2**8+this[++y]*2**16+Ee*2**24;return BigInt(be)+(BigInt(Ae)<<BigInt(32))}),S.prototype.readBigUInt64BE=ht(function(y){y=y>>>0,Xe(y,"offset");const O=this[y],Ee=this[y+7];(O===void 0||Ee===void 0)&&tt(y,this.length-8);const be=O*2**24+this[++y]*2**16+this[++y]*2**8+this[++y],Ae=this[++y]*2**24+this[++y]*2**16+this[++y]*2**8+Ee;return(BigInt(be)<<BigInt(32))+BigInt(Ae)}),S.prototype.readIntLE=function(y,O,Ee){y=y>>>0,O=O>>>0,Ee||We(y,O,this.length);let be=this[y],Ae=1,ke=0;for(;++ke<O&&(Ae*=256);)be+=this[y+ke]*Ae;return Ae*=128,be>=Ae&&(be-=Math.pow(2,8*O)),be},S.prototype.readIntBE=function(y,O,Ee){y=y>>>0,O=O>>>0,Ee||We(y,O,this.length);let be=O,Ae=1,ke=this[y+--be];for(;be>0&&(Ae*=256);)ke+=this[y+--be]*Ae;return Ae*=128,ke>=Ae&&(ke-=Math.pow(2,8*O)),ke},S.prototype.readInt8=function(y,O){return y=y>>>0,O||We(y,1,this.length),this[y]&128?(255-this[y]+1)*-1:this[y]},S.prototype.readInt16LE=function(y,O){y=y>>>0,O||We(y,2,this.length);const Ee=this[y]|this[y+1]<<8;return Ee&32768?Ee|4294901760:Ee},S.prototype.readInt16BE=function(y,O){y=y>>>0,O||We(y,2,this.length);const Ee=this[y+1]|this[y]<<8;return Ee&32768?Ee|4294901760:Ee},S.prototype.readInt32LE=function(y,O){return y=y>>>0,O||We(y,4,this.length),this[y]|this[y+1]<<8|this[y+2]<<16|this[y+3]<<24},S.prototype.readInt32BE=function(y,O){return y=y>>>0,O||We(y,4,this.length),this[y]<<24|this[y+1]<<16|this[y+2]<<8|this[y+3]},S.prototype.readBigInt64LE=ht(function(y){y=y>>>0,Xe(y,"offset");const O=this[y],Ee=this[y+7];(O===void 0||Ee===void 0)&&tt(y,this.length-8);const be=this[y+4]+this[y+5]*2**8+this[y+6]*2**16+(Ee<<24);return(BigInt(be)<<BigInt(32))+BigInt(O+this[++y]*2**8+this[++y]*2**16+this[++y]*2**24)}),S.prototype.readBigInt64BE=ht(function(y){y=y>>>0,Xe(y,"offset");const O=this[y],Ee=this[y+7];(O===void 0||Ee===void 0)&&tt(y,this.length-8);const be=(O<<24)+this[++y]*2**16+this[++y]*2**8+this[++y];return(BigInt(be)<<BigInt(32))+BigInt(this[++y]*2**24+this[++y]*2**16+this[++y]*2**8+Ee)}),S.prototype.readFloatLE=function(y,O){return y=y>>>0,O||We(y,4,this.length),l.read(this,y,!0,23,4)},S.prototype.readFloatBE=function(y,O){return y=y>>>0,O||We(y,4,this.length),l.read(this,y,!1,23,4)},S.prototype.readDoubleLE=function(y,O){return y=y>>>0,O||We(y,8,this.length),l.read(this,y,!0,52,8)},S.prototype.readDoubleBE=function(y,O){return y=y>>>0,O||We(y,8,this.length),l.read(this,y,!1,52,8)};function Qe(z,y,O,Ee,be,Ae){if(!S.isBuffer(z))throw new TypeError('"buffer" argument must be a Buffer instance');if(y>be||y<Ae)throw new RangeError('"value" argument is out of bounds');if(O+Ee>z.length)throw new RangeError("Index out of range")}S.prototype.writeUintLE=S.prototype.writeUIntLE=function(y,O,Ee,be){if(y=+y,O=O>>>0,Ee=Ee>>>0,!be){const ze=Math.pow(2,8*Ee)-1;Qe(this,y,O,Ee,ze,0)}let Ae=1,ke=0;for(this[O]=y&255;++ke<Ee&&(Ae*=256);)this[O+ke]=y/Ae&255;return O+Ee},S.prototype.writeUintBE=S.prototype.writeUIntBE=function(y,O,Ee,be){if(y=+y,O=O>>>0,Ee=Ee>>>0,!be){const ze=Math.pow(2,8*Ee)-1;Qe(this,y,O,Ee,ze,0)}let Ae=Ee-1,ke=1;for(this[O+Ae]=y&255;--Ae>=0&&(ke*=256);)this[O+Ae]=y/ke&255;return O+Ee},S.prototype.writeUint8=S.prototype.writeUInt8=function(y,O,Ee){return y=+y,O=O>>>0,Ee||Qe(this,y,O,1,255,0),this[O]=y&255,O+1},S.prototype.writeUint16LE=S.prototype.writeUInt16LE=function(y,O,Ee){return y=+y,O=O>>>0,Ee||Qe(this,y,O,2,65535,0),this[O]=y&255,this[O+1]=y>>>8,O+2},S.prototype.writeUint16BE=S.prototype.writeUInt16BE=function(y,O,Ee){return y=+y,O=O>>>0,Ee||Qe(this,y,O,2,65535,0),this[O]=y>>>8,this[O+1]=y&255,O+2},S.prototype.writeUint32LE=S.prototype.writeUInt32LE=function(y,O,Ee){return y=+y,O=O>>>0,Ee||Qe(this,y,O,4,4294967295,0),this[O+3]=y>>>24,this[O+2]=y>>>16,this[O+1]=y>>>8,this[O]=y&255,O+4},S.prototype.writeUint32BE=S.prototype.writeUInt32BE=function(y,O,Ee){return y=+y,O=O>>>0,Ee||Qe(this,y,O,4,4294967295,0),this[O]=y>>>24,this[O+1]=y>>>16,this[O+2]=y>>>8,this[O+3]=y&255,O+4};function _t(z,y,O,Ee,be){Ve(y,Ee,be,z,O,7);let Ae=Number(y&BigInt(4294967295));z[O++]=Ae,Ae=Ae>>8,z[O++]=Ae,Ae=Ae>>8,z[O++]=Ae,Ae=Ae>>8,z[O++]=Ae;let ke=Number(y>>BigInt(32)&BigInt(4294967295));return z[O++]=ke,ke=ke>>8,z[O++]=ke,ke=ke>>8,z[O++]=ke,ke=ke>>8,z[O++]=ke,O}function pt(z,y,O,Ee,be){Ve(y,Ee,be,z,O,7);let Ae=Number(y&BigInt(4294967295));z[O+7]=Ae,Ae=Ae>>8,z[O+6]=Ae,Ae=Ae>>8,z[O+5]=Ae,Ae=Ae>>8,z[O+4]=Ae;let ke=Number(y>>BigInt(32)&BigInt(4294967295));return z[O+3]=ke,ke=ke>>8,z[O+2]=ke,ke=ke>>8,z[O+1]=ke,ke=ke>>8,z[O]=ke,O+8}S.prototype.writeBigUInt64LE=ht(function(y,O=0){return _t(this,y,O,BigInt(0),BigInt("0xffffffffffffffff"))}),S.prototype.writeBigUInt64BE=ht(function(y,O=0){return pt(this,y,O,BigInt(0),BigInt("0xffffffffffffffff"))}),S.prototype.writeIntLE=function(y,O,Ee,be){if(y=+y,O=O>>>0,!be){const Je=Math.pow(2,8*Ee-1);Qe(this,y,O,Ee,Je-1,-Je)}let Ae=0,ke=1,ze=0;for(this[O]=y&255;++Ae<Ee&&(ke*=256);)y<0&&ze===0&&this[O+Ae-1]!==0&&(ze=1),this[O+Ae]=(y/ke>>0)-ze&255;return O+Ee},S.prototype.writeIntBE=function(y,O,Ee,be){if(y=+y,O=O>>>0,!be){const Je=Math.pow(2,8*Ee-1);Qe(this,y,O,Ee,Je-1,-Je)}let Ae=Ee-1,ke=1,ze=0;for(this[O+Ae]=y&255;--Ae>=0&&(ke*=256);)y<0&&ze===0&&this[O+Ae+1]!==0&&(ze=1),this[O+Ae]=(y/ke>>0)-ze&255;return O+Ee},S.prototype.writeInt8=function(y,O,Ee){return y=+y,O=O>>>0,Ee||Qe(this,y,O,1,127,-128),y<0&&(y=255+y+1),this[O]=y&255,O+1},S.prototype.writeInt16LE=function(y,O,Ee){return y=+y,O=O>>>0,Ee||Qe(this,y,O,2,32767,-32768),this[O]=y&255,this[O+1]=y>>>8,O+2},S.prototype.writeInt16BE=function(y,O,Ee){return y=+y,O=O>>>0,Ee||Qe(this,y,O,2,32767,-32768),this[O]=y>>>8,this[O+1]=y&255,O+2},S.prototype.writeInt32LE=function(y,O,Ee){return y=+y,O=O>>>0,Ee||Qe(this,y,O,4,2147483647,-2147483648),this[O]=y&255,this[O+1]=y>>>8,this[O+2]=y>>>16,this[O+3]=y>>>24,O+4},S.prototype.writeInt32BE=function(y,O,Ee){return y=+y,O=O>>>0,Ee||Qe(this,y,O,4,2147483647,-2147483648),y<0&&(y=4294967295+y+1),this[O]=y>>>24,this[O+1]=y>>>16,this[O+2]=y>>>8,this[O+3]=y&255,O+4},S.prototype.writeBigInt64LE=ht(function(y,O=0){return _t(this,y,O,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),S.prototype.writeBigInt64BE=ht(function(y,O=0){return pt(this,y,O,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function mt(z,y,O,Ee,be,Ae){if(O+Ee>z.length)throw new RangeError("Index out of range");if(O<0)throw new RangeError("Index out of range")}function Et(z,y,O,Ee,be){return y=+y,O=O>>>0,be||mt(z,y,O,4),l.write(z,y,O,Ee,23,4),O+4}S.prototype.writeFloatLE=function(y,O,Ee){return Et(this,y,O,!0,Ee)},S.prototype.writeFloatBE=function(y,O,Ee){return Et(this,y,O,!1,Ee)};function te(z,y,O,Ee,be){return y=+y,O=O>>>0,be||mt(z,y,O,8),l.write(z,y,O,Ee,52,8),O+8}S.prototype.writeDoubleLE=function(y,O,Ee){return te(this,y,O,!0,Ee)},S.prototype.writeDoubleBE=function(y,O,Ee){return te(this,y,O,!1,Ee)},S.prototype.copy=function(y,O,Ee,be){if(!S.isBuffer(y))throw new TypeError("argument should be a Buffer");if(Ee||(Ee=0),!be&&be!==0&&(be=this.length),O>=y.length&&(O=y.length),O||(O=0),be>0&&be<Ee&&(be=Ee),be===Ee||y.length===0||this.length===0)return 0;if(O<0)throw new RangeError("targetStart out of bounds");if(Ee<0||Ee>=this.length)throw new RangeError("Index out of range");if(be<0)throw new RangeError("sourceEnd out of bounds");be>this.length&&(be=this.length),y.length-O<be-Ee&&(be=y.length-O+Ee);const Ae=be-Ee;return this===y&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(O,Ee,be):Uint8Array.prototype.set.call(y,this.subarray(Ee,be),O),Ae},S.prototype.fill=function(y,O,Ee,be){if(typeof y=="string"){if(typeof O=="string"?(be=O,O=0,Ee=this.length):typeof Ee=="string"&&(be=Ee,Ee=this.length),be!==void 0&&typeof be!="string")throw new TypeError("encoding must be a string");if(typeof be=="string"&&!S.isEncoding(be))throw new TypeError("Unknown encoding: "+be);if(y.length===1){const ke=y.charCodeAt(0);(be==="utf8"&&ke<128||be==="latin1")&&(y=ke)}}else typeof y=="number"?y=y&255:typeof y=="boolean"&&(y=Number(y));if(O<0||this.length<O||this.length<Ee)throw new RangeError("Out of range index");if(Ee<=O)return this;O=O>>>0,Ee=Ee===void 0?this.length:Ee>>>0,y||(y=0);let Ae;if(typeof y=="number")for(Ae=O;Ae<Ee;++Ae)this[Ae]=y;else{const ke=S.isBuffer(y)?y:S.from(y,be),ze=ke.length;if(ze===0)throw new TypeError('The value "'+y+'" is invalid for argument "value"');for(Ae=0;Ae<Ee-O;++Ae)this[Ae+O]=ke[Ae%ze]}return this};const Z={};function De(z,y,O){Z[z]=class extends O{constructor(){super(),Object.defineProperty(this,"message",{value:y.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${z}]`,this.stack,delete this.name}get code(){return z}set code(be){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:be,writable:!0})}toString(){return`${this.name} [${z}]: ${this.message}`}}}De("ERR_BUFFER_OUT_OF_BOUNDS",function(z){return z?`${z} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),De("ERR_INVALID_ARG_TYPE",function(z,y){return`The "${z}" argument must be of type number. Received type ${typeof y}`},TypeError),De("ERR_OUT_OF_RANGE",function(z,y,O){let Ee=`The value of "${z}" is out of range.`,be=O;return Number.isInteger(O)&&Math.abs(O)>2**32?be=Te(String(O)):typeof O=="bigint"&&(be=String(O),(O>BigInt(2)**BigInt(32)||O<-(BigInt(2)**BigInt(32)))&&(be=Te(be)),be+="n"),Ee+=` It must be ${y}. Received ${be}`,Ee},RangeError);function Te(z){let y="",O=z.length;const Ee=z[0]==="-"?1:0;for(;O>=Ee+4;O-=3)y=`_${z.slice(O-3,O)}${y}`;return`${z.slice(0,O)}${y}`}function je(z,y,O){Xe(y,"offset"),(z[y]===void 0||z[y+O]===void 0)&&tt(y,z.length-(O+1))}function Ve(z,y,O,Ee,be,Ae){if(z>O||z<y){const ke=typeof y=="bigint"?"n":"";let ze;throw Ae>3?y===0||y===BigInt(0)?ze=`>= 0${ke} and < 2${ke} ** ${(Ae+1)*8}${ke}`:ze=`>= -(2${ke} ** ${(Ae+1)*8-1}${ke}) and < 2 ** ${(Ae+1)*8-1}${ke}`:ze=`>= ${y}${ke} and <= ${O}${ke}`,new Z.ERR_OUT_OF_RANGE("value",ze,z)}je(Ee,be,Ae)}function Xe(z,y){if(typeof z!="number")throw new Z.ERR_INVALID_ARG_TYPE(y,"number",z)}function tt(z,y,O){throw Math.floor(z)!==z?(Xe(z,O),new Z.ERR_OUT_OF_RANGE(O||"offset","an integer",z)):y<0?new Z.ERR_BUFFER_OUT_OF_BOUNDS:new Z.ERR_OUT_OF_RANGE(O||"offset",`>= ${O?1:0} and <= ${y}`,z)}const ot=/[^+/0-9A-Za-z-_]/g;function ct(z){if(z=z.split("=")[0],z=z.trim().replace(ot,""),z.length<2)return"";for(;z.length%4!==0;)z=z+"=";return z}function et(z,y){y=y||1/0;let O;const Ee=z.length;let be=null;const Ae=[];for(let ke=0;ke<Ee;++ke){if(O=z.charCodeAt(ke),O>55295&&O<57344){if(!be){if(O>56319){(y-=3)>-1&&Ae.push(239,191,189);continue}else if(ke+1===Ee){(y-=3)>-1&&Ae.push(239,191,189);continue}be=O;continue}if(O<56320){(y-=3)>-1&&Ae.push(239,191,189),be=O;continue}O=(be-55296<<10|O-56320)+65536}else be&&(y-=3)>-1&&Ae.push(239,191,189);if(be=null,O<128){if((y-=1)<0)break;Ae.push(O)}else if(O<2048){if((y-=2)<0)break;Ae.push(O>>6|192,O&63|128)}else if(O<65536){if((y-=3)<0)break;Ae.push(O>>12|224,O>>6&63|128,O&63|128)}else if(O<1114112){if((y-=4)<0)break;Ae.push(O>>18|240,O>>12&63|128,O>>6&63|128,O&63|128)}else throw new Error("Invalid code point")}return Ae}function lt(z){const y=[];for(let O=0;O<z.length;++O)y.push(z.charCodeAt(O)&255);return y}function vt(z,y){let O,Ee,be;const Ae=[];for(let ke=0;ke<z.length&&!((y-=2)<0);++ke)O=z.charCodeAt(ke),Ee=O>>8,be=O%256,Ae.push(be),Ae.push(Ee);return Ae}function gt(z){return g.toByteArray(ct(z))}function dt(z,y,O,Ee){let be;for(be=0;be<Ee&&!(be+O>=y.length||be>=z.length);++be)y[be+O]=z[be];return be}function st(z,y){return z instanceof y||z!=null&&z.constructor!=null&&z.constructor.name!=null&&z.constructor.name===y.name}function wt(z){return z!==z}const yt=function(){const z="0123456789abcdef",y=new Array(256);for(let O=0;O<16;++O){const Ee=O*16;for(let be=0;be<16;++be)y[Ee+be]=z[O]+z[be]}return y}();function ht(z){return typeof BigInt=="undefined"?xt:z}function xt(){throw new Error("BigInt not supported")}})(buffer$1),globalThis.Buffer=buffer$1.Buffer;var utf8$5={},utils$r={},support$5={},nodestream,blob;if(support$5.base64=!0,support$5.array=!0,support$5.string=!0,support$5.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",support$5.nodebuffer=typeof Buffer!="undefined",support$5.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")blob=support$5.blob=!1;else{var buffer=new ArrayBuffer(0);try{blob=support$5.blob=new Blob([buffer],{type:"application/zip"}).size===0}catch(r){try{var Builder=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,builder=new Builder;builder.append(buffer),blob=support$5.blob=builder.getBlob("application/zip").size===0}catch(g){blob=support$5.blob=!1}}}try{nodestream=support$5.nodestream=!!require("readable-stream").Readable}catch(r){nodestream=support$5.nodestream=!1}var base64$1={},utils$q=utils$r,support$4=support$5,_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";base64$1.encode=function(r){for(var g=[],l,v,I,D,L,S,ee,U=0,Y=r.length,$e=Y,_e=utils$q.getTypeOf(r)!=="string";U<r.length;)$e=Y-U,_e?(l=r[U++],v=U<Y?r[U++]:0,I=U<Y?r[U++]:0):(l=r.charCodeAt(U++),v=U<Y?r.charCodeAt(U++):0,I=U<Y?r.charCodeAt(U++):0),D=l>>2,L=(l&3)<<4|v>>4,S=$e>1?(v&15)<<2|I>>6:64,ee=$e>2?I&63:64,g.push(_keyStr.charAt(D)+_keyStr.charAt(L)+_keyStr.charAt(S)+_keyStr.charAt(ee));return g.join("")},base64$1.decode=function(r){var g,l,v,I,D,L,S,ee=0,U=0,Y="data:";if(r.substr(0,Y.length)===Y)throw new Error("Invalid base64 input, it looks like a data url.");r=r.replace(/[^A-Za-z0-9+/=]/g,"");var $e=r.length*3/4;if(r.charAt(r.length-1)===_keyStr.charAt(64)&&$e--,r.charAt(r.length-2)===_keyStr.charAt(64)&&$e--,$e%1!==0)throw new Error("Invalid base64 input, bad content length.");var _e;for(support$4.uint8array?_e=new Uint8Array($e|0):_e=new Array($e|0);ee<r.length;)I=_keyStr.indexOf(r.charAt(ee++)),D=_keyStr.indexOf(r.charAt(ee++)),L=_keyStr.indexOf(r.charAt(ee++)),S=_keyStr.indexOf(r.charAt(ee++)),g=I<<2|D>>4,l=(D&15)<<4|L>>2,v=(L&3)<<6|S,_e[U++]=g,L!==64&&(_e[U++]=l),S!==64&&(_e[U++]=v);return _e};var nodejsUtils$2={isNode:typeof Buffer!="undefined",newBufferFrom:function(r,g){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(r,g);if(typeof r=="number")throw new Error('The "data" argument must not be a number');return new Buffer(r,g)},allocBuffer:function(r){if(Buffer.alloc)return Buffer.alloc(r);var g=new Buffer(r);return g.fill(0),g},isBuffer:function(r){return Buffer.isBuffer(r)},isStream:function(r){return r&&typeof r.on=="function"&&typeof r.pause=="function"&&typeof r.resume=="function"}},Mutation=commonjsGlobal.MutationObserver||commonjsGlobal.WebKitMutationObserver,scheduleDrain;if(Mutation){var called=0,observer=new Mutation(nextTick),element=commonjsGlobal.document.createTextNode("");observer.observe(element,{characterData:!0}),scheduleDrain=function(){element.data=called=++called%2}}else if(!commonjsGlobal.setImmediate&&typeof commonjsGlobal.MessageChannel!="undefined"){var channel=new commonjsGlobal.MessageChannel;channel.port1.onmessage=nextTick,scheduleDrain=function(){channel.port2.postMessage(0)}}else"document"in commonjsGlobal&&"onreadystatechange"in commonjsGlobal.document.createElement("script")?scheduleDrain=function(){var r=commonjsGlobal.document.createElement("script");r.onreadystatechange=function(){nextTick(),r.onreadystatechange=null,r.parentNode.removeChild(r),r=null},commonjsGlobal.document.documentElement.appendChild(r)}:scheduleDrain=function(){setTimeout(nextTick,0)};var draining,queue=[];function nextTick(){draining=!0;for(var r,g,l=queue.length;l;){for(g=queue,queue=[],r=-1;++r<l;)g[r]();l=queue.length}draining=!1}var lib$2=immediate$1;function immediate$1(r){queue.push(r)===1&&!draining&&scheduleDrain()}var immediate=lib$2;function INTERNAL(){}var handlers={},REJECTED=["REJECTED"],FULFILLED=["FULFILLED"],PENDING=["PENDING"],lib$1=Promise$1;function Promise$1(r){if(typeof r!="function")throw new TypeError("resolver must be a function");this.state=PENDING,this.queue=[],this.outcome=void 0,r!==INTERNAL&&safelyResolveThenable(this,r)}Promise$1.prototype.finally=function(r){if(typeof r!="function")return this;var g=this.constructor;return this.then(l,v);function l(I){function D(){return I}return g.resolve(r()).then(D)}function v(I){function D(){throw I}return g.resolve(r()).then(D)}},Promise$1.prototype.catch=function(r){return this.then(null,r)},Promise$1.prototype.then=function(r,g){if(typeof r!="function"&&this.state===FULFILLED||typeof g!="function"&&this.state===REJECTED)return this;var l=new this.constructor(INTERNAL);if(this.state!==PENDING){var v=this.state===FULFILLED?r:g;unwrap(l,v,this.outcome)}else this.queue.push(new QueueItem(l,r,g));return l};function QueueItem(r,g,l){this.promise=r,typeof g=="function"&&(this.onFulfilled=g,this.callFulfilled=this.otherCallFulfilled),typeof l=="function"&&(this.onRejected=l,this.callRejected=this.otherCallRejected)}QueueItem.prototype.callFulfilled=function(r){handlers.resolve(this.promise,r)},QueueItem.prototype.otherCallFulfilled=function(r){unwrap(this.promise,this.onFulfilled,r)},QueueItem.prototype.callRejected=function(r){handlers.reject(this.promise,r)},QueueItem.prototype.otherCallRejected=function(r){unwrap(this.promise,this.onRejected,r)};function unwrap(r,g,l){immediate(function(){var v;try{v=g(l)}catch(I){return handlers.reject(r,I)}v===r?handlers.reject(r,new TypeError("Cannot resolve promise with itself")):handlers.resolve(r,v)})}handlers.resolve=function(r,g){var l=tryCatch(getThen,g);if(l.status==="error")return handlers.reject(r,l.value);var v=l.value;if(v)safelyResolveThenable(r,v);else{r.state=FULFILLED,r.outcome=g;for(var I=-1,D=r.queue.length;++I<D;)r.queue[I].callFulfilled(g)}return r},handlers.reject=function(r,g){r.state=REJECTED,r.outcome=g;for(var l=-1,v=r.queue.length;++l<v;)r.queue[l].callRejected(g);return r};function getThen(r){var g=r&&r.then;if(r&&(typeof r=="object"||typeof r=="function")&&typeof g=="function")return function(){g.apply(r,arguments)}}function safelyResolveThenable(r,g){var l=!1;function v(S){l||(l=!0,handlers.reject(r,S))}function I(S){l||(l=!0,handlers.resolve(r,S))}function D(){g(I,v)}var L=tryCatch(D);L.status==="error"&&v(L.value)}function tryCatch(r,g){var l={};try{l.value=r(g),l.status="success"}catch(v){l.status="error",l.value=v}return l}Promise$1.resolve=resolve;function resolve(r){return r instanceof this?r:handlers.resolve(new this(INTERNAL),r)}Promise$1.reject=reject;function reject(r){var g=new this(INTERNAL);return handlers.reject(g,r)}Promise$1.all=all;function all(r){var g=this;if(Object.prototype.toString.call(r)!=="[object Array]")return this.reject(new TypeError("must be an array"));var l=r.length,v=!1;if(!l)return this.resolve([]);for(var I=new Array(l),D=0,L=-1,S=new this(INTERNAL);++L<l;)ee(r[L],L);return S;function ee(U,Y){g.resolve(U).then($e,function(_e){v||(v=!0,handlers.reject(S,_e))});function $e(_e){I[Y]=_e,++D===l&&!v&&(v=!0,handlers.resolve(S,I))}}}Promise$1.race=race;function race(r){var g=this;if(Object.prototype.toString.call(r)!=="[object Array]")return this.reject(new TypeError("must be an array"));var l=r.length,v=!1;if(!l)return this.resolve([]);for(var I=-1,D=new this(INTERNAL);++I<l;)L(r[I]);return D;function L(S){g.resolve(S).then(function(ee){v||(v=!0,handlers.resolve(D,ee))},function(ee){v||(v=!0,handlers.reject(D,ee))})}}var ES6Promise=null;typeof Promise!="undefined"?ES6Promise=Promise:ES6Promise=lib$1;var external$3={Promise:ES6Promise};(function(r,g){if(r.setImmediate)return;var l=1,v={},I=!1,D=r.document,L;function S(Ce){typeof Ce!="function"&&(Ce=new Function(""+Ce));for(var Be=new Array(arguments.length-1),Re=0;Re<Be.length;Re++)Be[Re]=arguments[Re+1];var Oe={callback:Ce,args:Be};return v[l]=Oe,L(l),l++}function ee(Ce){delete v[Ce]}function U(Ce){var Be=Ce.callback,Re=Ce.args;switch(Re.length){case 0:Be();break;case 1:Be(Re[0]);break;case 2:Be(Re[0],Re[1]);break;case 3:Be(Re[0],Re[1],Re[2]);break;default:Be.apply(g,Re);break}}function Y(Ce){if(I)setTimeout(Y,0,Ce);else{var Be=v[Ce];if(Be){I=!0;try{U(Be)}finally{ee(Ce),I=!1}}}}function $e(){L=function(Ce){setTimeout(function(){Y(Ce)})}}function _e(){if(r.postMessage&&!r.importScripts){var Ce=!0,Be=r.onmessage;return r.onmessage=function(){Ce=!1},r.postMessage("","*"),r.onmessage=Be,Ce}}function ve(){var Ce="setImmediate$"+Math.random()+"$",Be=function(Re){Re.source===r&&typeof Re.data=="string"&&Re.data.indexOf(Ce)===0&&Y(+Re.data.slice(Ce.length))};r.addEventListener?r.addEventListener("message",Be,!1):r.attachEvent("onmessage",Be),L=function(Re){r.postMessage(Ce+Re,"*")}}function we(){var Ce=new MessageChannel;Ce.port1.onmessage=function(Be){var Re=Be.data;Y(Re)},L=function(Be){Ce.port2.postMessage(Be)}}function Se(){var Ce=D.documentElement;L=function(Be){var Re=D.createElement("script");Re.onreadystatechange=function(){Y(Be),Re.onreadystatechange=null,Ce.removeChild(Re),Re=null},Ce.appendChild(Re)}}function Ie(){L=function(Ce){setTimeout(Y,0,Ce)}}var Ne=Object.getPrototypeOf&&Object.getPrototypeOf(r);Ne=Ne&&Ne.setTimeout?Ne:r,{}.toString.call(r.undefined)==="[object undefined]"?$e():_e()?ve():r.MessageChannel?we():D&&"onreadystatechange"in D.createElement("script")?Se():Ie(),Ne.setImmediate=S,Ne.clearImmediate=ee})(typeof self=="undefined"?commonjsGlobal:self),function(r){var g=support$5,l=base64$1,v=nodejsUtils$2,I=external$3;function D(_e){var ve=null;return g.uint8array?ve=new Uint8Array(_e.length):ve=new Array(_e.length),S(_e,ve)}r.newBlob=function(_e,ve){r.checkSupport("blob");try{return new Blob([_e],{type:ve})}catch(Ie){try{var we=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,Se=new we;return Se.append(_e),Se.getBlob(ve)}catch(Ne){throw new Error("Bug : can't construct the Blob.")}}};function L(_e){return _e}function S(_e,ve){for(var we=0;we<_e.length;++we)ve[we]=_e.charCodeAt(we)&255;return ve}var ee={stringifyByChunk:function(_e,ve,we){var Se=[],Ie=0,Ne=_e.length;if(Ne<=we)return String.fromCharCode.apply(null,_e);for(;Ie<Ne;)ve==="array"||ve==="nodebuffer"?Se.push(String.fromCharCode.apply(null,_e.slice(Ie,Math.min(Ie+we,Ne)))):Se.push(String.fromCharCode.apply(null,_e.subarray(Ie,Math.min(Ie+we,Ne)))),Ie+=we;return Se.join("")},stringifyByChar:function(_e){for(var ve="",we=0;we<_e.length;we++)ve+=String.fromCharCode(_e[we]);return ve},applyCanBeUsed:{uint8array:function(){try{return g.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch(_e){return!1}}(),nodebuffer:function(){try{return g.nodebuffer&&String.fromCharCode.apply(null,v.allocBuffer(1)).length===1}catch(_e){return!1}}()}};function U(_e){var ve=65536,we=r.getTypeOf(_e),Se=!0;if(we==="uint8array"?Se=ee.applyCanBeUsed.uint8array:we==="nodebuffer"&&(Se=ee.applyCanBeUsed.nodebuffer),Se)for(;ve>1;)try{return ee.stringifyByChunk(_e,we,ve)}catch(Ie){ve=Math.floor(ve/2)}return ee.stringifyByChar(_e)}r.applyFromCharCode=U;function Y(_e,ve){for(var we=0;we<_e.length;we++)ve[we]=_e[we];return ve}var $e={};$e.string={string:L,array:function(_e){return S(_e,new Array(_e.length))},arraybuffer:function(_e){return $e.string.uint8array(_e).buffer},uint8array:function(_e){return S(_e,new Uint8Array(_e.length))},nodebuffer:function(_e){return S(_e,v.allocBuffer(_e.length))}},$e.array={string:U,array:L,arraybuffer:function(_e){return new Uint8Array(_e).buffer},uint8array:function(_e){return new Uint8Array(_e)},nodebuffer:function(_e){return v.newBufferFrom(_e)}},$e.arraybuffer={string:function(_e){return U(new Uint8Array(_e))},array:function(_e){return Y(new Uint8Array(_e),new Array(_e.byteLength))},arraybuffer:L,uint8array:function(_e){return new Uint8Array(_e)},nodebuffer:function(_e){return v.newBufferFrom(new Uint8Array(_e))}},$e.uint8array={string:U,array:function(_e){return Y(_e,new Array(_e.length))},arraybuffer:function(_e){return _e.buffer},uint8array:L,nodebuffer:function(_e){return v.newBufferFrom(_e)}},$e.nodebuffer={string:U,array:function(_e){return Y(_e,new Array(_e.length))},arraybuffer:function(_e){return $e.nodebuffer.uint8array(_e).buffer},uint8array:function(_e){return Y(_e,new Uint8Array(_e.length))},nodebuffer:L},r.transformTo=function(_e,ve){if(ve||(ve=""),!_e)return ve;r.checkSupport(_e);var we=r.getTypeOf(ve),Se=$e[we][_e](ve);return Se},r.resolve=function(_e){for(var ve=_e.split("/"),we=[],Se=0;Se<ve.length;Se++){var Ie=ve[Se];Ie==="."||Ie===""&&Se!==0&&Se!==ve.length-1||(Ie===".."?we.pop():we.push(Ie))}return we.join("/")},r.getTypeOf=function(_e){if(typeof _e=="string")return"string";if(Object.prototype.toString.call(_e)==="[object Array]")return"array";if(g.nodebuffer&&v.isBuffer(_e))return"nodebuffer";if(g.uint8array&&_e instanceof Uint8Array)return"uint8array";if(g.arraybuffer&&_e instanceof ArrayBuffer)return"arraybuffer"},r.checkSupport=function(_e){var ve=g[_e.toLowerCase()];if(!ve)throw new Error(_e+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(_e){var ve="",we,Se;for(Se=0;Se<(_e||"").length;Se++)we=_e.charCodeAt(Se),ve+="\\x"+(we<16?"0":"")+we.toString(16).toUpperCase();return ve},r.delay=function(_e,ve,we){setImmediate(function(){_e.apply(we||null,ve||[])})},r.inherits=function(_e,ve){var we=function(){};we.prototype=ve.prototype,_e.prototype=new we},r.extend=function(){var _e={},ve,we;for(ve=0;ve<arguments.length;ve++)for(we in arguments[ve])Object.prototype.hasOwnProperty.call(arguments[ve],we)&&typeof _e[we]=="undefined"&&(_e[we]=arguments[ve][we]);return _e},r.prepareContent=function(_e,ve,we,Se,Ie){var Ne=I.Promise.resolve(ve).then(function(Ce){var Be=g.blob&&(Ce instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(Ce))!==-1);return Be&&typeof FileReader!="undefined"?new I.Promise(function(Re,Oe){var Ue=new FileReader;Ue.onload=function(Le){Re(Le.target.result)},Ue.onerror=function(Le){Oe(Le.target.error)},Ue.readAsArrayBuffer(Ce)}):Ce});return Ne.then(function(Ce){var Be=r.getTypeOf(Ce);return Be?(Be==="arraybuffer"?Ce=r.transformTo("uint8array",Ce):Be==="string"&&(Ie?Ce=l.decode(Ce):we&&Se!==!0&&(Ce=D(Ce))),Ce):I.Promise.reject(new Error("Can't read the data of '"+_e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}}(utils$r);function GenericWorker$b(r){this.name=r||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}GenericWorker$b.prototype={push:function(r){this.emit("data",r)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(r){this.emit("error",r)}return!0},error:function(r){return this.isFinished?!1:(this.isPaused?this.generatedError=r:(this.isFinished=!0,this.emit("error",r),this.previous&&this.previous.error(r),this.cleanUp()),!0)},on:function(r,g){return this._listeners[r].push(g),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(r,g){if(this._listeners[r])for(var l=0;l<this._listeners[r].length;l++)this._listeners[r][l].call(this,g)},pipe:function(r){return r.registerPrevious(this)},registerPrevious:function(r){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=r.streamInfo,this.mergeStreamInfo(),this.previous=r;var g=this;return r.on("data",function(l){g.processChunk(l)}),r.on("end",function(){g.end()}),r.on("error",function(l){g.error(l)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var r=!1;return this.generatedError&&(this.error(this.generatedError),r=!0),this.previous&&this.previous.resume(),!r},flush:function(){},processChunk:function(r){this.push(r)},withStreamInfo:function(r,g){return this.extraStreamInfo[r]=g,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var r in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,r)&&(this.streamInfo[r]=this.extraStreamInfo[r])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var r="Worker "+this.name;return this.previous?this.previous+" -> "+r:r}};var GenericWorker_1=GenericWorker$b;(function(r){for(var g=utils$r,l=support$5,v=nodejsUtils$2,I=GenericWorker_1,D=new Array(256),L=0;L<256;L++)D[L]=L>=252?6:L>=248?5:L>=240?4:L>=224?3:L>=192?2:1;D[254]=D[254]=1;var S=function(_e){var ve,we,Se,Ie,Ne,Ce=_e.length,Be=0;for(Ie=0;Ie<Ce;Ie++)we=_e.charCodeAt(Ie),(we&64512)===55296&&Ie+1<Ce&&(Se=_e.charCodeAt(Ie+1),(Se&64512)===56320&&(we=65536+(we-55296<<10)+(Se-56320),Ie++)),Be+=we<128?1:we<2048?2:we<65536?3:4;for(l.uint8array?ve=new Uint8Array(Be):ve=new Array(Be),Ne=0,Ie=0;Ne<Be;Ie++)we=_e.charCodeAt(Ie),(we&64512)===55296&&Ie+1<Ce&&(Se=_e.charCodeAt(Ie+1),(Se&64512)===56320&&(we=65536+(we-55296<<10)+(Se-56320),Ie++)),we<128?ve[Ne++]=we:we<2048?(ve[Ne++]=192|we>>>6,ve[Ne++]=128|we&63):we<65536?(ve[Ne++]=224|we>>>12,ve[Ne++]=128|we>>>6&63,ve[Ne++]=128|we&63):(ve[Ne++]=240|we>>>18,ve[Ne++]=128|we>>>12&63,ve[Ne++]=128|we>>>6&63,ve[Ne++]=128|we&63);return ve},ee=function(_e,ve){var we;for(ve=ve||_e.length,ve>_e.length&&(ve=_e.length),we=ve-1;we>=0&&(_e[we]&192)===128;)we--;return we<0||we===0?ve:we+D[_e[we]]>ve?we:ve},U=function(_e){var ve,we,Se,Ie,Ne=_e.length,Ce=new Array(Ne*2);for(we=0,ve=0;ve<Ne;){if(Se=_e[ve++],Se<128){Ce[we++]=Se;continue}if(Ie=D[Se],Ie>4){Ce[we++]=65533,ve+=Ie-1;continue}for(Se&=Ie===2?31:Ie===3?15:7;Ie>1&&ve<Ne;)Se=Se<<6|_e[ve++]&63,Ie--;if(Ie>1){Ce[we++]=65533;continue}Se<65536?Ce[we++]=Se:(Se-=65536,Ce[we++]=55296|Se>>10&1023,Ce[we++]=56320|Se&1023)}return Ce.length!==we&&(Ce.subarray?Ce=Ce.subarray(0,we):Ce.length=we),g.applyFromCharCode(Ce)};r.utf8encode=function(ve){return l.nodebuffer?v.newBufferFrom(ve,"utf-8"):S(ve)},r.utf8decode=function(ve){return l.nodebuffer?g.transformTo("nodebuffer",ve).toString("utf-8"):(ve=g.transformTo(l.uint8array?"uint8array":"array",ve),U(ve))};function Y(){I.call(this,"utf-8 decode"),this.leftOver=null}g.inherits(Y,I),Y.prototype.processChunk=function(_e){var ve=g.transformTo(l.uint8array?"uint8array":"array",_e.data);if(this.leftOver&&this.leftOver.length){if(l.uint8array){var we=ve;ve=new Uint8Array(we.length+this.leftOver.length),ve.set(this.leftOver,0),ve.set(we,this.leftOver.length)}else ve=this.leftOver.concat(ve);this.leftOver=null}var Se=ee(ve),Ie=ve;Se!==ve.length&&(l.uint8array?(Ie=ve.subarray(0,Se),this.leftOver=ve.subarray(Se,ve.length)):(Ie=ve.slice(0,Se),this.leftOver=ve.slice(Se,ve.length))),this.push({data:r.utf8decode(Ie),meta:_e.meta})},Y.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=Y;function $e(){I.call(this,"utf-8 encode")}g.inherits($e,I),$e.prototype.processChunk=function(_e){this.push({data:r.utf8encode(_e.data),meta:_e.meta})},r.Utf8EncodeWorker=$e})(utf8$5);var GenericWorker$a=GenericWorker_1,utils$p=utils$r;function ConvertWorker$1(r){GenericWorker$a.call(this,"ConvertWorker to "+r),this.destType=r}utils$p.inherits(ConvertWorker$1,GenericWorker$a),ConvertWorker$1.prototype.processChunk=function(r){this.push({data:utils$p.transformTo(this.destType,r.data),meta:r.meta})};var ConvertWorker_1=ConvertWorker$1,utils$o=utils$r,ConvertWorker=ConvertWorker_1,GenericWorker$9=GenericWorker_1,base64=base64$1,support$3=support$5,external$2=external$3,NodejsStreamOutputAdapter=null;if(support$3.nodestream)try{NodejsStreamOutputAdapter=require("../nodejs/NodejsStreamOutputAdapter")}catch(r){}function transformZipOutput(r,g,l){switch(r){case"blob":return utils$o.newBlob(utils$o.transformTo("arraybuffer",g),l);case"base64":return base64.encode(g);default:return utils$o.transformTo(r,g)}}function concat(r,g){var l,v=0,I=null,D=0;for(l=0;l<g.length;l++)D+=g[l].length;switch(r){case"string":return g.join("");case"array":return Array.prototype.concat.apply([],g);case"uint8array":for(I=new Uint8Array(D),l=0;l<g.length;l++)I.set(g[l],v),v+=g[l].length;return I;case"nodebuffer":return Buffer.concat(g);default:throw new Error("concat : unsupported type '"+r+"'")}}function accumulate(r,g){return new external$2.Promise(function(l,v){var I=[],D=r._internalType,L=r._outputType,S=r._mimeType;r.on("data",function(ee,U){I.push(ee),g&&g(U)}).on("error",function(ee){I=[],v(ee)}).on("end",function(){try{var ee=transformZipOutput(L,concat(D,I),S);l(ee)}catch(U){v(U)}I=[]}).resume()})}function StreamHelper$2(r,g,l){var v=g;switch(g){case"blob":case"arraybuffer":v="uint8array";break;case"base64":v="string";break}try{this._internalType=v,this._outputType=g,this._mimeType=l,utils$o.checkSupport(v),this._worker=r.pipe(new ConvertWorker(v)),r.lock()}catch(I){this._worker=new GenericWorker$9("error"),this._worker.error(I)}}StreamHelper$2.prototype={accumulate:function(r){return accumulate(this,r)},on:function(r,g){var l=this;return r==="data"?this._worker.on(r,function(v){g.call(l,v.data,v.meta)}):this._worker.on(r,function(){utils$o.delay(g,arguments,l)}),this},resume:function(){return utils$o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(r){if(utils$o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new NodejsStreamOutputAdapter(this,{objectMode:this._outputType!=="nodebuffer"},r)}};var StreamHelper_1=StreamHelper$2,defaults$1={};defaults$1.base64=!1,defaults$1.binary=!1,defaults$1.dir=!1,defaults$1.createFolders=!0,defaults$1.date=null,defaults$1.compression=null,defaults$1.compressionOptions=null,defaults$1.comment=null,defaults$1.unixPermissions=null,defaults$1.dosPermissions=null;var utils$n=utils$r,GenericWorker$8=GenericWorker_1,DEFAULT_BLOCK_SIZE=16*1024;function DataWorker$2(r){GenericWorker$8.call(this,"DataWorker");var g=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,r.then(function(l){g.dataIsReady=!0,g.data=l,g.max=l&&l.length||0,g.type=utils$n.getTypeOf(l),g.isPaused||g._tickAndRepeat()},function(l){g.error(l)})}utils$n.inherits(DataWorker$2,GenericWorker$8),DataWorker$2.prototype.cleanUp=function(){GenericWorker$8.prototype.cleanUp.call(this),this.data=null},DataWorker$2.prototype.resume=function(){return GenericWorker$8.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,utils$n.delay(this._tickAndRepeat,[],this)),!0):!1},DataWorker$2.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(utils$n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},DataWorker$2.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var r=DEFAULT_BLOCK_SIZE,g=null,l=Math.min(this.max,this.index+r);if(this.index>=this.max)return this.end();switch(this.type){case"string":g=this.data.substring(this.index,l);break;case"uint8array":g=this.data.subarray(this.index,l);break;case"array":case"nodebuffer":g=this.data.slice(this.index,l);break}return this.index=l,this.push({data:g,meta:{percent:this.max?this.index/this.max*100:0}})};var DataWorker_1=DataWorker$2,utils$m=utils$r;function makeTable$1(){for(var r,g=[],l=0;l<256;l++){r=l;for(var v=0;v<8;v++)r=r&1?3988292384^r>>>1:r>>>1;g[l]=r}return g}var crcTable$1=makeTable$1();function crc32$5(r,g,l,v){var I=crcTable$1,D=v+l;r=r^-1;for(var L=v;L<D;L++)r=r>>>8^I[(r^g[L])&255];return r^-1}function crc32str(r,g,l,v){var I=crcTable$1,D=v+l;r=r^-1;for(var L=v;L<D;L++)r=r>>>8^I[(r^g.charCodeAt(L))&255];return r^-1}var crc32_1$1=function(g,l){if(typeof g=="undefined"||!g.length)return 0;var v=utils$m.getTypeOf(g)!=="string";return v?crc32$5(l|0,g,g.length,0):crc32str(l|0,g,g.length,0)},GenericWorker$7=GenericWorker_1,crc32$4=crc32_1$1,utils$l=utils$r;function Crc32Probe$2(){GenericWorker$7.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}utils$l.inherits(Crc32Probe$2,GenericWorker$7),Crc32Probe$2.prototype.processChunk=function(r){this.streamInfo.crc32=crc32$4(r.data,this.streamInfo.crc32||0),this.push(r)};var Crc32Probe_1=Crc32Probe$2,utils$k=utils$r,GenericWorker$6=GenericWorker_1;function DataLengthProbe$1(r){GenericWorker$6.call(this,"DataLengthProbe for "+r),this.propName=r,this.withStreamInfo(r,0)}utils$k.inherits(DataLengthProbe$1,GenericWorker$6),DataLengthProbe$1.prototype.processChunk=function(r){if(r){var g=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=g+r.data.length}GenericWorker$6.prototype.processChunk.call(this,r)};var DataLengthProbe_1=DataLengthProbe$1,external$1=external$3,DataWorker$1=DataWorker_1,Crc32Probe$1=Crc32Probe_1,DataLengthProbe=DataLengthProbe_1;function CompressedObject$3(r,g,l,v,I){this.compressedSize=r,this.uncompressedSize=g,this.crc32=l,this.compression=v,this.compressedContent=I}CompressedObject$3.prototype={getContentWorker:function(){var r=new DataWorker$1(external$1.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new DataLengthProbe("data_length")),g=this;return r.on("end",function(){if(this.streamInfo.data_length!==g.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),r},getCompressedWorker:function(){return new DataWorker$1(external$1.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},CompressedObject$3.createWorkerFrom=function(r,g,l){return r.pipe(new Crc32Probe$1).pipe(new DataLengthProbe("uncompressedSize")).pipe(g.compressWorker(l)).pipe(new DataLengthProbe("compressedSize")).withStreamInfo("compression",g)};var compressedObject=CompressedObject$3,StreamHelper$1=StreamHelper_1,DataWorker=DataWorker_1,utf8$4=utf8$5,CompressedObject$2=compressedObject,GenericWorker$5=GenericWorker_1,ZipObject$1=function(r,g,l){this.name=r,this.dir=l.dir,this.date=l.date,this.comment=l.comment,this.unixPermissions=l.unixPermissions,this.dosPermissions=l.dosPermissions,this._data=g,this._dataBinary=l.binary,this.options={compression:l.compression,compressionOptions:l.compressionOptions}};ZipObject$1.prototype={internalStream:function(r){var g=null,l="string";try{if(!r)throw new Error("No output type specified.");l=r.toLowerCase();var v=l==="string"||l==="text";(l==="binarystring"||l==="text")&&(l="string"),g=this._decompressWorker();var I=!this._dataBinary;I&&!v&&(g=g.pipe(new utf8$4.Utf8EncodeWorker)),!I&&v&&(g=g.pipe(new utf8$4.Utf8DecodeWorker))}catch(D){g=new GenericWorker$5("error"),g.error(D)}return new StreamHelper$1(g,l,"")},async:function(r,g){return this.internalStream(r).accumulate(g)},nodeStream:function(r,g){return this.internalStream(r||"nodebuffer").toNodejsStream(g)},_compressWorker:function(r,g){if(this._data instanceof CompressedObject$2&&this._data.compression.magic===r.magic)return this._data.getCompressedWorker();var l=this._decompressWorker();return this._dataBinary||(l=l.pipe(new utf8$4.Utf8EncodeWorker)),CompressedObject$2.createWorkerFrom(l,r,g)},_decompressWorker:function(){return this._data instanceof CompressedObject$2?this._data.getContentWorker():this._data instanceof GenericWorker$5?this._data:new DataWorker(this._data)}};for(var removedMethods=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],removedFn=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},i$1=0;i$1<removedMethods.length;i$1++)ZipObject$1.prototype[removedMethods[i$1]]=removedFn;var zipObject=ZipObject$1,generate$1={},compressions$2={},flate={},common={};(function(r){var g=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";function l(D,L){return Object.prototype.hasOwnProperty.call(D,L)}r.assign=function(D){for(var L=Array.prototype.slice.call(arguments,1);L.length;){var S=L.shift();if(S){if(typeof S!="object")throw new TypeError(S+"must be non-object");for(var ee in S)l(S,ee)&&(D[ee]=S[ee])}}return D},r.shrinkBuf=function(D,L){return D.length===L?D:D.subarray?D.subarray(0,L):(D.length=L,D)};var v={arraySet:function(D,L,S,ee,U){if(L.subarray&&D.subarray){D.set(L.subarray(S,S+ee),U);return}for(var Y=0;Y<ee;Y++)D[U+Y]=L[S+Y]},flattenChunks:function(D){var L,S,ee,U,Y,$e;for(ee=0,L=0,S=D.length;L<S;L++)ee+=D[L].length;for($e=new Uint8Array(ee),U=0,L=0,S=D.length;L<S;L++)Y=D[L],$e.set(Y,U),U+=Y.length;return $e}},I={arraySet:function(D,L,S,ee,U){for(var Y=0;Y<ee;Y++)D[U+Y]=L[S+Y]},flattenChunks:function(D){return[].concat.apply([],D)}};r.setTyped=function(D){D?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,v)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,I))},r.setTyped(g)})(common);var deflate$4={},deflate$3={},trees$1={},utils$j=common,Z_FIXED$1=4,Z_BINARY=0,Z_TEXT=1,Z_UNKNOWN$1=2;function zero$1(r){for(var g=r.length;--g>=0;)r[g]=0}var STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,BL_CODES$1=19,HEAP_SIZE$1=2*L_CODES$1+1,MAX_BITS$1=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],DIST_CODE_LEN=512,static_ltree=new Array((L_CODES$1+2)*2);zero$1(static_ltree);var static_dtree=new Array(D_CODES$1*2);zero$1(static_dtree);var _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);var _length_code=new Array(MAX_MATCH$1-MIN_MATCH$1+1);zero$1(_length_code);var base_length=new Array(LENGTH_CODES$1);zero$1(base_length);var base_dist=new Array(D_CODES$1);zero$1(base_dist);function StaticTreeDesc(r,g,l,v,I){this.static_tree=r,this.extra_bits=g,this.extra_base=l,this.elems=v,this.max_length=I,this.has_stree=r&&r.length}var static_l_desc,static_d_desc,static_bl_desc;function TreeDesc(r,g){this.dyn_tree=r,this.max_code=0,this.stat_desc=g}function d_code(r){return r<256?_dist_code[r]:_dist_code[256+(r>>>7)]}function put_short(r,g){r.pending_buf[r.pending++]=g&255,r.pending_buf[r.pending++]=g>>>8&255}function send_bits(r,g,l){r.bi_valid>Buf_size-l?(r.bi_buf|=g<<r.bi_valid&65535,put_short(r,r.bi_buf),r.bi_buf=g>>Buf_size-r.bi_valid,r.bi_valid+=l-Buf_size):(r.bi_buf|=g<<r.bi_valid&65535,r.bi_valid+=l)}function send_code(r,g,l){send_bits(r,l[g*2],l[g*2+1])}function bi_reverse(r,g){var l=0;do l|=r&1,r>>>=1,l<<=1;while(--g>0);return l>>>1}function bi_flush(r){r.bi_valid===16?(put_short(r,r.bi_buf),r.bi_buf=0,r.bi_valid=0):r.bi_valid>=8&&(r.pending_buf[r.pending++]=r.bi_buf&255,r.bi_buf>>=8,r.bi_valid-=8)}function gen_bitlen(r,g){var l=g.dyn_tree,v=g.max_code,I=g.stat_desc.static_tree,D=g.stat_desc.has_stree,L=g.stat_desc.extra_bits,S=g.stat_desc.extra_base,ee=g.stat_desc.max_length,U,Y,$e,_e,ve,we,Se=0;for(_e=0;_e<=MAX_BITS$1;_e++)r.bl_count[_e]=0;for(l[r.heap[r.heap_max]*2+1]=0,U=r.heap_max+1;U<HEAP_SIZE$1;U++)Y=r.heap[U],_e=l[l[Y*2+1]*2+1]+1,_e>ee&&(_e=ee,Se++),l[Y*2+1]=_e,!(Y>v)&&(r.bl_count[_e]++,ve=0,Y>=S&&(ve=L[Y-S]),we=l[Y*2],r.opt_len+=we*(_e+ve),D&&(r.static_len+=we*(I[Y*2+1]+ve)));if(Se!==0){do{for(_e=ee-1;r.bl_count[_e]===0;)_e--;r.bl_count[_e]--,r.bl_count[_e+1]+=2,r.bl_count[ee]--,Se-=2}while(Se>0);for(_e=ee;_e!==0;_e--)for(Y=r.bl_count[_e];Y!==0;)$e=r.heap[--U],!($e>v)&&(l[$e*2+1]!==_e&&(r.opt_len+=(_e-l[$e*2+1])*l[$e*2],l[$e*2+1]=_e),Y--)}}function gen_codes(r,g,l){var v=new Array(MAX_BITS$1+1),I=0,D,L;for(D=1;D<=MAX_BITS$1;D++)v[D]=I=I+l[D-1]<<1;for(L=0;L<=g;L++){var S=r[L*2+1];S!==0&&(r[L*2]=bi_reverse(v[S]++,S))}}function tr_static_init(){var r,g,l,v,I,D=new Array(MAX_BITS$1+1);for(l=0,v=0;v<LENGTH_CODES$1-1;v++)for(base_length[v]=l,r=0;r<1<<extra_lbits[v];r++)_length_code[l++]=v;for(_length_code[l-1]=v,I=0,v=0;v<16;v++)for(base_dist[v]=I,r=0;r<1<<extra_dbits[v];r++)_dist_code[I++]=v;for(I>>=7;v<D_CODES$1;v++)for(base_dist[v]=I<<7,r=0;r<1<<extra_dbits[v]-7;r++)_dist_code[256+I++]=v;for(g=0;g<=MAX_BITS$1;g++)D[g]=0;for(r=0;r<=143;)static_ltree[r*2+1]=8,r++,D[8]++;for(;r<=255;)static_ltree[r*2+1]=9,r++,D[9]++;for(;r<=279;)static_ltree[r*2+1]=7,r++,D[7]++;for(;r<=287;)static_ltree[r*2+1]=8,r++,D[8]++;for(gen_codes(static_ltree,L_CODES$1+1,D),r=0;r<D_CODES$1;r++)static_dtree[r*2+1]=5,static_dtree[r*2]=bi_reverse(r,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS$1+1,L_CODES$1,MAX_BITS$1),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES$1,MAX_BITS$1),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES$1,MAX_BL_BITS)}function init_block(r){var g;for(g=0;g<L_CODES$1;g++)r.dyn_ltree[g*2]=0;for(g=0;g<D_CODES$1;g++)r.dyn_dtree[g*2]=0;for(g=0;g<BL_CODES$1;g++)r.bl_tree[g*2]=0;r.dyn_ltree[END_BLOCK*2]=1,r.opt_len=r.static_len=0,r.last_lit=r.matches=0}function bi_windup(r){r.bi_valid>8?put_short(r,r.bi_buf):r.bi_valid>0&&(r.pending_buf[r.pending++]=r.bi_buf),r.bi_buf=0,r.bi_valid=0}function copy_block(r,g,l,v){bi_windup(r),v&&(put_short(r,l),put_short(r,~l)),utils$j.arraySet(r.pending_buf,r.window,g,l,r.pending),r.pending+=l}function smaller(r,g,l,v){var I=g*2,D=l*2;return r[I]<r[D]||r[I]===r[D]&&v[g]<=v[l]}function pqdownheap(r,g,l){for(var v=r.heap[l],I=l<<1;I<=r.heap_len&&(I<r.heap_len&&smaller(g,r.heap[I+1],r.heap[I],r.depth)&&I++,!smaller(g,v,r.heap[I],r.depth));)r.heap[l]=r.heap[I],l=I,I<<=1;r.heap[l]=v}function compress_block(r,g,l){var v,I,D=0,L,S;if(r.last_lit!==0)do v=r.pending_buf[r.d_buf+D*2]<<8|r.pending_buf[r.d_buf+D*2+1],I=r.pending_buf[r.l_buf+D],D++,v===0?send_code(r,I,g):(L=_length_code[I],send_code(r,L+LITERALS$1+1,g),S=extra_lbits[L],S!==0&&(I-=base_length[L],send_bits(r,I,S)),v--,L=d_code(v),send_code(r,L,l),S=extra_dbits[L],S!==0&&(v-=base_dist[L],send_bits(r,v,S)));while(D<r.last_lit);send_code(r,END_BLOCK,g)}function build_tree(r,g){var l=g.dyn_tree,v=g.stat_desc.static_tree,I=g.stat_desc.has_stree,D=g.stat_desc.elems,L,S,ee=-1,U;for(r.heap_len=0,r.heap_max=HEAP_SIZE$1,L=0;L<D;L++)l[L*2]!==0?(r.heap[++r.heap_len]=ee=L,r.depth[L]=0):l[L*2+1]=0;for(;r.heap_len<2;)U=r.heap[++r.heap_len]=ee<2?++ee:0,l[U*2]=1,r.depth[U]=0,r.opt_len--,I&&(r.static_len-=v[U*2+1]);for(g.max_code=ee,L=r.heap_len>>1;L>=1;L--)pqdownheap(r,l,L);U=D;do L=r.heap[1],r.heap[1]=r.heap[r.heap_len--],pqdownheap(r,l,1),S=r.heap[1],r.heap[--r.heap_max]=L,r.heap[--r.heap_max]=S,l[U*2]=l[L*2]+l[S*2],r.depth[U]=(r.depth[L]>=r.depth[S]?r.depth[L]:r.depth[S])+1,l[L*2+1]=l[S*2+1]=U,r.heap[1]=U++,pqdownheap(r,l,1);while(r.heap_len>=2);r.heap[--r.heap_max]=r.heap[1],gen_bitlen(r,g),gen_codes(l,ee,r.bl_count)}function scan_tree(r,g,l){var v,I=-1,D,L=g[0*2+1],S=0,ee=7,U=4;for(L===0&&(ee=138,U=3),g[(l+1)*2+1]=65535,v=0;v<=l;v++)D=L,L=g[(v+1)*2+1],!(++S<ee&&D===L)&&(S<U?r.bl_tree[D*2]+=S:D!==0?(D!==I&&r.bl_tree[D*2]++,r.bl_tree[REP_3_6*2]++):S<=10?r.bl_tree[REPZ_3_10*2]++:r.bl_tree[REPZ_11_138*2]++,S=0,I=D,L===0?(ee=138,U=3):D===L?(ee=6,U=3):(ee=7,U=4))}function send_tree(r,g,l){var v,I=-1,D,L=g[0*2+1],S=0,ee=7,U=4;for(L===0&&(ee=138,U=3),v=0;v<=l;v++)if(D=L,L=g[(v+1)*2+1],!(++S<ee&&D===L)){if(S<U)do send_code(r,D,r.bl_tree);while(--S!==0);else D!==0?(D!==I&&(send_code(r,D,r.bl_tree),S--),send_code(r,REP_3_6,r.bl_tree),send_bits(r,S-3,2)):S<=10?(send_code(r,REPZ_3_10,r.bl_tree),send_bits(r,S-3,3)):(send_code(r,REPZ_11_138,r.bl_tree),send_bits(r,S-11,7));S=0,I=D,L===0?(ee=138,U=3):D===L?(ee=6,U=3):(ee=7,U=4)}}function build_bl_tree(r){var g;for(scan_tree(r,r.dyn_ltree,r.l_desc.max_code),scan_tree(r,r.dyn_dtree,r.d_desc.max_code),build_tree(r,r.bl_desc),g=BL_CODES$1-1;g>=3&&r.bl_tree[bl_order[g]*2+1]===0;g--);return r.opt_len+=3*(g+1)+5+5+4,g}function send_all_trees(r,g,l,v){var I;for(send_bits(r,g-257,5),send_bits(r,l-1,5),send_bits(r,v-4,4),I=0;I<v;I++)send_bits(r,r.bl_tree[bl_order[I]*2+1],3);send_tree(r,r.dyn_ltree,g-1),send_tree(r,r.dyn_dtree,l-1)}function detect_data_type(r){var g=4093624447,l;for(l=0;l<=31;l++,g>>>=1)if(g&1&&r.dyn_ltree[l*2]!==0)return Z_BINARY;if(r.dyn_ltree[9*2]!==0||r.dyn_ltree[10*2]!==0||r.dyn_ltree[13*2]!==0)return Z_TEXT;for(l=32;l<LITERALS$1;l++)if(r.dyn_ltree[l*2]!==0)return Z_TEXT;return Z_BINARY}var static_init_done=!1;function _tr_init(r){static_init_done||(tr_static_init(),static_init_done=!0),r.l_desc=new TreeDesc(r.dyn_ltree,static_l_desc),r.d_desc=new TreeDesc(r.dyn_dtree,static_d_desc),r.bl_desc=new TreeDesc(r.bl_tree,static_bl_desc),r.bi_buf=0,r.bi_valid=0,init_block(r)}function _tr_stored_block(r,g,l,v){send_bits(r,(STORED_BLOCK<<1)+(v?1:0),3),copy_block(r,g,l,!0)}function _tr_align(r){send_bits(r,STATIC_TREES<<1,3),send_code(r,END_BLOCK,static_ltree),bi_flush(r)}function _tr_flush_block(r,g,l,v){var I,D,L=0;r.level>0?(r.strm.data_type===Z_UNKNOWN$1&&(r.strm.data_type=detect_data_type(r)),build_tree(r,r.l_desc),build_tree(r,r.d_desc),L=build_bl_tree(r),I=r.opt_len+3+7>>>3,D=r.static_len+3+7>>>3,D<=I&&(I=D)):I=D=l+5,l+4<=I&&g!==-1?_tr_stored_block(r,g,l,v):r.strategy===Z_FIXED$1||D===I?(send_bits(r,(STATIC_TREES<<1)+(v?1:0),3),compress_block(r,static_ltree,static_dtree)):(send_bits(r,(DYN_TREES<<1)+(v?1:0),3),send_all_trees(r,r.l_desc.max_code+1,r.d_desc.max_code+1,L+1),compress_block(r,r.dyn_ltree,r.dyn_dtree)),init_block(r),v&&bi_windup(r)}function _tr_tally(r,g,l){return r.pending_buf[r.d_buf+r.last_lit*2]=g>>>8&255,r.pending_buf[r.d_buf+r.last_lit*2+1]=g&255,r.pending_buf[r.l_buf+r.last_lit]=l&255,r.last_lit++,g===0?r.dyn_ltree[l*2]++:(r.matches++,g--,r.dyn_ltree[(_length_code[l]+LITERALS$1+1)*2]++,r.dyn_dtree[d_code(g)*2]++),r.last_lit===r.lit_bufsize-1}trees$1._tr_init=_tr_init,trees$1._tr_stored_block=_tr_stored_block,trees$1._tr_flush_block=_tr_flush_block,trees$1._tr_tally=_tr_tally,trees$1._tr_align=_tr_align;function adler32$2(r,g,l,v){for(var I=r&65535|0,D=r>>>16&65535|0,L=0;l!==0;){L=l>2e3?2e3:l,l-=L;do I=I+g[v++]|0,D=D+I|0;while(--L);I%=65521,D%=65521}return I|D<<16|0}var adler32_1=adler32$2;function makeTable(){for(var r,g=[],l=0;l<256;l++){r=l;for(var v=0;v<8;v++)r=r&1?3988292384^r>>>1:r>>>1;g[l]=r}return g}var crcTable=makeTable();function crc32$3(r,g,l,v){var I=crcTable,D=v+l;r^=-1;for(var L=v;L<D;L++)r=r>>>8^I[(r^g[L])&255];return r^-1}var crc32_1=crc32$3,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},utils$i=common,trees=trees$1,adler32$1=adler32_1,crc32$2=crc32_1,msg$2=messages,Z_NO_FLUSH$1=0,Z_PARTIAL_FLUSH=1,Z_FULL_FLUSH=3,Z_FINISH$2=4,Z_BLOCK$1=5,Z_OK$2=0,Z_STREAM_END$2=1,Z_STREAM_ERROR$1=-2,Z_DATA_ERROR$1=-3,Z_BUF_ERROR$1=-5,Z_DEFAULT_COMPRESSION$1=-1,Z_FILTERED=1,Z_HUFFMAN_ONLY=2,Z_RLE=3,Z_FIXED=4,Z_DEFAULT_STRATEGY$1=0,Z_UNKNOWN=2,Z_DEFLATED$2=8,MAX_MEM_LEVEL=9,MAX_WBITS$1=15,DEF_MEM_LEVEL=8,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,PRESET_DICT=32,INIT_STATE=42,EXTRA_STATE=69,NAME_STATE=73,COMMENT_STATE=91,HCRC_STATE=103,BUSY_STATE=113,FINISH_STATE=666,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,OS_CODE=3;function err(r,g){return r.msg=msg$2[g],g}function rank(r){return(r<<1)-(r>4?9:0)}function zero(r){for(var g=r.length;--g>=0;)r[g]=0}function flush_pending(r){var g=r.state,l=g.pending;l>r.avail_out&&(l=r.avail_out),l!==0&&(utils$i.arraySet(r.output,g.pending_buf,g.pending_out,l,r.next_out),r.next_out+=l,g.pending_out+=l,r.total_out+=l,r.avail_out-=l,g.pending-=l,g.pending===0&&(g.pending_out=0))}function flush_block_only(r,g){trees._tr_flush_block(r,r.block_start>=0?r.block_start:-1,r.strstart-r.block_start,g),r.block_start=r.strstart,flush_pending(r.strm)}function put_byte(r,g){r.pending_buf[r.pending++]=g}function putShortMSB(r,g){r.pending_buf[r.pending++]=g>>>8&255,r.pending_buf[r.pending++]=g&255}function read_buf(r,g,l,v){var I=r.avail_in;return I>v&&(I=v),I===0?0:(r.avail_in-=I,utils$i.arraySet(g,r.input,r.next_in,I,l),r.state.wrap===1?r.adler=adler32$1(r.adler,g,I,l):r.state.wrap===2&&(r.adler=crc32$2(r.adler,g,I,l)),r.next_in+=I,r.total_in+=I,I)}function longest_match(r,g){var l=r.max_chain_length,v=r.strstart,I,D,L=r.prev_length,S=r.nice_match,ee=r.strstart>r.w_size-MIN_LOOKAHEAD?r.strstart-(r.w_size-MIN_LOOKAHEAD):0,U=r.window,Y=r.w_mask,$e=r.prev,_e=r.strstart+MAX_MATCH,ve=U[v+L-1],we=U[v+L];r.prev_length>=r.good_match&&(l>>=2),S>r.lookahead&&(S=r.lookahead);do if(I=g,!(U[I+L]!==we||U[I+L-1]!==ve||U[I]!==U[v]||U[++I]!==U[v+1])){v+=2,I++;do;while(U[++v]===U[++I]&&U[++v]===U[++I]&&U[++v]===U[++I]&&U[++v]===U[++I]&&U[++v]===U[++I]&&U[++v]===U[++I]&&U[++v]===U[++I]&&U[++v]===U[++I]&&v<_e);if(D=MAX_MATCH-(_e-v),v=_e-MAX_MATCH,D>L){if(r.match_start=g,L=D,D>=S)break;ve=U[v+L-1],we=U[v+L]}}while((g=$e[g&Y])>ee&&--l!==0);return L<=r.lookahead?L:r.lookahead}function fill_window(r){var g=r.w_size,l,v,I,D,L;do{if(D=r.window_size-r.lookahead-r.strstart,r.strstart>=g+(g-MIN_LOOKAHEAD)){utils$i.arraySet(r.window,r.window,g,g,0),r.match_start-=g,r.strstart-=g,r.block_start-=g,v=r.hash_size,l=v;do I=r.head[--l],r.head[l]=I>=g?I-g:0;while(--v);v=g,l=v;do I=r.prev[--l],r.prev[l]=I>=g?I-g:0;while(--v);D+=g}if(r.strm.avail_in===0)break;if(v=read_buf(r.strm,r.window,r.strstart+r.lookahead,D),r.lookahead+=v,r.lookahead+r.insert>=MIN_MATCH)for(L=r.strstart-r.insert,r.ins_h=r.window[L],r.ins_h=(r.ins_h<<r.hash_shift^r.window[L+1])&r.hash_mask;r.insert&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[L+MIN_MATCH-1])&r.hash_mask,r.prev[L&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=L,L++,r.insert--,!(r.lookahead+r.insert<MIN_MATCH)););}while(r.lookahead<MIN_LOOKAHEAD&&r.strm.avail_in!==0)}function deflate_stored(r,g){var l=65535;for(l>r.pending_buf_size-5&&(l=r.pending_buf_size-5);;){if(r.lookahead<=1){if(fill_window(r),r.lookahead===0&&g===Z_NO_FLUSH$1)return BS_NEED_MORE;if(r.lookahead===0)break}r.strstart+=r.lookahead,r.lookahead=0;var v=r.block_start+l;if((r.strstart===0||r.strstart>=v)&&(r.lookahead=r.strstart-v,r.strstart=v,flush_block_only(r,!1),r.strm.avail_out===0)||r.strstart-r.block_start>=r.w_size-MIN_LOOKAHEAD&&(flush_block_only(r,!1),r.strm.avail_out===0))return BS_NEED_MORE}return r.insert=0,g===Z_FINISH$2?(flush_block_only(r,!0),r.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):(r.strstart>r.block_start&&(flush_block_only(r,!1),r.strm.avail_out===0),BS_NEED_MORE)}function deflate_fast(r,g){for(var l,v;;){if(r.lookahead<MIN_LOOKAHEAD){if(fill_window(r),r.lookahead<MIN_LOOKAHEAD&&g===Z_NO_FLUSH$1)return BS_NEED_MORE;if(r.lookahead===0)break}if(l=0,r.lookahead>=MIN_MATCH&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+MIN_MATCH-1])&r.hash_mask,l=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),l!==0&&r.strstart-l<=r.w_size-MIN_LOOKAHEAD&&(r.match_length=longest_match(r,l)),r.match_length>=MIN_MATCH)if(v=trees._tr_tally(r,r.strstart-r.match_start,r.match_length-MIN_MATCH),r.lookahead-=r.match_length,r.match_length<=r.max_lazy_match&&r.lookahead>=MIN_MATCH){r.match_length--;do r.strstart++,r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+MIN_MATCH-1])&r.hash_mask,l=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart;while(--r.match_length!==0);r.strstart++}else r.strstart+=r.match_length,r.match_length=0,r.ins_h=r.window[r.strstart],r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+1])&r.hash_mask;else v=trees._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++;if(v&&(flush_block_only(r,!1),r.strm.avail_out===0))return BS_NEED_MORE}return r.insert=r.strstart<MIN_MATCH-1?r.strstart:MIN_MATCH-1,g===Z_FINISH$2?(flush_block_only(r,!0),r.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):r.last_lit&&(flush_block_only(r,!1),r.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_slow(r,g){for(var l,v,I;;){if(r.lookahead<MIN_LOOKAHEAD){if(fill_window(r),r.lookahead<MIN_LOOKAHEAD&&g===Z_NO_FLUSH$1)return BS_NEED_MORE;if(r.lookahead===0)break}if(l=0,r.lookahead>=MIN_MATCH&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+MIN_MATCH-1])&r.hash_mask,l=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),r.prev_length=r.match_length,r.prev_match=r.match_start,r.match_length=MIN_MATCH-1,l!==0&&r.prev_length<r.max_lazy_match&&r.strstart-l<=r.w_size-MIN_LOOKAHEAD&&(r.match_length=longest_match(r,l),r.match_length<=5&&(r.strategy===Z_FILTERED||r.match_length===MIN_MATCH&&r.strstart-r.match_start>4096)&&(r.match_length=MIN_MATCH-1)),r.prev_length>=MIN_MATCH&&r.match_length<=r.prev_length){I=r.strstart+r.lookahead-MIN_MATCH,v=trees._tr_tally(r,r.strstart-1-r.prev_match,r.prev_length-MIN_MATCH),r.lookahead-=r.prev_length-1,r.prev_length-=2;do++r.strstart<=I&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+MIN_MATCH-1])&r.hash_mask,l=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart);while(--r.prev_length!==0);if(r.match_available=0,r.match_length=MIN_MATCH-1,r.strstart++,v&&(flush_block_only(r,!1),r.strm.avail_out===0))return BS_NEED_MORE}else if(r.match_available){if(v=trees._tr_tally(r,0,r.window[r.strstart-1]),v&&flush_block_only(r,!1),r.strstart++,r.lookahead--,r.strm.avail_out===0)return BS_NEED_MORE}else r.match_available=1,r.strstart++,r.lookahead--}return r.match_available&&(v=trees._tr_tally(r,0,r.window[r.strstart-1]),r.match_available=0),r.insert=r.strstart<MIN_MATCH-1?r.strstart:MIN_MATCH-1,g===Z_FINISH$2?(flush_block_only(r,!0),r.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):r.last_lit&&(flush_block_only(r,!1),r.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_rle(r,g){for(var l,v,I,D,L=r.window;;){if(r.lookahead<=MAX_MATCH){if(fill_window(r),r.lookahead<=MAX_MATCH&&g===Z_NO_FLUSH$1)return BS_NEED_MORE;if(r.lookahead===0)break}if(r.match_length=0,r.lookahead>=MIN_MATCH&&r.strstart>0&&(I=r.strstart-1,v=L[I],v===L[++I]&&v===L[++I]&&v===L[++I])){D=r.strstart+MAX_MATCH;do;while(v===L[++I]&&v===L[++I]&&v===L[++I]&&v===L[++I]&&v===L[++I]&&v===L[++I]&&v===L[++I]&&v===L[++I]&&I<D);r.match_length=MAX_MATCH-(D-I),r.match_length>r.lookahead&&(r.match_length=r.lookahead)}if(r.match_length>=MIN_MATCH?(l=trees._tr_tally(r,1,r.match_length-MIN_MATCH),r.lookahead-=r.match_length,r.strstart+=r.match_length,r.match_length=0):(l=trees._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++),l&&(flush_block_only(r,!1),r.strm.avail_out===0))return BS_NEED_MORE}return r.insert=0,g===Z_FINISH$2?(flush_block_only(r,!0),r.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):r.last_lit&&(flush_block_only(r,!1),r.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_huff(r,g){for(var l;;){if(r.lookahead===0&&(fill_window(r),r.lookahead===0)){if(g===Z_NO_FLUSH$1)return BS_NEED_MORE;break}if(r.match_length=0,l=trees._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++,l&&(flush_block_only(r,!1),r.strm.avail_out===0))return BS_NEED_MORE}return r.insert=0,g===Z_FINISH$2?(flush_block_only(r,!0),r.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):r.last_lit&&(flush_block_only(r,!1),r.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function Config(r,g,l,v,I){this.good_length=r,this.max_lazy=g,this.nice_length=l,this.max_chain=v,this.func=I}var configuration_table;configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)];function lm_init(r){r.window_size=2*r.w_size,zero(r.head),r.max_lazy_match=configuration_table[r.level].max_lazy,r.good_match=configuration_table[r.level].good_length,r.nice_match=configuration_table[r.level].nice_length,r.max_chain_length=configuration_table[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=MIN_MATCH-1,r.match_available=0,r.ins_h=0}function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED$2,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new utils$i.Buf16(HEAP_SIZE*2),this.dyn_dtree=new utils$i.Buf16((2*D_CODES+1)*2),this.bl_tree=new utils$i.Buf16((2*BL_CODES+1)*2),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new utils$i.Buf16(MAX_BITS+1),this.heap=new utils$i.Buf16(2*L_CODES+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new utils$i.Buf16(2*L_CODES+1),zero(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function deflateResetKeep(r){var g;return!r||!r.state?err(r,Z_STREAM_ERROR$1):(r.total_in=r.total_out=0,r.data_type=Z_UNKNOWN,g=r.state,g.pending=0,g.pending_out=0,g.wrap<0&&(g.wrap=-g.wrap),g.status=g.wrap?INIT_STATE:BUSY_STATE,r.adler=g.wrap===2?0:1,g.last_flush=Z_NO_FLUSH$1,trees._tr_init(g),Z_OK$2)}function deflateReset(r){var g=deflateResetKeep(r);return g===Z_OK$2&&lm_init(r.state),g}function deflateSetHeader(r,g){return!r||!r.state||r.state.wrap!==2?Z_STREAM_ERROR$1:(r.state.gzhead=g,Z_OK$2)}function deflateInit2(r,g,l,v,I,D){if(!r)return Z_STREAM_ERROR$1;var L=1;if(g===Z_DEFAULT_COMPRESSION$1&&(g=6),v<0?(L=0,v=-v):v>15&&(L=2,v-=16),I<1||I>MAX_MEM_LEVEL||l!==Z_DEFLATED$2||v<8||v>15||g<0||g>9||D<0||D>Z_FIXED)return err(r,Z_STREAM_ERROR$1);v===8&&(v=9);var S=new DeflateState;return r.state=S,S.strm=r,S.wrap=L,S.gzhead=null,S.w_bits=v,S.w_size=1<<S.w_bits,S.w_mask=S.w_size-1,S.hash_bits=I+7,S.hash_size=1<<S.hash_bits,S.hash_mask=S.hash_size-1,S.hash_shift=~~((S.hash_bits+MIN_MATCH-1)/MIN_MATCH),S.window=new utils$i.Buf8(S.w_size*2),S.head=new utils$i.Buf16(S.hash_size),S.prev=new utils$i.Buf16(S.w_size),S.lit_bufsize=1<<I+6,S.pending_buf_size=S.lit_bufsize*4,S.pending_buf=new utils$i.Buf8(S.pending_buf_size),S.d_buf=1*S.lit_bufsize,S.l_buf=3*S.lit_bufsize,S.level=g,S.strategy=D,S.method=l,deflateReset(r)}function deflateInit(r,g){return deflateInit2(r,g,Z_DEFLATED$2,MAX_WBITS$1,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY$1)}function deflate$2(r,g){var l,v,I,D;if(!r||!r.state||g>Z_BLOCK$1||g<0)return r?err(r,Z_STREAM_ERROR$1):Z_STREAM_ERROR$1;if(v=r.state,!r.output||!r.input&&r.avail_in!==0||v.status===FINISH_STATE&&g!==Z_FINISH$2)return err(r,r.avail_out===0?Z_BUF_ERROR$1:Z_STREAM_ERROR$1);if(v.strm=r,l=v.last_flush,v.last_flush=g,v.status===INIT_STATE)if(v.wrap===2)r.adler=0,put_byte(v,31),put_byte(v,139),put_byte(v,8),v.gzhead?(put_byte(v,(v.gzhead.text?1:0)+(v.gzhead.hcrc?2:0)+(v.gzhead.extra?4:0)+(v.gzhead.name?8:0)+(v.gzhead.comment?16:0)),put_byte(v,v.gzhead.time&255),put_byte(v,v.gzhead.time>>8&255),put_byte(v,v.gzhead.time>>16&255),put_byte(v,v.gzhead.time>>24&255),put_byte(v,v.level===9?2:v.strategy>=Z_HUFFMAN_ONLY||v.level<2?4:0),put_byte(v,v.gzhead.os&255),v.gzhead.extra&&v.gzhead.extra.length&&(put_byte(v,v.gzhead.extra.length&255),put_byte(v,v.gzhead.extra.length>>8&255)),v.gzhead.hcrc&&(r.adler=crc32$2(r.adler,v.pending_buf,v.pending,0)),v.gzindex=0,v.status=EXTRA_STATE):(put_byte(v,0),put_byte(v,0),put_byte(v,0),put_byte(v,0),put_byte(v,0),put_byte(v,v.level===9?2:v.strategy>=Z_HUFFMAN_ONLY||v.level<2?4:0),put_byte(v,OS_CODE),v.status=BUSY_STATE);else{var L=Z_DEFLATED$2+(v.w_bits-8<<4)<<8,S=-1;v.strategy>=Z_HUFFMAN_ONLY||v.level<2?S=0:v.level<6?S=1:v.level===6?S=2:S=3,L|=S<<6,v.strstart!==0&&(L|=PRESET_DICT),L+=31-L%31,v.status=BUSY_STATE,putShortMSB(v,L),v.strstart!==0&&(putShortMSB(v,r.adler>>>16),putShortMSB(v,r.adler&65535)),r.adler=1}if(v.status===EXTRA_STATE)if(v.gzhead.extra){for(I=v.pending;v.gzindex<(v.gzhead.extra.length&65535)&&!(v.pending===v.pending_buf_size&&(v.gzhead.hcrc&&v.pending>I&&(r.adler=crc32$2(r.adler,v.pending_buf,v.pending-I,I)),flush_pending(r),I=v.pending,v.pending===v.pending_buf_size));)put_byte(v,v.gzhead.extra[v.gzindex]&255),v.gzindex++;v.gzhead.hcrc&&v.pending>I&&(r.adler=crc32$2(r.adler,v.pending_buf,v.pending-I,I)),v.gzindex===v.gzhead.extra.length&&(v.gzindex=0,v.status=NAME_STATE)}else v.status=NAME_STATE;if(v.status===NAME_STATE)if(v.gzhead.name){I=v.pending;do{if(v.pending===v.pending_buf_size&&(v.gzhead.hcrc&&v.pending>I&&(r.adler=crc32$2(r.adler,v.pending_buf,v.pending-I,I)),flush_pending(r),I=v.pending,v.pending===v.pending_buf_size)){D=1;break}v.gzindex<v.gzhead.name.length?D=v.gzhead.name.charCodeAt(v.gzindex++)&255:D=0,put_byte(v,D)}while(D!==0);v.gzhead.hcrc&&v.pending>I&&(r.adler=crc32$2(r.adler,v.pending_buf,v.pending-I,I)),D===0&&(v.gzindex=0,v.status=COMMENT_STATE)}else v.status=COMMENT_STATE;if(v.status===COMMENT_STATE)if(v.gzhead.comment){I=v.pending;do{if(v.pending===v.pending_buf_size&&(v.gzhead.hcrc&&v.pending>I&&(r.adler=crc32$2(r.adler,v.pending_buf,v.pending-I,I)),flush_pending(r),I=v.pending,v.pending===v.pending_buf_size)){D=1;break}v.gzindex<v.gzhead.comment.length?D=v.gzhead.comment.charCodeAt(v.gzindex++)&255:D=0,put_byte(v,D)}while(D!==0);v.gzhead.hcrc&&v.pending>I&&(r.adler=crc32$2(r.adler,v.pending_buf,v.pending-I,I)),D===0&&(v.status=HCRC_STATE)}else v.status=HCRC_STATE;if(v.status===HCRC_STATE&&(v.gzhead.hcrc?(v.pending+2>v.pending_buf_size&&flush_pending(r),v.pending+2<=v.pending_buf_size&&(put_byte(v,r.adler&255),put_byte(v,r.adler>>8&255),r.adler=0,v.status=BUSY_STATE)):v.status=BUSY_STATE),v.pending!==0){if(flush_pending(r),r.avail_out===0)return v.last_flush=-1,Z_OK$2}else if(r.avail_in===0&&rank(g)<=rank(l)&&g!==Z_FINISH$2)return err(r,Z_BUF_ERROR$1);if(v.status===FINISH_STATE&&r.avail_in!==0)return err(r,Z_BUF_ERROR$1);if(r.avail_in!==0||v.lookahead!==0||g!==Z_NO_FLUSH$1&&v.status!==FINISH_STATE){var ee=v.strategy===Z_HUFFMAN_ONLY?deflate_huff(v,g):v.strategy===Z_RLE?deflate_rle(v,g):configuration_table[v.level].func(v,g);if((ee===BS_FINISH_STARTED||ee===BS_FINISH_DONE)&&(v.status=FINISH_STATE),ee===BS_NEED_MORE||ee===BS_FINISH_STARTED)return r.avail_out===0&&(v.last_flush=-1),Z_OK$2;if(ee===BS_BLOCK_DONE&&(g===Z_PARTIAL_FLUSH?trees._tr_align(v):g!==Z_BLOCK$1&&(trees._tr_stored_block(v,0,0,!1),g===Z_FULL_FLUSH&&(zero(v.head),v.lookahead===0&&(v.strstart=0,v.block_start=0,v.insert=0))),flush_pending(r),r.avail_out===0))return v.last_flush=-1,Z_OK$2}return g!==Z_FINISH$2?Z_OK$2:v.wrap<=0?Z_STREAM_END$2:(v.wrap===2?(put_byte(v,r.adler&255),put_byte(v,r.adler>>8&255),put_byte(v,r.adler>>16&255),put_byte(v,r.adler>>24&255),put_byte(v,r.total_in&255),put_byte(v,r.total_in>>8&255),put_byte(v,r.total_in>>16&255),put_byte(v,r.total_in>>24&255)):(putShortMSB(v,r.adler>>>16),putShortMSB(v,r.adler&65535)),flush_pending(r),v.wrap>0&&(v.wrap=-v.wrap),v.pending!==0?Z_OK$2:Z_STREAM_END$2)}function deflateEnd(r){var g;return!r||!r.state?Z_STREAM_ERROR$1:(g=r.state.status,g!==INIT_STATE&&g!==EXTRA_STATE&&g!==NAME_STATE&&g!==COMMENT_STATE&&g!==HCRC_STATE&&g!==BUSY_STATE&&g!==FINISH_STATE?err(r,Z_STREAM_ERROR$1):(r.state=null,g===BUSY_STATE?err(r,Z_DATA_ERROR$1):Z_OK$2))}function deflateSetDictionary(r,g){var l=g.length,v,I,D,L,S,ee,U,Y;if(!r||!r.state||(v=r.state,L=v.wrap,L===2||L===1&&v.status!==INIT_STATE||v.lookahead))return Z_STREAM_ERROR$1;for(L===1&&(r.adler=adler32$1(r.adler,g,l,0)),v.wrap=0,l>=v.w_size&&(L===0&&(zero(v.head),v.strstart=0,v.block_start=0,v.insert=0),Y=new utils$i.Buf8(v.w_size),utils$i.arraySet(Y,g,l-v.w_size,v.w_size,0),g=Y,l=v.w_size),S=r.avail_in,ee=r.next_in,U=r.input,r.avail_in=l,r.next_in=0,r.input=g,fill_window(v);v.lookahead>=MIN_MATCH;){I=v.strstart,D=v.lookahead-(MIN_MATCH-1);do v.ins_h=(v.ins_h<<v.hash_shift^v.window[I+MIN_MATCH-1])&v.hash_mask,v.prev[I&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=I,I++;while(--D);v.strstart=I,v.lookahead=MIN_MATCH-1,fill_window(v)}return v.strstart+=v.lookahead,v.block_start=v.strstart,v.insert=v.lookahead,v.lookahead=0,v.match_length=v.prev_length=MIN_MATCH-1,v.match_available=0,r.next_in=ee,r.input=U,r.avail_in=S,v.wrap=L,Z_OK$2}deflate$3.deflateInit=deflateInit,deflate$3.deflateInit2=deflateInit2,deflate$3.deflateReset=deflateReset,deflate$3.deflateResetKeep=deflateResetKeep,deflate$3.deflateSetHeader=deflateSetHeader,deflate$3.deflate=deflate$2,deflate$3.deflateEnd=deflateEnd,deflate$3.deflateSetDictionary=deflateSetDictionary,deflate$3.deflateInfo="pako deflate (from Nodeca project)";var strings$2={},utils$h=common,STR_APPLY_OK=!0,STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,[0])}catch(r){STR_APPLY_OK=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(r){STR_APPLY_UIA_OK=!1}for(var _utf8len=new utils$h.Buf8(256),q$1=0;q$1<256;q$1++)_utf8len[q$1]=q$1>=252?6:q$1>=248?5:q$1>=240?4:q$1>=224?3:q$1>=192?2:1;_utf8len[254]=_utf8len[254]=1,strings$2.string2buf=function(r){var g,l,v,I,D,L=r.length,S=0;for(I=0;I<L;I++)l=r.charCodeAt(I),(l&64512)===55296&&I+1<L&&(v=r.charCodeAt(I+1),(v&64512)===56320&&(l=65536+(l-55296<<10)+(v-56320),I++)),S+=l<128?1:l<2048?2:l<65536?3:4;for(g=new utils$h.Buf8(S),D=0,I=0;D<S;I++)l=r.charCodeAt(I),(l&64512)===55296&&I+1<L&&(v=r.charCodeAt(I+1),(v&64512)===56320&&(l=65536+(l-55296<<10)+(v-56320),I++)),l<128?g[D++]=l:l<2048?(g[D++]=192|l>>>6,g[D++]=128|l&63):l<65536?(g[D++]=224|l>>>12,g[D++]=128|l>>>6&63,g[D++]=128|l&63):(g[D++]=240|l>>>18,g[D++]=128|l>>>12&63,g[D++]=128|l>>>6&63,g[D++]=128|l&63);return g};function buf2binstring(r,g){if(g<65534&&(r.subarray&&STR_APPLY_UIA_OK||!r.subarray&&STR_APPLY_OK))return String.fromCharCode.apply(null,utils$h.shrinkBuf(r,g));for(var l="",v=0;v<g;v++)l+=String.fromCharCode(r[v]);return l}strings$2.buf2binstring=function(r){return buf2binstring(r,r.length)},strings$2.binstring2buf=function(r){for(var g=new utils$h.Buf8(r.length),l=0,v=g.length;l<v;l++)g[l]=r.charCodeAt(l);return g},strings$2.buf2string=function(r,g){var l,v,I,D,L=g||r.length,S=new Array(L*2);for(v=0,l=0;l<L;){if(I=r[l++],I<128){S[v++]=I;continue}if(D=_utf8len[I],D>4){S[v++]=65533,l+=D-1;continue}for(I&=D===2?31:D===3?15:7;D>1&&l<L;)I=I<<6|r[l++]&63,D--;if(D>1){S[v++]=65533;continue}I<65536?S[v++]=I:(I-=65536,S[v++]=55296|I>>10&1023,S[v++]=56320|I&1023)}return buf2binstring(S,v)},strings$2.utf8border=function(r,g){var l;for(g=g||r.length,g>r.length&&(g=r.length),l=g-1;l>=0&&(r[l]&192)===128;)l--;return l<0||l===0?g:l+_utf8len[r[l]]>g?l:g};function ZStream$2(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream=ZStream$2,zlib_deflate=deflate$3,utils$g=common,strings$1=strings$2,msg$1=messages,ZStream$1=zstream,toString$1=Object.prototype.toString,Z_NO_FLUSH=0,Z_FINISH$1=4,Z_OK$1=0,Z_STREAM_END$1=1,Z_SYNC_FLUSH=2,Z_DEFAULT_COMPRESSION=-1,Z_DEFAULT_STRATEGY=0,Z_DEFLATED$1=8;function Deflate(r){if(!(this instanceof Deflate))return new Deflate(r);this.options=utils$g.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED$1,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY,to:""},r||{});var g=this.options;g.raw&&g.windowBits>0?g.windowBits=-g.windowBits:g.gzip&&g.windowBits>0&&g.windowBits<16&&(g.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream$1,this.strm.avail_out=0;var l=zlib_deflate.deflateInit2(this.strm,g.level,g.method,g.windowBits,g.memLevel,g.strategy);if(l!==Z_OK$1)throw new Error(msg$1[l]);if(g.header&&zlib_deflate.deflateSetHeader(this.strm,g.header),g.dictionary){var v;if(typeof g.dictionary=="string"?v=strings$1.string2buf(g.dictionary):toString$1.call(g.dictionary)==="[object ArrayBuffer]"?v=new Uint8Array(g.dictionary):v=g.dictionary,l=zlib_deflate.deflateSetDictionary(this.strm,v),l!==Z_OK$1)throw new Error(msg$1[l]);this._dict_set=!0}}Deflate.prototype.push=function(r,g){var l=this.strm,v=this.options.chunkSize,I,D;if(this.ended)return!1;D=g===~~g?g:g===!0?Z_FINISH$1:Z_NO_FLUSH,typeof r=="string"?l.input=strings$1.string2buf(r):toString$1.call(r)==="[object ArrayBuffer]"?l.input=new Uint8Array(r):l.input=r,l.next_in=0,l.avail_in=l.input.length;do{if(l.avail_out===0&&(l.output=new utils$g.Buf8(v),l.next_out=0,l.avail_out=v),I=zlib_deflate.deflate(l,D),I!==Z_STREAM_END$1&&I!==Z_OK$1)return this.onEnd(I),this.ended=!0,!1;(l.avail_out===0||l.avail_in===0&&(D===Z_FINISH$1||D===Z_SYNC_FLUSH))&&(this.options.to==="string"?this.onData(strings$1.buf2binstring(utils$g.shrinkBuf(l.output,l.next_out))):this.onData(utils$g.shrinkBuf(l.output,l.next_out)))}while((l.avail_in>0||l.avail_out===0)&&I!==Z_STREAM_END$1);return D===Z_FINISH$1?(I=zlib_deflate.deflateEnd(this.strm),this.onEnd(I),this.ended=!0,I===Z_OK$1):(D===Z_SYNC_FLUSH&&(this.onEnd(Z_OK$1),l.avail_out=0),!0)},Deflate.prototype.onData=function(r){this.chunks.push(r)},Deflate.prototype.onEnd=function(r){r===Z_OK$1&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=utils$g.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function deflate$1(r,g){var l=new Deflate(g);if(l.push(r,!0),l.err)throw l.msg||msg$1[l.err];return l.result}function deflateRaw(r,g){return g=g||{},g.raw=!0,deflate$1(r,g)}function gzip(r,g){return g=g||{},g.gzip=!0,deflate$1(r,g)}deflate$4.Deflate=Deflate,deflate$4.deflate=deflate$1,deflate$4.deflateRaw=deflateRaw,deflate$4.gzip=gzip;var inflate$4={},inflate$3={},BAD$1=30,TYPE$1=12,inffast=function(g,l){var v,I,D,L,S,ee,U,Y,$e,_e,ve,we,Se,Ie,Ne,Ce,Be,Re,Oe,Ue,Le,Me,xe,He,Fe;v=g.state,I=g.next_in,He=g.input,D=I+(g.avail_in-5),L=g.next_out,Fe=g.output,S=L-(l-g.avail_out),ee=L+(g.avail_out-257),U=v.dmax,Y=v.wsize,$e=v.whave,_e=v.wnext,ve=v.window,we=v.hold,Se=v.bits,Ie=v.lencode,Ne=v.distcode,Ce=(1<<v.lenbits)-1,Be=(1<<v.distbits)-1;e:do{Se<15&&(we+=He[I++]<<Se,Se+=8,we+=He[I++]<<Se,Se+=8),Re=Ie[we&Ce];t:for(;;){if(Oe=Re>>>24,we>>>=Oe,Se-=Oe,Oe=Re>>>16&255,Oe===0)Fe[L++]=Re&65535;else if(Oe&16){Ue=Re&65535,Oe&=15,Oe&&(Se<Oe&&(we+=He[I++]<<Se,Se+=8),Ue+=we&(1<<Oe)-1,we>>>=Oe,Se-=Oe),Se<15&&(we+=He[I++]<<Se,Se+=8,we+=He[I++]<<Se,Se+=8),Re=Ne[we&Be];r:for(;;){if(Oe=Re>>>24,we>>>=Oe,Se-=Oe,Oe=Re>>>16&255,Oe&16){if(Le=Re&65535,Oe&=15,Se<Oe&&(we+=He[I++]<<Se,Se+=8,Se<Oe&&(we+=He[I++]<<Se,Se+=8)),Le+=we&(1<<Oe)-1,Le>U){g.msg="invalid distance too far back",v.mode=BAD$1;break e}if(we>>>=Oe,Se-=Oe,Oe=L-S,Le>Oe){if(Oe=Le-Oe,Oe>$e&&v.sane){g.msg="invalid distance too far back",v.mode=BAD$1;break e}if(Me=0,xe=ve,_e===0){if(Me+=Y-Oe,Oe<Ue){Ue-=Oe;do Fe[L++]=ve[Me++];while(--Oe);Me=L-Le,xe=Fe}}else if(_e<Oe){if(Me+=Y+_e-Oe,Oe-=_e,Oe<Ue){Ue-=Oe;do Fe[L++]=ve[Me++];while(--Oe);if(Me=0,_e<Ue){Oe=_e,Ue-=Oe;do Fe[L++]=ve[Me++];while(--Oe);Me=L-Le,xe=Fe}}}else if(Me+=_e-Oe,Oe<Ue){Ue-=Oe;do Fe[L++]=ve[Me++];while(--Oe);Me=L-Le,xe=Fe}for(;Ue>2;)Fe[L++]=xe[Me++],Fe[L++]=xe[Me++],Fe[L++]=xe[Me++],Ue-=3;Ue&&(Fe[L++]=xe[Me++],Ue>1&&(Fe[L++]=xe[Me++]))}else{Me=L-Le;do Fe[L++]=Fe[Me++],Fe[L++]=Fe[Me++],Fe[L++]=Fe[Me++],Ue-=3;while(Ue>2);Ue&&(Fe[L++]=Fe[Me++],Ue>1&&(Fe[L++]=Fe[Me++]))}}else if((Oe&64)===0){Re=Ne[(Re&65535)+(we&(1<<Oe)-1)];continue r}else{g.msg="invalid distance code",v.mode=BAD$1;break e}break}}else if((Oe&64)===0){Re=Ie[(Re&65535)+(we&(1<<Oe)-1)];continue t}else if(Oe&32){v.mode=TYPE$1;break e}else{g.msg="invalid literal/length code",v.mode=BAD$1;break e}break}}while(I<D&&L<ee);Ue=Se>>3,I-=Ue,Se-=Ue<<3,we&=(1<<Se)-1,g.next_in=I,g.next_out=L,g.avail_in=I<D?5+(D-I):5-(I-D),g.avail_out=L<ee?257+(ee-L):257-(L-ee),v.hold=we,v.bits=Se},utils$f=common,MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],lext=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],dbase=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],dext=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],inftrees=function(g,l,v,I,D,L,S,ee){var U=ee.bits,Y=0,$e=0,_e=0,ve=0,we=0,Se=0,Ie=0,Ne=0,Ce=0,Be=0,Re,Oe,Ue,Le,Me,xe=null,He=0,Fe,Pe=new utils$f.Buf16(MAXBITS+1),rt=new utils$f.Buf16(MAXBITS+1),Ye=null,it=0,nt,Ze,at;for(Y=0;Y<=MAXBITS;Y++)Pe[Y]=0;for($e=0;$e<I;$e++)Pe[l[v+$e]]++;for(we=U,ve=MAXBITS;ve>=1&&Pe[ve]===0;ve--);if(we>ve&&(we=ve),ve===0)return D[L++]=1<<24|64<<16|0,D[L++]=1<<24|64<<16|0,ee.bits=1,0;for(_e=1;_e<ve&&Pe[_e]===0;_e++);for(we<_e&&(we=_e),Ne=1,Y=1;Y<=MAXBITS;Y++)if(Ne<<=1,Ne-=Pe[Y],Ne<0)return-1;if(Ne>0&&(g===CODES$1||ve!==1))return-1;for(rt[1]=0,Y=1;Y<MAXBITS;Y++)rt[Y+1]=rt[Y]+Pe[Y];for($e=0;$e<I;$e++)l[v+$e]!==0&&(S[rt[l[v+$e]]++]=$e);if(g===CODES$1?(xe=Ye=S,Fe=19):g===LENS$1?(xe=lbase,He-=257,Ye=lext,it-=257,Fe=256):(xe=dbase,Ye=dext,Fe=-1),Be=0,$e=0,Y=_e,Me=L,Se=we,Ie=0,Ue=-1,Ce=1<<we,Le=Ce-1,g===LENS$1&&Ce>ENOUGH_LENS$1||g===DISTS$1&&Ce>ENOUGH_DISTS$1)return 1;for(;;){nt=Y-Ie,S[$e]<Fe?(Ze=0,at=S[$e]):S[$e]>Fe?(Ze=Ye[it+S[$e]],at=xe[He+S[$e]]):(Ze=96,at=0),Re=1<<Y-Ie,Oe=1<<Se,_e=Oe;do Oe-=Re,D[Me+(Be>>Ie)+Oe]=nt<<24|Ze<<16|at|0;while(Oe!==0);for(Re=1<<Y-1;Be&Re;)Re>>=1;if(Re!==0?(Be&=Re-1,Be+=Re):Be=0,$e++,--Pe[Y]===0){if(Y===ve)break;Y=l[v+S[$e]]}if(Y>we&&(Be&Le)!==Ue){for(Ie===0&&(Ie=we),Me+=_e,Se=Y-Ie,Ne=1<<Se;Se+Ie<ve&&(Ne-=Pe[Se+Ie],!(Ne<=0));)Se++,Ne<<=1;if(Ce+=1<<Se,g===LENS$1&&Ce>ENOUGH_LENS$1||g===DISTS$1&&Ce>ENOUGH_DISTS$1)return 1;Ue=Be&Le,D[Ue]=we<<24|Se<<16|Me-L|0}}return Be!==0&&(D[Me+Be]=Y-Ie<<24|64<<16|0),ee.bits=we,0},utils$e=common,adler32=adler32_1,crc32$1=crc32_1,inflate_fast=inffast,inflate_table=inftrees,CODES=0,LENS=1,DISTS=2,Z_FINISH=4,Z_BLOCK=5,Z_TREES=6,Z_OK=0,Z_STREAM_END=1,Z_NEED_DICT=2,Z_STREAM_ERROR=-2,Z_DATA_ERROR=-3,Z_MEM_ERROR=-4,Z_BUF_ERROR=-5,Z_DEFLATED=8,HEAD=1,FLAGS=2,TIME=3,OS=4,EXLEN=5,EXTRA=6,NAME=7,COMMENT=8,HCRC=9,DICTID=10,DICT=11,TYPE=12,TYPEDO=13,STORED=14,COPY_=15,COPY=16,TABLE=17,LENLENS=18,CODELENS=19,LEN_=20,LEN=21,LENEXT=22,DIST=23,DISTEXT=24,MATCH=25,LIT=26,CHECK=27,LENGTH=28,DONE=29,BAD=30,MEM=31,SYNC=32,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS;function zswap32(r){return(r>>>24&255)+(r>>>8&65280)+((r&65280)<<8)+((r&255)<<24)}function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new utils$e.Buf16(320),this.work=new utils$e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function inflateResetKeep(r){var g;return!r||!r.state?Z_STREAM_ERROR:(g=r.state,r.total_in=r.total_out=g.total=0,r.msg="",g.wrap&&(r.adler=g.wrap&1),g.mode=HEAD,g.last=0,g.havedict=0,g.dmax=32768,g.head=null,g.hold=0,g.bits=0,g.lencode=g.lendyn=new utils$e.Buf32(ENOUGH_LENS),g.distcode=g.distdyn=new utils$e.Buf32(ENOUGH_DISTS),g.sane=1,g.back=-1,Z_OK)}function inflateReset(r){var g;return!r||!r.state?Z_STREAM_ERROR:(g=r.state,g.wsize=0,g.whave=0,g.wnext=0,inflateResetKeep(r))}function inflateReset2(r,g){var l,v;return!r||!r.state||(v=r.state,g<0?(l=0,g=-g):(l=(g>>4)+1,g<48&&(g&=15)),g&&(g<8||g>15))?Z_STREAM_ERROR:(v.window!==null&&v.wbits!==g&&(v.window=null),v.wrap=l,v.wbits=g,inflateReset(r))}function inflateInit2(r,g){var l,v;return r?(v=new InflateState,r.state=v,v.window=null,l=inflateReset2(r,g),l!==Z_OK&&(r.state=null),l):Z_STREAM_ERROR}function inflateInit(r){return inflateInit2(r,DEF_WBITS)}var virgin=!0,lenfix,distfix;function fixedtables(r){if(virgin){var g;for(lenfix=new utils$e.Buf32(512),distfix=new utils$e.Buf32(32),g=0;g<144;)r.lens[g++]=8;for(;g<256;)r.lens[g++]=9;for(;g<280;)r.lens[g++]=7;for(;g<288;)r.lens[g++]=8;for(inflate_table(LENS,r.lens,0,288,lenfix,0,r.work,{bits:9}),g=0;g<32;)r.lens[g++]=5;inflate_table(DISTS,r.lens,0,32,distfix,0,r.work,{bits:5}),virgin=!1}r.lencode=lenfix,r.lenbits=9,r.distcode=distfix,r.distbits=5}function updatewindow(r,g,l,v){var I,D=r.state;return D.window===null&&(D.wsize=1<<D.wbits,D.wnext=0,D.whave=0,D.window=new utils$e.Buf8(D.wsize)),v>=D.wsize?(utils$e.arraySet(D.window,g,l-D.wsize,D.wsize,0),D.wnext=0,D.whave=D.wsize):(I=D.wsize-D.wnext,I>v&&(I=v),utils$e.arraySet(D.window,g,l-v,I,D.wnext),v-=I,v?(utils$e.arraySet(D.window,g,l-v,v,0),D.wnext=v,D.whave=D.wsize):(D.wnext+=I,D.wnext===D.wsize&&(D.wnext=0),D.whave<D.wsize&&(D.whave+=I))),0}function inflate$2(r,g){var l,v,I,D,L,S,ee,U,Y,$e,_e,ve,we,Se,Ie=0,Ne,Ce,Be,Re,Oe,Ue,Le,Me,xe=new utils$e.Buf8(4),He,Fe,Pe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!r||!r.state||!r.output||!r.input&&r.avail_in!==0)return Z_STREAM_ERROR;l=r.state,l.mode===TYPE&&(l.mode=TYPEDO),L=r.next_out,I=r.output,ee=r.avail_out,D=r.next_in,v=r.input,S=r.avail_in,U=l.hold,Y=l.bits,$e=S,_e=ee,Me=Z_OK;e:for(;;)switch(l.mode){case HEAD:if(l.wrap===0){l.mode=TYPEDO;break}for(;Y<16;){if(S===0)break e;S--,U+=v[D++]<<Y,Y+=8}if(l.wrap&2&&U===35615){l.check=0,xe[0]=U&255,xe[1]=U>>>8&255,l.check=crc32$1(l.check,xe,2,0),U=0,Y=0,l.mode=FLAGS;break}if(l.flags=0,l.head&&(l.head.done=!1),!(l.wrap&1)||(((U&255)<<8)+(U>>8))%31){r.msg="incorrect header check",l.mode=BAD;break}if((U&15)!==Z_DEFLATED){r.msg="unknown compression method",l.mode=BAD;break}if(U>>>=4,Y-=4,Le=(U&15)+8,l.wbits===0)l.wbits=Le;else if(Le>l.wbits){r.msg="invalid window size",l.mode=BAD;break}l.dmax=1<<Le,r.adler=l.check=1,l.mode=U&512?DICTID:TYPE,U=0,Y=0;break;case FLAGS:for(;Y<16;){if(S===0)break e;S--,U+=v[D++]<<Y,Y+=8}if(l.flags=U,(l.flags&255)!==Z_DEFLATED){r.msg="unknown compression method",l.mode=BAD;break}if(l.flags&57344){r.msg="unknown header flags set",l.mode=BAD;break}l.head&&(l.head.text=U>>8&1),l.flags&512&&(xe[0]=U&255,xe[1]=U>>>8&255,l.check=crc32$1(l.check,xe,2,0)),U=0,Y=0,l.mode=TIME;case TIME:for(;Y<32;){if(S===0)break e;S--,U+=v[D++]<<Y,Y+=8}l.head&&(l.head.time=U),l.flags&512&&(xe[0]=U&255,xe[1]=U>>>8&255,xe[2]=U>>>16&255,xe[3]=U>>>24&255,l.check=crc32$1(l.check,xe,4,0)),U=0,Y=0,l.mode=OS;case OS:for(;Y<16;){if(S===0)break e;S--,U+=v[D++]<<Y,Y+=8}l.head&&(l.head.xflags=U&255,l.head.os=U>>8),l.flags&512&&(xe[0]=U&255,xe[1]=U>>>8&255,l.check=crc32$1(l.check,xe,2,0)),U=0,Y=0,l.mode=EXLEN;case EXLEN:if(l.flags&1024){for(;Y<16;){if(S===0)break e;S--,U+=v[D++]<<Y,Y+=8}l.length=U,l.head&&(l.head.extra_len=U),l.flags&512&&(xe[0]=U&255,xe[1]=U>>>8&255,l.check=crc32$1(l.check,xe,2,0)),U=0,Y=0}else l.head&&(l.head.extra=null);l.mode=EXTRA;case EXTRA:if(l.flags&1024&&(ve=l.length,ve>S&&(ve=S),ve&&(l.head&&(Le=l.head.extra_len-l.length,l.head.extra||(l.head.extra=new Array(l.head.extra_len)),utils$e.arraySet(l.head.extra,v,D,ve,Le)),l.flags&512&&(l.check=crc32$1(l.check,v,ve,D)),S-=ve,D+=ve,l.length-=ve),l.length))break e;l.length=0,l.mode=NAME;case NAME:if(l.flags&2048){if(S===0)break e;ve=0;do Le=v[D+ve++],l.head&&Le&&l.length<65536&&(l.head.name+=String.fromCharCode(Le));while(Le&&ve<S);if(l.flags&512&&(l.check=crc32$1(l.check,v,ve,D)),S-=ve,D+=ve,Le)break e}else l.head&&(l.head.name=null);l.length=0,l.mode=COMMENT;case COMMENT:if(l.flags&4096){if(S===0)break e;ve=0;do Le=v[D+ve++],l.head&&Le&&l.length<65536&&(l.head.comment+=String.fromCharCode(Le));while(Le&&ve<S);if(l.flags&512&&(l.check=crc32$1(l.check,v,ve,D)),S-=ve,D+=ve,Le)break e}else l.head&&(l.head.comment=null);l.mode=HCRC;case HCRC:if(l.flags&512){for(;Y<16;){if(S===0)break e;S--,U+=v[D++]<<Y,Y+=8}if(U!==(l.check&65535)){r.msg="header crc mismatch",l.mode=BAD;break}U=0,Y=0}l.head&&(l.head.hcrc=l.flags>>9&1,l.head.done=!0),r.adler=l.check=0,l.mode=TYPE;break;case DICTID:for(;Y<32;){if(S===0)break e;S--,U+=v[D++]<<Y,Y+=8}r.adler=l.check=zswap32(U),U=0,Y=0,l.mode=DICT;case DICT:if(l.havedict===0)return r.next_out=L,r.avail_out=ee,r.next_in=D,r.avail_in=S,l.hold=U,l.bits=Y,Z_NEED_DICT;r.adler=l.check=1,l.mode=TYPE;case TYPE:if(g===Z_BLOCK||g===Z_TREES)break e;case TYPEDO:if(l.last){U>>>=Y&7,Y-=Y&7,l.mode=CHECK;break}for(;Y<3;){if(S===0)break e;S--,U+=v[D++]<<Y,Y+=8}switch(l.last=U&1,U>>>=1,Y-=1,U&3){case 0:l.mode=STORED;break;case 1:if(fixedtables(l),l.mode=LEN_,g===Z_TREES){U>>>=2,Y-=2;break e}break;case 2:l.mode=TABLE;break;case 3:r.msg="invalid block type",l.mode=BAD}U>>>=2,Y-=2;break;case STORED:for(U>>>=Y&7,Y-=Y&7;Y<32;){if(S===0)break e;S--,U+=v[D++]<<Y,Y+=8}if((U&65535)!==(U>>>16^65535)){r.msg="invalid stored block lengths",l.mode=BAD;break}if(l.length=U&65535,U=0,Y=0,l.mode=COPY_,g===Z_TREES)break e;case COPY_:l.mode=COPY;case COPY:if(ve=l.length,ve){if(ve>S&&(ve=S),ve>ee&&(ve=ee),ve===0)break e;utils$e.arraySet(I,v,D,ve,L),S-=ve,D+=ve,ee-=ve,L+=ve,l.length-=ve;break}l.mode=TYPE;break;case TABLE:for(;Y<14;){if(S===0)break e;S--,U+=v[D++]<<Y,Y+=8}if(l.nlen=(U&31)+257,U>>>=5,Y-=5,l.ndist=(U&31)+1,U>>>=5,Y-=5,l.ncode=(U&15)+4,U>>>=4,Y-=4,l.nlen>286||l.ndist>30){r.msg="too many length or distance symbols",l.mode=BAD;break}l.have=0,l.mode=LENLENS;case LENLENS:for(;l.have<l.ncode;){for(;Y<3;){if(S===0)break e;S--,U+=v[D++]<<Y,Y+=8}l.lens[Pe[l.have++]]=U&7,U>>>=3,Y-=3}for(;l.have<19;)l.lens[Pe[l.have++]]=0;if(l.lencode=l.lendyn,l.lenbits=7,He={bits:l.lenbits},Me=inflate_table(CODES,l.lens,0,19,l.lencode,0,l.work,He),l.lenbits=He.bits,Me){r.msg="invalid code lengths set",l.mode=BAD;break}l.have=0,l.mode=CODELENS;case CODELENS:for(;l.have<l.nlen+l.ndist;){for(;Ie=l.lencode[U&(1<<l.lenbits)-1],Ne=Ie>>>24,Ce=Ie>>>16&255,Be=Ie&65535,!(Ne<=Y);){if(S===0)break e;S--,U+=v[D++]<<Y,Y+=8}if(Be<16)U>>>=Ne,Y-=Ne,l.lens[l.have++]=Be;else{if(Be===16){for(Fe=Ne+2;Y<Fe;){if(S===0)break e;S--,U+=v[D++]<<Y,Y+=8}if(U>>>=Ne,Y-=Ne,l.have===0){r.msg="invalid bit length repeat",l.mode=BAD;break}Le=l.lens[l.have-1],ve=3+(U&3),U>>>=2,Y-=2}else if(Be===17){for(Fe=Ne+3;Y<Fe;){if(S===0)break e;S--,U+=v[D++]<<Y,Y+=8}U>>>=Ne,Y-=Ne,Le=0,ve=3+(U&7),U>>>=3,Y-=3}else{for(Fe=Ne+7;Y<Fe;){if(S===0)break e;S--,U+=v[D++]<<Y,Y+=8}U>>>=Ne,Y-=Ne,Le=0,ve=11+(U&127),U>>>=7,Y-=7}if(l.have+ve>l.nlen+l.ndist){r.msg="invalid bit length repeat",l.mode=BAD;break}for(;ve--;)l.lens[l.have++]=Le}}if(l.mode===BAD)break;if(l.lens[256]===0){r.msg="invalid code -- missing end-of-block",l.mode=BAD;break}if(l.lenbits=9,He={bits:l.lenbits},Me=inflate_table(LENS,l.lens,0,l.nlen,l.lencode,0,l.work,He),l.lenbits=He.bits,Me){r.msg="invalid literal/lengths set",l.mode=BAD;break}if(l.distbits=6,l.distcode=l.distdyn,He={bits:l.distbits},Me=inflate_table(DISTS,l.lens,l.nlen,l.ndist,l.distcode,0,l.work,He),l.distbits=He.bits,Me){r.msg="invalid distances set",l.mode=BAD;break}if(l.mode=LEN_,g===Z_TREES)break e;case LEN_:l.mode=LEN;case LEN:if(S>=6&&ee>=258){r.next_out=L,r.avail_out=ee,r.next_in=D,r.avail_in=S,l.hold=U,l.bits=Y,inflate_fast(r,_e),L=r.next_out,I=r.output,ee=r.avail_out,D=r.next_in,v=r.input,S=r.avail_in,U=l.hold,Y=l.bits,l.mode===TYPE&&(l.back=-1);break}for(l.back=0;Ie=l.lencode[U&(1<<l.lenbits)-1],Ne=Ie>>>24,Ce=Ie>>>16&255,Be=Ie&65535,!(Ne<=Y);){if(S===0)break e;S--,U+=v[D++]<<Y,Y+=8}if(Ce&&(Ce&240)===0){for(Re=Ne,Oe=Ce,Ue=Be;Ie=l.lencode[Ue+((U&(1<<Re+Oe)-1)>>Re)],Ne=Ie>>>24,Ce=Ie>>>16&255,Be=Ie&65535,!(Re+Ne<=Y);){if(S===0)break e;S--,U+=v[D++]<<Y,Y+=8}U>>>=Re,Y-=Re,l.back+=Re}if(U>>>=Ne,Y-=Ne,l.back+=Ne,l.length=Be,Ce===0){l.mode=LIT;break}if(Ce&32){l.back=-1,l.mode=TYPE;break}if(Ce&64){r.msg="invalid literal/length code",l.mode=BAD;break}l.extra=Ce&15,l.mode=LENEXT;case LENEXT:if(l.extra){for(Fe=l.extra;Y<Fe;){if(S===0)break e;S--,U+=v[D++]<<Y,Y+=8}l.length+=U&(1<<l.extra)-1,U>>>=l.extra,Y-=l.extra,l.back+=l.extra}l.was=l.length,l.mode=DIST;case DIST:for(;Ie=l.distcode[U&(1<<l.distbits)-1],Ne=Ie>>>24,Ce=Ie>>>16&255,Be=Ie&65535,!(Ne<=Y);){if(S===0)break e;S--,U+=v[D++]<<Y,Y+=8}if((Ce&240)===0){for(Re=Ne,Oe=Ce,Ue=Be;Ie=l.distcode[Ue+((U&(1<<Re+Oe)-1)>>Re)],Ne=Ie>>>24,Ce=Ie>>>16&255,Be=Ie&65535,!(Re+Ne<=Y);){if(S===0)break e;S--,U+=v[D++]<<Y,Y+=8}U>>>=Re,Y-=Re,l.back+=Re}if(U>>>=Ne,Y-=Ne,l.back+=Ne,Ce&64){r.msg="invalid distance code",l.mode=BAD;break}l.offset=Be,l.extra=Ce&15,l.mode=DISTEXT;case DISTEXT:if(l.extra){for(Fe=l.extra;Y<Fe;){if(S===0)break e;S--,U+=v[D++]<<Y,Y+=8}l.offset+=U&(1<<l.extra)-1,U>>>=l.extra,Y-=l.extra,l.back+=l.extra}if(l.offset>l.dmax){r.msg="invalid distance too far back",l.mode=BAD;break}l.mode=MATCH;case MATCH:if(ee===0)break e;if(ve=_e-ee,l.offset>ve){if(ve=l.offset-ve,ve>l.whave&&l.sane){r.msg="invalid distance too far back",l.mode=BAD;break}ve>l.wnext?(ve-=l.wnext,we=l.wsize-ve):we=l.wnext-ve,ve>l.length&&(ve=l.length),Se=l.window}else Se=I,we=L-l.offset,ve=l.length;ve>ee&&(ve=ee),ee-=ve,l.length-=ve;do I[L++]=Se[we++];while(--ve);l.length===0&&(l.mode=LEN);break;case LIT:if(ee===0)break e;I[L++]=l.length,ee--,l.mode=LEN;break;case CHECK:if(l.wrap){for(;Y<32;){if(S===0)break e;S--,U|=v[D++]<<Y,Y+=8}if(_e-=ee,r.total_out+=_e,l.total+=_e,_e&&(r.adler=l.check=l.flags?crc32$1(l.check,I,_e,L-_e):adler32(l.check,I,_e,L-_e)),_e=ee,(l.flags?U:zswap32(U))!==l.check){r.msg="incorrect data check",l.mode=BAD;break}U=0,Y=0}l.mode=LENGTH;case LENGTH:if(l.wrap&&l.flags){for(;Y<32;){if(S===0)break e;S--,U+=v[D++]<<Y,Y+=8}if(U!==(l.total&4294967295)){r.msg="incorrect length check",l.mode=BAD;break}U=0,Y=0}l.mode=DONE;case DONE:Me=Z_STREAM_END;break e;case BAD:Me=Z_DATA_ERROR;break e;case MEM:return Z_MEM_ERROR;case SYNC:default:return Z_STREAM_ERROR}return r.next_out=L,r.avail_out=ee,r.next_in=D,r.avail_in=S,l.hold=U,l.bits=Y,(l.wsize||_e!==r.avail_out&&l.mode<BAD&&(l.mode<CHECK||g!==Z_FINISH))&&updatewindow(r,r.output,r.next_out,_e-r.avail_out),$e-=r.avail_in,_e-=r.avail_out,r.total_in+=$e,r.total_out+=_e,l.total+=_e,l.wrap&&_e&&(r.adler=l.check=l.flags?crc32$1(l.check,I,_e,r.next_out-_e):adler32(l.check,I,_e,r.next_out-_e)),r.data_type=l.bits+(l.last?64:0)+(l.mode===TYPE?128:0)+(l.mode===LEN_||l.mode===COPY_?256:0),($e===0&&_e===0||g===Z_FINISH)&&Me===Z_OK&&(Me=Z_BUF_ERROR),Me}function inflateEnd(r){if(!r||!r.state)return Z_STREAM_ERROR;var g=r.state;return g.window&&(g.window=null),r.state=null,Z_OK}function inflateGetHeader(r,g){var l;return!r||!r.state||(l=r.state,(l.wrap&2)===0)?Z_STREAM_ERROR:(l.head=g,g.done=!1,Z_OK)}function inflateSetDictionary(r,g){var l=g.length,v,I,D;return!r||!r.state||(v=r.state,v.wrap!==0&&v.mode!==DICT)?Z_STREAM_ERROR:v.mode===DICT&&(I=1,I=adler32(I,g,l,0),I!==v.check)?Z_DATA_ERROR:(D=updatewindow(r,g,l,l),D?(v.mode=MEM,Z_MEM_ERROR):(v.havedict=1,Z_OK))}inflate$3.inflateReset=inflateReset,inflate$3.inflateReset2=inflateReset2,inflate$3.inflateResetKeep=inflateResetKeep,inflate$3.inflateInit=inflateInit,inflate$3.inflateInit2=inflateInit2,inflate$3.inflate=inflate$2,inflate$3.inflateEnd=inflateEnd,inflate$3.inflateGetHeader=inflateGetHeader,inflate$3.inflateSetDictionary=inflateSetDictionary,inflate$3.inflateInfo="pako inflate (from Nodeca project)";var constants$1={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};function GZheader$1(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader=GZheader$1,zlib_inflate=inflate$3,utils$d=common,strings=strings$2,c$3=constants$1,msg=messages,ZStream=zstream,GZheader=gzheader,toString=Object.prototype.toString;function Inflate(r){if(!(this instanceof Inflate))return new Inflate(r);this.options=utils$d.assign({chunkSize:16384,windowBits:0,to:""},r||{});var g=this.options;g.raw&&g.windowBits>=0&&g.windowBits<16&&(g.windowBits=-g.windowBits,g.windowBits===0&&(g.windowBits=-15)),g.windowBits>=0&&g.windowBits<16&&!(r&&r.windowBits)&&(g.windowBits+=32),g.windowBits>15&&g.windowBits<48&&(g.windowBits&15)===0&&(g.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream,this.strm.avail_out=0;var l=zlib_inflate.inflateInit2(this.strm,g.windowBits);if(l!==c$3.Z_OK)throw new Error(msg[l]);if(this.header=new GZheader,zlib_inflate.inflateGetHeader(this.strm,this.header),g.dictionary&&(typeof g.dictionary=="string"?g.dictionary=strings.string2buf(g.dictionary):toString.call(g.dictionary)==="[object ArrayBuffer]"&&(g.dictionary=new Uint8Array(g.dictionary)),g.raw&&(l=zlib_inflate.inflateSetDictionary(this.strm,g.dictionary),l!==c$3.Z_OK)))throw new Error(msg[l])}Inflate.prototype.push=function(r,g){var l=this.strm,v=this.options.chunkSize,I=this.options.dictionary,D,L,S,ee,U,Y=!1;if(this.ended)return!1;L=g===~~g?g:g===!0?c$3.Z_FINISH:c$3.Z_NO_FLUSH,typeof r=="string"?l.input=strings.binstring2buf(r):toString.call(r)==="[object ArrayBuffer]"?l.input=new Uint8Array(r):l.input=r,l.next_in=0,l.avail_in=l.input.length;do{if(l.avail_out===0&&(l.output=new utils$d.Buf8(v),l.next_out=0,l.avail_out=v),D=zlib_inflate.inflate(l,c$3.Z_NO_FLUSH),D===c$3.Z_NEED_DICT&&I&&(D=zlib_inflate.inflateSetDictionary(this.strm,I)),D===c$3.Z_BUF_ERROR&&Y===!0&&(D=c$3.Z_OK,Y=!1),D!==c$3.Z_STREAM_END&&D!==c$3.Z_OK)return this.onEnd(D),this.ended=!0,!1;l.next_out&&(l.avail_out===0||D===c$3.Z_STREAM_END||l.avail_in===0&&(L===c$3.Z_FINISH||L===c$3.Z_SYNC_FLUSH))&&(this.options.to==="string"?(S=strings.utf8border(l.output,l.next_out),ee=l.next_out-S,U=strings.buf2string(l.output,S),l.next_out=ee,l.avail_out=v-ee,ee&&utils$d.arraySet(l.output,l.output,S,ee,0),this.onData(U)):this.onData(utils$d.shrinkBuf(l.output,l.next_out))),l.avail_in===0&&l.avail_out===0&&(Y=!0)}while((l.avail_in>0||l.avail_out===0)&&D!==c$3.Z_STREAM_END);return D===c$3.Z_STREAM_END&&(L=c$3.Z_FINISH),L===c$3.Z_FINISH?(D=zlib_inflate.inflateEnd(this.strm),this.onEnd(D),this.ended=!0,D===c$3.Z_OK):(L===c$3.Z_SYNC_FLUSH&&(this.onEnd(c$3.Z_OK),l.avail_out=0),!0)},Inflate.prototype.onData=function(r){this.chunks.push(r)},Inflate.prototype.onEnd=function(r){r===c$3.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=utils$d.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function inflate$1(r,g){var l=new Inflate(g);if(l.push(r,!0),l.err)throw l.msg||msg[l.err];return l.result}function inflateRaw(r,g){return g=g||{},g.raw=!0,inflate$1(r,g)}inflate$4.Inflate=Inflate,inflate$4.inflate=inflate$1,inflate$4.inflateRaw=inflateRaw,inflate$4.ungzip=inflate$1;var assign=common.assign,deflate=deflate$4,inflate=inflate$4,constants=constants$1,pako$1={};assign(pako$1,deflate,inflate,constants);var pako_1=pako$1,USE_TYPEDARRAY=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",pako=pako_1,utils$c=utils$r,GenericWorker$4=GenericWorker_1,ARRAY_TYPE=USE_TYPEDARRAY?"uint8array":"array";flate.magic="\b\0";function FlateWorker(r,g){GenericWorker$4.call(this,"FlateWorker/"+r),this._pako=null,this._pakoAction=r,this._pakoOptions=g,this.meta={}}utils$c.inherits(FlateWorker,GenericWorker$4),FlateWorker.prototype.processChunk=function(r){this.meta=r.meta,this._pako===null&&this._createPako(),this._pako.push(utils$c.transformTo(ARRAY_TYPE,r.data),!1)},FlateWorker.prototype.flush=function(){GenericWorker$4.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},FlateWorker.prototype.cleanUp=function(){GenericWorker$4.prototype.cleanUp.call(this),this._pako=null},FlateWorker.prototype._createPako=function(){this._pako=new pako[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var r=this;this._pako.onData=function(g){r.push({data:g,meta:r.meta})}},flate.compressWorker=function(r){return new FlateWorker("Deflate",r)},flate.uncompressWorker=function(){return new FlateWorker("Inflate",{})};var GenericWorker$3=GenericWorker_1;compressions$2.STORE={magic:"\0\0",compressWorker:function(){return new GenericWorker$3("STORE compression")},uncompressWorker:function(){return new GenericWorker$3("STORE decompression")}},compressions$2.DEFLATE=flate;var signature$1={};signature$1.LOCAL_FILE_HEADER="PK",signature$1.CENTRAL_FILE_HEADER="PK",signature$1.CENTRAL_DIRECTORY_END="PK",signature$1.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",signature$1.ZIP64_CENTRAL_DIRECTORY_END="PK",signature$1.DATA_DESCRIPTOR="PK\x07\b";var utils$b=utils$r,GenericWorker$2=GenericWorker_1,utf8$3=utf8$5,crc32=crc32_1$1,signature=signature$1,decToHex=function(r,g){var l="",v;for(v=0;v<g;v++)l+=String.fromCharCode(r&255),r=r>>>8;return l},generateUnixExternalFileAttr=function(r,g){var l=r;return r||(l=g?16893:33204),(l&65535)<<16},generateDosExternalFileAttr=function(r){return(r||0)&63},generateZipParts=function(r,g,l,v,I,D){var L=r.file,S=r.compression,ee=D!==utf8$3.utf8encode,U=utils$b.transformTo("string",D(L.name)),Y=utils$b.transformTo("string",utf8$3.utf8encode(L.name)),$e=L.comment,_e=utils$b.transformTo("string",D($e)),ve=utils$b.transformTo("string",utf8$3.utf8encode($e)),we=Y.length!==L.name.length,Se=ve.length!==$e.length,Ie,Ne,Ce="",Be="",Re="",Oe=L.dir,Ue=L.date,Le={crc32:0,compressedSize:0,uncompressedSize:0};(!g||l)&&(Le.crc32=r.crc32,Le.compressedSize=r.compressedSize,Le.uncompressedSize=r.uncompressedSize);var Me=0;g&&(Me|=8),!ee&&(we||Se)&&(Me|=2048);var xe=0,He=0;Oe&&(xe|=16),I==="UNIX"?(He=798,xe|=generateUnixExternalFileAttr(L.unixPermissions,Oe)):(He=20,xe|=generateDosExternalFileAttr(L.dosPermissions)),Ie=Ue.getUTCHours(),Ie=Ie<<6,Ie=Ie|Ue.getUTCMinutes(),Ie=Ie<<5,Ie=Ie|Ue.getUTCSeconds()/2,Ne=Ue.getUTCFullYear()-1980,Ne=Ne<<4,Ne=Ne|Ue.getUTCMonth()+1,Ne=Ne<<5,Ne=Ne|Ue.getUTCDate(),we&&(Be=decToHex(1,1)+decToHex(crc32(U),4)+Y,Ce+="up"+decToHex(Be.length,2)+Be),Se&&(Re=decToHex(1,1)+decToHex(crc32(_e),4)+ve,Ce+="uc"+decToHex(Re.length,2)+Re);var Fe="";Fe+=`
\0`,Fe+=decToHex(Me,2),Fe+=S.magic,Fe+=decToHex(Ie,2),Fe+=decToHex(Ne,2),Fe+=decToHex(Le.crc32,4),Fe+=decToHex(Le.compressedSize,4),Fe+=decToHex(Le.uncompressedSize,4),Fe+=decToHex(U.length,2),Fe+=decToHex(Ce.length,2);var Pe=signature.LOCAL_FILE_HEADER+Fe+U+Ce,rt=signature.CENTRAL_FILE_HEADER+decToHex(He,2)+Fe+decToHex(_e.length,2)+"\0\0\0\0"+decToHex(xe,4)+decToHex(v,4)+U+Ce+_e;return{fileRecord:Pe,dirRecord:rt}},generateCentralDirectoryEnd=function(r,g,l,v,I){var D="",L=utils$b.transformTo("string",I(v));return D=signature.CENTRAL_DIRECTORY_END+"\0\0\0\0"+decToHex(r,2)+decToHex(r,2)+decToHex(g,4)+decToHex(l,4)+decToHex(L.length,2)+L,D},generateDataDescriptors=function(r){var g="";return g=signature.DATA_DESCRIPTOR+decToHex(r.crc32,4)+decToHex(r.compressedSize,4)+decToHex(r.uncompressedSize,4),g};function ZipFileWorker$1(r,g,l,v){GenericWorker$2.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=g,this.zipPlatform=l,this.encodeFileName=v,this.streamFiles=r,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}utils$b.inherits(ZipFileWorker$1,GenericWorker$2),ZipFileWorker$1.prototype.push=function(r){var g=r.meta.percent||0,l=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(r):(this.bytesWritten+=r.data.length,GenericWorker$2.prototype.push.call(this,{data:r.data,meta:{currentFile:this.currentFile,percent:l?(g+100*(l-v-1))/l:100}}))},ZipFileWorker$1.prototype.openedSource=function(r){this.currentSourceOffset=this.bytesWritten,this.currentFile=r.file.name;var g=this.streamFiles&&!r.file.dir;if(g){var l=generateZipParts(r,g,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:l.fileRecord,meta:{percent:0}})}else this.accumulate=!0},ZipFileWorker$1.prototype.closedSource=function(r){this.accumulate=!1;var g=this.streamFiles&&!r.file.dir,l=generateZipParts(r,g,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(l.dirRecord),g)this.push({data:generateDataDescriptors(r),meta:{percent:100}});else for(this.push({data:l.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},ZipFileWorker$1.prototype.flush=function(){for(var r=this.bytesWritten,g=0;g<this.dirRecords.length;g++)this.push({data:this.dirRecords[g],meta:{percent:100}});var l=this.bytesWritten-r,v=generateCentralDirectoryEnd(this.dirRecords.length,l,r,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},ZipFileWorker$1.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},ZipFileWorker$1.prototype.registerPrevious=function(r){this._sources.push(r);var g=this;return r.on("data",function(l){g.processChunk(l)}),r.on("end",function(){g.closedSource(g.previous.streamInfo),g._sources.length?g.prepareNextSource():g.end()}),r.on("error",function(l){g.error(l)}),this},ZipFileWorker$1.prototype.resume=function(){if(!GenericWorker$2.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},ZipFileWorker$1.prototype.error=function(r){var g=this._sources;if(!GenericWorker$2.prototype.error.call(this,r))return!1;for(var l=0;l<g.length;l++)try{g[l].error(r)}catch(v){}return!0},ZipFileWorker$1.prototype.lock=function(){GenericWorker$2.prototype.lock.call(this);for(var r=this._sources,g=0;g<r.length;g++)r[g].lock()};var ZipFileWorker_1=ZipFileWorker$1,compressions$1=compressions$2,ZipFileWorker=ZipFileWorker_1,getCompression=function(r,g){var l=r||g,v=compressions$1[l];if(!v)throw new Error(l+" is not a valid compression method !");return v};generate$1.generateWorker=function(r,g,l){var v=new ZipFileWorker(g.streamFiles,l,g.platform,g.encodeFileName),I=0;try{r.forEach(function(D,L){I++;var S=getCompression(L.options.compression,g.compression),ee=L.options.compressionOptions||g.compressionOptions||{},U=L.dir,Y=L.date;L._compressWorker(S,ee).withStreamInfo("file",{name:D,dir:U,date:Y,comment:L.comment||"",unixPermissions:L.unixPermissions,dosPermissions:L.dosPermissions}).pipe(v)}),v.entriesCount=I}catch(D){v.error(D)}return v};var utils$a=utils$r,GenericWorker$1=GenericWorker_1;function NodejsStreamInputAdapter$1(r,g){GenericWorker$1.call(this,"Nodejs stream input adapter for "+r),this._upstreamEnded=!1,this._bindStream(g)}utils$a.inherits(NodejsStreamInputAdapter$1,GenericWorker$1),NodejsStreamInputAdapter$1.prototype._bindStream=function(r){var g=this;this._stream=r,r.pause(),r.on("data",function(l){g.push({data:l,meta:{percent:0}})}).on("error",function(l){g.isPaused?this.generatedError=l:g.error(l)}).on("end",function(){g.isPaused?g._upstreamEnded=!0:g.end()})},NodejsStreamInputAdapter$1.prototype.pause=function(){return GenericWorker$1.prototype.pause.call(this)?(this._stream.pause(),!0):!1},NodejsStreamInputAdapter$1.prototype.resume=function(){return GenericWorker$1.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1};var NodejsStreamInputAdapter_1=NodejsStreamInputAdapter$1,utf8$2=utf8$5,utils$9=utils$r,GenericWorker=GenericWorker_1,StreamHelper=StreamHelper_1,defaults=defaults$1,CompressedObject$1=compressedObject,ZipObject=zipObject,generate=generate$1,nodejsUtils$1=nodejsUtils$2,NodejsStreamInputAdapter=NodejsStreamInputAdapter_1,fileAdd=function(r,g,l){var v=utils$9.getTypeOf(g),I,D=utils$9.extend(l||{},defaults);D.date=D.date||new Date,D.compression!==null&&(D.compression=D.compression.toUpperCase()),typeof D.unixPermissions=="string"&&(D.unixPermissions=parseInt(D.unixPermissions,8)),D.unixPermissions&&D.unixPermissions&16384&&(D.dir=!0),D.dosPermissions&&D.dosPermissions&16&&(D.dir=!0),D.dir&&(r=forceTrailingSlash(r)),D.createFolders&&(I=parentFolder(r))&&folderAdd.call(this,I,!0);var L=v==="string"&&D.binary===!1&&D.base64===!1;(!l||typeof l.binary=="undefined")&&(D.binary=!L);var S=g instanceof CompressedObject$1&&g.uncompressedSize===0;(S||D.dir||!g||g.length===0)&&(D.base64=!1,D.binary=!0,g="",D.compression="STORE",v="string");var ee=null;g instanceof CompressedObject$1||g instanceof GenericWorker?ee=g:nodejsUtils$1.isNode&&nodejsUtils$1.isStream(g)?ee=new NodejsStreamInputAdapter(r,g):ee=utils$9.prepareContent(r,g,D.binary,D.optimizedBinaryString,D.base64);var U=new ZipObject(r,ee,D);this.files[r]=U},parentFolder=function(r){r.slice(-1)==="/"&&(r=r.substring(0,r.length-1));var g=r.lastIndexOf("/");return g>0?r.substring(0,g):""},forceTrailingSlash=function(r){return r.slice(-1)!=="/"&&(r+="/"),r},folderAdd=function(r,g){return g=typeof g!="undefined"?g:defaults.createFolders,r=forceTrailingSlash(r),this.files[r]||fileAdd.call(this,r,null,{dir:!0,createFolders:g}),this.files[r]};function isRegExp(r){return Object.prototype.toString.call(r)==="[object RegExp]"}var out={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(r){var g,l,v;for(g in this.files)v=this.files[g],l=g.slice(this.root.length,g.length),l&&g.slice(0,this.root.length)===this.root&&r(l,v)},filter:function(r){var g=[];return this.forEach(function(l,v){r(l,v)&&g.push(v)}),g},file:function(r,g,l){if(arguments.length===1)if(isRegExp(r)){var v=r;return this.filter(function(D,L){return!L.dir&&v.test(D)})}else{var I=this.files[this.root+r];return I&&!I.dir?I:null}else r=this.root+r,fileAdd.call(this,r,g,l);return this},folder:function(r){if(!r)return this;if(isRegExp(r))return this.filter(function(I,D){return D.dir&&r.test(I)});var g=this.root+r,l=folderAdd.call(this,g),v=this.clone();return v.root=l.name,v},remove:function(r){r=this.root+r;var g=this.files[r];if(g||(r.slice(-1)!=="/"&&(r+="/"),g=this.files[r]),g&&!g.dir)delete this.files[r];else for(var l=this.filter(function(I,D){return D.name.slice(0,r.length)===r}),v=0;v<l.length;v++)delete this.files[l[v].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(r){var g,l={};try{if(l=utils$9.extend(r||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:utf8$2.utf8encode}),l.type=l.type.toLowerCase(),l.compression=l.compression.toUpperCase(),l.type==="binarystring"&&(l.type="string"),!l.type)throw new Error("No output type specified.");utils$9.checkSupport(l.type),(l.platform==="darwin"||l.platform==="freebsd"||l.platform==="linux"||l.platform==="sunos")&&(l.platform="UNIX"),l.platform==="win32"&&(l.platform="DOS");var v=l.comment||this.comment||"";g=generate.generateWorker(this,l,v)}catch(I){g=new GenericWorker("error"),g.error(I)}return new StreamHelper(g,l.type||"string",l.mimeType)},generateAsync:function(r,g){return this.generateInternalStream(r).accumulate(g)},generateNodeStream:function(r,g){return r=r||{},r.type||(r.type="nodebuffer"),this.generateInternalStream(r).toNodejsStream(g)}},object=out,utils$8=utils$r;function DataReader$2(r){this.data=r,this.length=r.length,this.index=0,this.zero=0}DataReader$2.prototype={checkOffset:function(r){this.checkIndex(this.index+r)},checkIndex:function(r){if(this.length<this.zero+r||r<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+r+"). Corrupted zip ?")},setIndex:function(r){this.checkIndex(r),this.index=r},skip:function(r){this.setIndex(this.index+r)},byteAt:function(){},readInt:function(r){var g=0,l;for(this.checkOffset(r),l=this.index+r-1;l>=this.index;l--)g=(g<<8)+this.byteAt(l);return this.index+=r,g},readString:function(r){return utils$8.transformTo("string",this.readData(r))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var r=this.readInt(4);return new Date(Date.UTC((r>>25&127)+1980,(r>>21&15)-1,r>>16&31,r>>11&31,r>>5&63,(r&31)<<1))}};var DataReader_1=DataReader$2,DataReader$1=DataReader_1,utils$7=utils$r;function ArrayReader$2(r){DataReader$1.call(this,r);for(var g=0;g<this.data.length;g++)r[g]=r[g]&255}utils$7.inherits(ArrayReader$2,DataReader$1),ArrayReader$2.prototype.byteAt=function(r){return this.data[this.zero+r]},ArrayReader$2.prototype.lastIndexOfSignature=function(r){for(var g=r.charCodeAt(0),l=r.charCodeAt(1),v=r.charCodeAt(2),I=r.charCodeAt(3),D=this.length-4;D>=0;--D)if(this.data[D]===g&&this.data[D+1]===l&&this.data[D+2]===v&&this.data[D+3]===I)return D-this.zero;return-1},ArrayReader$2.prototype.readAndCheckSignature=function(r){var g=r.charCodeAt(0),l=r.charCodeAt(1),v=r.charCodeAt(2),I=r.charCodeAt(3),D=this.readData(4);return g===D[0]&&l===D[1]&&v===D[2]&&I===D[3]},ArrayReader$2.prototype.readData=function(r){if(this.checkOffset(r),r===0)return[];var g=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,g};var ArrayReader_1=ArrayReader$2,DataReader=DataReader_1,utils$6=utils$r;function StringReader$1(r){DataReader.call(this,r)}utils$6.inherits(StringReader$1,DataReader),StringReader$1.prototype.byteAt=function(r){return this.data.charCodeAt(this.zero+r)},StringReader$1.prototype.lastIndexOfSignature=function(r){return this.data.lastIndexOf(r)-this.zero},StringReader$1.prototype.readAndCheckSignature=function(r){var g=this.readData(4);return r===g},StringReader$1.prototype.readData=function(r){this.checkOffset(r);var g=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,g};var StringReader_1=StringReader$1,ArrayReader$1=ArrayReader_1,utils$5=utils$r;function Uint8ArrayReader$2(r){ArrayReader$1.call(this,r)}utils$5.inherits(Uint8ArrayReader$2,ArrayReader$1),Uint8ArrayReader$2.prototype.readData=function(r){if(this.checkOffset(r),r===0)return new Uint8Array(0);var g=this.data.subarray(this.zero+this.index,this.zero+this.index+r);return this.index+=r,g};var Uint8ArrayReader_1=Uint8ArrayReader$2,Uint8ArrayReader$1=Uint8ArrayReader_1,utils$4=utils$r;function NodeBufferReader$1(r){Uint8ArrayReader$1.call(this,r)}utils$4.inherits(NodeBufferReader$1,Uint8ArrayReader$1),NodeBufferReader$1.prototype.readData=function(r){this.checkOffset(r);var g=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,g};var NodeBufferReader_1=NodeBufferReader$1,utils$3=utils$r,support$2=support$5,ArrayReader=ArrayReader_1,StringReader=StringReader_1,NodeBufferReader=NodeBufferReader_1,Uint8ArrayReader=Uint8ArrayReader_1,readerFor$2=function(r){var g=utils$3.getTypeOf(r);return utils$3.checkSupport(g),g==="string"&&!support$2.uint8array?new StringReader(r):g==="nodebuffer"?new NodeBufferReader(r):support$2.uint8array?new Uint8ArrayReader(utils$3.transformTo("uint8array",r)):new ArrayReader(utils$3.transformTo("array",r))},readerFor$1=readerFor$2,utils$2=utils$r,CompressedObject=compressedObject,crc32fn=crc32_1$1,utf8$1=utf8$5,compressions=compressions$2,support$1=support$5,MADE_BY_DOS=0,MADE_BY_UNIX=3,findCompression=function(r){for(var g in compressions)if(Object.prototype.hasOwnProperty.call(compressions,g)&&compressions[g].magic===r)return compressions[g];return null};function ZipEntry$1(r,g){this.options=r,this.loadOptions=g}ZipEntry$1.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(r){var g,l;if(r.skip(22),this.fileNameLength=r.readInt(2),l=r.readInt(2),this.fileName=r.readData(this.fileNameLength),r.skip(l),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(g=findCompression(this.compressionMethod),g===null)throw new Error("Corrupted zip : compression "+utils$2.pretty(this.compressionMethod)+" unknown (inner file : "+utils$2.transformTo("string",this.fileName)+")");this.decompressed=new CompressedObject(this.compressedSize,this.uncompressedSize,this.crc32,g,r.readData(this.compressedSize))},readCentralPart:function(r){this.versionMadeBy=r.readInt(2),r.skip(2),this.bitFlag=r.readInt(2),this.compressionMethod=r.readString(2),this.date=r.readDate(),this.crc32=r.readInt(4),this.compressedSize=r.readInt(4),this.uncompressedSize=r.readInt(4);var g=r.readInt(2);if(this.extraFieldsLength=r.readInt(2),this.fileCommentLength=r.readInt(2),this.diskNumberStart=r.readInt(2),this.internalFileAttributes=r.readInt(2),this.externalFileAttributes=r.readInt(4),this.localHeaderOffset=r.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");r.skip(g),this.readExtraFields(r),this.parseZIP64ExtraField(r),this.fileComment=r.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var r=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),r===MADE_BY_DOS&&(this.dosPermissions=this.externalFileAttributes&63),r===MADE_BY_UNIX&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var r=readerFor$1(this.extraFields[1].value);this.uncompressedSize===utils$2.MAX_VALUE_32BITS&&(this.uncompressedSize=r.readInt(8)),this.compressedSize===utils$2.MAX_VALUE_32BITS&&(this.compressedSize=r.readInt(8)),this.localHeaderOffset===utils$2.MAX_VALUE_32BITS&&(this.localHeaderOffset=r.readInt(8)),this.diskNumberStart===utils$2.MAX_VALUE_32BITS&&(this.diskNumberStart=r.readInt(4))}},readExtraFields:function(r){var g=r.index+this.extraFieldsLength,l,v,I;for(this.extraFields||(this.extraFields={});r.index+4<g;)l=r.readInt(2),v=r.readInt(2),I=r.readData(v),this.extraFields[l]={id:l,length:v,value:I};r.setIndex(g)},handleUTF8:function(){var r=support$1.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=utf8$1.utf8decode(this.fileName),this.fileCommentStr=utf8$1.utf8decode(this.fileComment);else{var g=this.findExtraFieldUnicodePath();if(g!==null)this.fileNameStr=g;else{var l=utils$2.transformTo(r,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(l)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var I=utils$2.transformTo(r,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(I)}}},findExtraFieldUnicodePath:function(){var r=this.extraFields[28789];if(r){var g=readerFor$1(r.value);return g.readInt(1)!==1||crc32fn(this.fileName)!==g.readInt(4)?null:utf8$1.utf8decode(g.readData(r.length-5))}return null},findExtraFieldUnicodeComment:function(){var r=this.extraFields[25461];if(r){var g=readerFor$1(r.value);return g.readInt(1)!==1||crc32fn(this.fileComment)!==g.readInt(4)?null:utf8$1.utf8decode(g.readData(r.length-5))}return null}};var zipEntry=ZipEntry$1,readerFor=readerFor$2,utils$1=utils$r,sig=signature$1,ZipEntry=zipEntry,support=support$5;function ZipEntries$1(r){this.files=[],this.loadOptions=r}ZipEntries$1.prototype={checkSignature:function(r){if(!this.reader.readAndCheckSignature(r)){this.reader.index-=4;var g=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+utils$1.pretty(g)+", expected "+utils$1.pretty(r)+")")}},isSignature:function(r,g){var l=this.reader.index;this.reader.setIndex(r);var v=this.reader.readString(4),I=v===g;return this.reader.setIndex(l),I},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var r=this.reader.readData(this.zipCommentLength),g=support.uint8array?"uint8array":"array",l=utils$1.transformTo(g,r);this.zipComment=this.loadOptions.decodeFileName(l)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var r=this.zip64EndOfCentralSize-44,g=0,l,v,I;g<r;)l=this.reader.readInt(2),v=this.reader.readInt(4),I=this.reader.readData(v),this.zip64ExtensibleData[l]={id:l,length:v,value:I}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var r,g;for(r=0;r<this.files.length;r++)g=this.files[r],this.reader.setIndex(g.localHeaderOffset),this.checkSignature(sig.LOCAL_FILE_HEADER),g.readLocalPart(this.reader),g.handleUTF8(),g.processAttributes()},readCentralDir:function(){var r;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(sig.CENTRAL_FILE_HEADER);)r=new ZipEntry({zip64:this.zip64},this.loadOptions),r.readCentralPart(this.reader),this.files.push(r);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var r=this.reader.lastIndexOfSignature(sig.CENTRAL_DIRECTORY_END);if(r<0){var g=!this.isSignature(0,sig.LOCAL_FILE_HEADER);throw g?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(r);var l=r;if(this.checkSignature(sig.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===utils$1.MAX_VALUE_16BITS||this.diskWithCentralDirStart===utils$1.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===utils$1.MAX_VALUE_16BITS||this.centralDirRecords===utils$1.MAX_VALUE_16BITS||this.centralDirSize===utils$1.MAX_VALUE_32BITS||this.centralDirOffset===utils$1.MAX_VALUE_32BITS){if(this.zip64=!0,r=this.reader.lastIndexOfSignature(sig.ZIP64_CENTRAL_DIRECTORY_LOCATOR),r<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(r),this.checkSignature(sig.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,sig.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(sig.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(sig.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var v=this.centralDirOffset+this.centralDirSize;this.zip64&&(v+=20,v+=12+this.zip64EndOfCentralSize);var I=l-v;if(I>0)this.isSignature(l,sig.CENTRAL_FILE_HEADER)||(this.reader.zero=I);else if(I<0)throw new Error("Corrupted zip: missing "+Math.abs(I)+" bytes.")},prepareReader:function(r){this.reader=readerFor(r)},load:function(r){this.prepareReader(r),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};var zipEntries=ZipEntries$1,utils=utils$r,external=external$3,utf8=utf8$5,ZipEntries=zipEntries,Crc32Probe=Crc32Probe_1,nodejsUtils=nodejsUtils$2;function checkEntryCRC32(r){return new external.Promise(function(g,l){var v=r.decompressed.getContentWorker().pipe(new Crc32Probe);v.on("error",function(I){l(I)}).on("end",function(){v.streamInfo.crc32!==r.decompressed.crc32?l(new Error("Corrupted zip : CRC32 mismatch")):g()}).resume()})}var load=function(r,g){var l=this;return g=utils.extend(g||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:utf8.utf8decode}),nodejsUtils.isNode&&nodejsUtils.isStream(r)?external.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):utils.prepareContent("the loaded zip file",r,!0,g.optimizedBinaryString,g.base64).then(function(v){var I=new ZipEntries(g);return I.load(v),I}).then(function(I){var D=[external.Promise.resolve(I)],L=I.files;if(g.checkCRC32)for(var S=0;S<L.length;S++)D.push(checkEntryCRC32(L[S]));return external.Promise.all(D)}).then(function(I){for(var D=I.shift(),L=D.files,S=0;S<L.length;S++){var ee=L[S],U=ee.fileNameStr,Y=utils.resolve(ee.fileNameStr);l.file(Y,ee.decompressed,{binary:!0,optimizedBinaryString:!0,date:ee.date,dir:ee.dir,comment:ee.fileCommentStr.length?ee.fileCommentStr:null,unixPermissions:ee.unixPermissions,dosPermissions:ee.dosPermissions,createFolders:g.createFolders}),ee.dir||(l.file(Y).unsafeOriginalName=U)}return D.zipComment.length&&(l.comment=D.zipComment),l})};function JSZip(){if(!(this instanceof JSZip))return new JSZip;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var r=new JSZip;for(var g in this)typeof this[g]!="function"&&(r[g]=this[g]);return r}}JSZip.prototype=object,JSZip.prototype.loadAsync=load,JSZip.support=support$5,JSZip.defaults=defaults$1,JSZip.version="3.10.1",JSZip.loadAsync=function(r,g){return new JSZip().loadAsync(r,g)},JSZip.external=external$3;var lib=JSZip;const t=r=>lib.loadAsync(r),s$1=(r,g)=>{const l=r.file(g);return l?l.async("text"):null},o=(r,g,l)=>r.file(g,l,{binary:!1}),p$2=(r,g)=>r.generateAsync({type:"uint8array",compression:"DEFLATE",compressionOptions:{level:g}});var sax={},string_decoder={},safeBuffer={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(r,g){var l=buffer$1,v=l.Buffer;function I(L,S){for(var ee in L)S[ee]=L[ee]}v.from&&v.alloc&&v.allocUnsafe&&v.allocUnsafeSlow?r.exports=l:(I(l,g),g.Buffer=D);function D(L,S,ee){return v(L,S,ee)}D.prototype=Object.create(v.prototype),I(v,D),D.from=function(L,S,ee){if(typeof L=="number")throw new TypeError("Argument must not be a number");return v(L,S,ee)},D.alloc=function(L,S,ee){if(typeof L!="number")throw new TypeError("Argument must be a number");var U=v(L);return S!==void 0?typeof ee=="string"?U.fill(S,ee):U.fill(S):U.fill(0),U},D.allocUnsafe=function(L){if(typeof L!="number")throw new TypeError("Argument must be a number");return v(L)},D.allocUnsafeSlow=function(L){if(typeof L!="number")throw new TypeError("Argument must be a number");return l.SlowBuffer(L)}})(safeBuffer,safeBuffer.exports);var Buffer$1=safeBuffer.exports.Buffer,isEncoding=Buffer$1.isEncoding||function(r){switch(r=""+r,r&&r.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function _normalizeEncoding(r){if(!r)return"utf8";for(var g;;)switch(r){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return r;default:if(g)return;r=(""+r).toLowerCase(),g=!0}}function normalizeEncoding(r){var g=_normalizeEncoding(r);if(typeof g!="string"&&(Buffer$1.isEncoding===isEncoding||!isEncoding(r)))throw new Error("Unknown encoding: "+r);return g||r}string_decoder.StringDecoder=StringDecoder;function StringDecoder(r){this.encoding=normalizeEncoding(r);var g;switch(this.encoding){case"utf16le":this.text=utf16Text,this.end=utf16End,g=4;break;case"utf8":this.fillLast=utf8FillLast,g=4;break;case"base64":this.text=base64Text,this.end=base64End,g=3;break;default:this.write=simpleWrite,this.end=simpleEnd;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=Buffer$1.allocUnsafe(g)}StringDecoder.prototype.write=function(r){if(r.length===0)return"";var g,l;if(this.lastNeed){if(g=this.fillLast(r),g===void 0)return"";l=this.lastNeed,this.lastNeed=0}else l=0;return l<r.length?g?g+this.text(r,l):this.text(r,l):g||""},StringDecoder.prototype.end=utf8End,StringDecoder.prototype.text=utf8Text,StringDecoder.prototype.fillLast=function(r){if(this.lastNeed<=r.length)return r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,r.length),this.lastNeed-=r.length};function utf8CheckByte(r){return r<=127?0:r>>5===6?2:r>>4===14?3:r>>3===30?4:r>>6===2?-1:-2}function utf8CheckIncomplete(r,g,l){var v=g.length-1;if(v<l)return 0;var I=utf8CheckByte(g[v]);return I>=0?(I>0&&(r.lastNeed=I-1),I):--v<l||I===-2?0:(I=utf8CheckByte(g[v]),I>=0?(I>0&&(r.lastNeed=I-2),I):--v<l||I===-2?0:(I=utf8CheckByte(g[v]),I>=0?(I>0&&(I===2?I=0:r.lastNeed=I-3),I):0))}function utf8CheckExtraBytes(r,g,l){if((g[0]&192)!==128)return r.lastNeed=0,"\uFFFD";if(r.lastNeed>1&&g.length>1){if((g[1]&192)!==128)return r.lastNeed=1,"\uFFFD";if(r.lastNeed>2&&g.length>2&&(g[2]&192)!==128)return r.lastNeed=2,"\uFFFD"}}function utf8FillLast(r){var g=this.lastTotal-this.lastNeed,l=utf8CheckExtraBytes(this,r);if(l!==void 0)return l;if(this.lastNeed<=r.length)return r.copy(this.lastChar,g,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,g,0,r.length),this.lastNeed-=r.length}function utf8Text(r,g){var l=utf8CheckIncomplete(this,r,g);if(!this.lastNeed)return r.toString("utf8",g);this.lastTotal=l;var v=r.length-(l-this.lastNeed);return r.copy(this.lastChar,0,v),r.toString("utf8",g,v)}function utf8End(r){var g=r&&r.length?this.write(r):"";return this.lastNeed?g+"\uFFFD":g}function utf16Text(r,g){if((r.length-g)%2===0){var l=r.toString("utf16le",g);if(l){var v=l.charCodeAt(l.length-1);if(v>=55296&&v<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1],l.slice(0,-1)}return l}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=r[r.length-1],r.toString("utf16le",g,r.length-1)}function utf16End(r){var g=r&&r.length?this.write(r):"";if(this.lastNeed){var l=this.lastTotal-this.lastNeed;return g+this.lastChar.toString("utf16le",0,l)}return g}function base64Text(r,g){var l=(r.length-g)%3;return l===0?r.toString("base64",g):(this.lastNeed=3-l,this.lastTotal=3,l===1?this.lastChar[0]=r[r.length-1]:(this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1]),r.toString("base64",g,r.length-l))}function base64End(r){var g=r&&r.length?this.write(r):"";return this.lastNeed?g+this.lastChar.toString("base64",0,3-this.lastNeed):g}function simpleWrite(r){return r.toString(this.encoding)}function simpleEnd(r){return r&&r.length?this.write(r):""}(function(r){(function(g){g.parser=function(te,Z){return new v(te,Z)},g.SAXParser=v,g.SAXStream=Y,g.createStream=U,g.MAX_BUFFER_LENGTH=64*1024;var l=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];g.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function v(te,Z){if(!(this instanceof v))return new v(te,Z);var De=this;D(De),De.q=De.c="",De.bufferCheckPosition=g.MAX_BUFFER_LENGTH,De.opt=Z||{},De.opt.lowercase=De.opt.lowercase||De.opt.lowercasetags,De.looseCase=De.opt.lowercase?"toLowerCase":"toUpperCase",De.tags=[],De.closed=De.closedRoot=De.sawRoot=!1,De.tag=De.error=null,De.strict=!!te,De.noscript=!!(te||De.opt.noscript),De.state=xe.BEGIN,De.strictEntities=De.opt.strictEntities,De.ENTITIES=De.strictEntities?Object.create(g.XML_ENTITIES):Object.create(g.ENTITIES),De.attribList=[],De.opt.xmlns&&(De.ns=Object.create(Se)),De.trackPosition=De.opt.position!==!1,De.trackPosition&&(De.position=De.line=De.column=0),Fe(De,"onready")}Object.create||(Object.create=function(te){function Z(){}Z.prototype=te;var De=new Z;return De}),Object.keys||(Object.keys=function(te){var Z=[];for(var De in te)te.hasOwnProperty(De)&&Z.push(De);return Z});function I(te){for(var Z=Math.max(g.MAX_BUFFER_LENGTH,10),De=0,Te=0,je=l.length;Te<je;Te++){var Ve=te[l[Te]].length;if(Ve>Z)switch(l[Te]){case"textNode":rt(te);break;case"cdata":Pe(te,"oncdata",te.cdata),te.cdata="";break;case"script":Pe(te,"onscript",te.script),te.script="";break;default:it(te,"Max buffer length exceeded: "+l[Te])}De=Math.max(De,Ve)}var Xe=g.MAX_BUFFER_LENGTH-De;te.bufferCheckPosition=Xe+te.position}function D(te){for(var Z=0,De=l.length;Z<De;Z++)te[l[Z]]=""}function L(te){rt(te),te.cdata!==""&&(Pe(te,"oncdata",te.cdata),te.cdata=""),te.script!==""&&(Pe(te,"onscript",te.script),te.script="")}v.prototype={end:function(){nt(this)},write:Et,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){L(this)}};var S;try{S=require("stream").Stream}catch(te){S=function(){}}S||(S=function(){});var ee=g.EVENTS.filter(function(te){return te!=="error"&&te!=="end"});function U(te,Z){return new Y(te,Z)}function Y(te,Z){if(!(this instanceof Y))return new Y(te,Z);S.apply(this),this._parser=new v(te,Z),this.writable=!0,this.readable=!0;var De=this;this._parser.onend=function(){De.emit("end")},this._parser.onerror=function(Te){De.emit("error",Te),De._parser.error=null},this._decoder=null,ee.forEach(function(Te){Object.defineProperty(De,"on"+Te,{get:function(){return De._parser["on"+Te]},set:function(je){if(!je)return De.removeAllListeners(Te),De._parser["on"+Te]=je,je;De.on(Te,je)},enumerable:!0,configurable:!1})})}Y.prototype=Object.create(S.prototype,{constructor:{value:Y}}),Y.prototype.write=function(te){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(te)){if(!this._decoder){var Z=string_decoder.StringDecoder;this._decoder=new Z("utf8")}te=this._decoder.write(te)}return this._parser.write(te.toString()),this.emit("data",te),!0},Y.prototype.end=function(te){return te&&te.length&&this.write(te),this._parser.end(),!0},Y.prototype.on=function(te,Z){var De=this;return!De._parser["on"+te]&&ee.indexOf(te)!==-1&&(De._parser["on"+te]=function(){var Te=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);Te.splice(0,0,te),De.emit.apply(De,Te)}),S.prototype.on.call(De,te,Z)};var $e="[CDATA[",_e="DOCTYPE",ve="http://www.w3.org/XML/1998/namespace",we="http://www.w3.org/2000/xmlns/",Se={xml:ve,xmlns:we},Ie=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Ne=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,Ce=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Be=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function Re(te){return te===" "||te===`
`||te==="\r"||te==="	"}function Oe(te){return te==='"'||te==="'"}function Ue(te){return te===">"||Re(te)}function Le(te,Z){return te.test(Z)}function Me(te,Z){return!Le(te,Z)}var xe=0;g.STATE={BEGIN:xe++,BEGIN_WHITESPACE:xe++,TEXT:xe++,TEXT_ENTITY:xe++,OPEN_WAKA:xe++,SGML_DECL:xe++,SGML_DECL_QUOTED:xe++,DOCTYPE:xe++,DOCTYPE_QUOTED:xe++,DOCTYPE_DTD:xe++,DOCTYPE_DTD_QUOTED:xe++,COMMENT_STARTING:xe++,COMMENT:xe++,COMMENT_ENDING:xe++,COMMENT_ENDED:xe++,CDATA:xe++,CDATA_ENDING:xe++,CDATA_ENDING_2:xe++,PROC_INST:xe++,PROC_INST_BODY:xe++,PROC_INST_ENDING:xe++,OPEN_TAG:xe++,OPEN_TAG_SLASH:xe++,ATTRIB:xe++,ATTRIB_NAME:xe++,ATTRIB_NAME_SAW_WHITE:xe++,ATTRIB_VALUE:xe++,ATTRIB_VALUE_QUOTED:xe++,ATTRIB_VALUE_CLOSED:xe++,ATTRIB_VALUE_UNQUOTED:xe++,ATTRIB_VALUE_ENTITY_Q:xe++,ATTRIB_VALUE_ENTITY_U:xe++,CLOSE_TAG:xe++,CLOSE_TAG_SAW_WHITE:xe++,SCRIPT:xe++,SCRIPT_ENDING:xe++},g.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},g.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(g.ENTITIES).forEach(function(te){var Z=g.ENTITIES[te],De=typeof Z=="number"?String.fromCharCode(Z):Z;g.ENTITIES[te]=De});for(var He in g.STATE)g.STATE[g.STATE[He]]=He;xe=g.STATE;function Fe(te,Z,De){te[Z]&&te[Z](De)}function Pe(te,Z,De){te.textNode&&rt(te),Fe(te,Z,De)}function rt(te){te.textNode=Ye(te.opt,te.textNode),te.textNode&&Fe(te,"ontext",te.textNode),te.textNode=""}function Ye(te,Z){return te.trim&&(Z=Z.trim()),te.normalize&&(Z=Z.replace(/\s+/g," ")),Z}function it(te,Z){return rt(te),te.trackPosition&&(Z+=`
Line: `+te.line+`
Column: `+te.column+`
Char: `+te.c),Z=new Error(Z),te.error=Z,Fe(te,"onerror",Z),te}function nt(te){return te.sawRoot&&!te.closedRoot&&Ze(te,"Unclosed root tag"),te.state!==xe.BEGIN&&te.state!==xe.BEGIN_WHITESPACE&&te.state!==xe.TEXT&&it(te,"Unexpected end"),rt(te),te.c="",te.closed=!0,Fe(te,"onend"),v.call(te,te.strict,te.opt),te}function Ze(te,Z){if(typeof te!="object"||!(te instanceof v))throw new Error("bad call to strictFail");te.strict&&it(te,Z)}function at(te){te.strict||(te.tagName=te.tagName[te.looseCase]());var Z=te.tags[te.tags.length-1]||te,De=te.tag={name:te.tagName,attributes:{}};te.opt.xmlns&&(De.ns=Z.ns),te.attribList.length=0,Pe(te,"onopentagstart",De)}function ft(te,Z){var De=te.indexOf(":"),Te=De<0?["",te]:te.split(":"),je=Te[0],Ve=Te[1];return Z&&te==="xmlns"&&(je="xmlns",Ve=""),{prefix:je,local:Ve}}function ut(te){if(te.strict||(te.attribName=te.attribName[te.looseCase]()),te.attribList.indexOf(te.attribName)!==-1||te.tag.attributes.hasOwnProperty(te.attribName)){te.attribName=te.attribValue="";return}if(te.opt.xmlns){var Z=ft(te.attribName,!0),De=Z.prefix,Te=Z.local;if(De==="xmlns")if(Te==="xml"&&te.attribValue!==ve)Ze(te,"xml: prefix must be bound to "+ve+`
Actual: `+te.attribValue);else if(Te==="xmlns"&&te.attribValue!==we)Ze(te,"xmlns: prefix must be bound to "+we+`
Actual: `+te.attribValue);else{var je=te.tag,Ve=te.tags[te.tags.length-1]||te;je.ns===Ve.ns&&(je.ns=Object.create(Ve.ns)),je.ns[Te]=te.attribValue}te.attribList.push([te.attribName,te.attribValue])}else te.tag.attributes[te.attribName]=te.attribValue,Pe(te,"onattribute",{name:te.attribName,value:te.attribValue});te.attribName=te.attribValue=""}function We(te,Z){if(te.opt.xmlns){var De=te.tag,Te=ft(te.tagName);De.prefix=Te.prefix,De.local=Te.local,De.uri=De.ns[Te.prefix]||"",De.prefix&&!De.uri&&(Ze(te,"Unbound namespace prefix: "+JSON.stringify(te.tagName)),De.uri=Te.prefix);var je=te.tags[te.tags.length-1]||te;De.ns&&je.ns!==De.ns&&Object.keys(De.ns).forEach(function(st){Pe(te,"onopennamespace",{prefix:st,uri:De.ns[st]})});for(var Ve=0,Xe=te.attribList.length;Ve<Xe;Ve++){var tt=te.attribList[Ve],ot=tt[0],ct=tt[1],et=ft(ot,!0),lt=et.prefix,vt=et.local,gt=lt===""?"":De.ns[lt]||"",dt={name:ot,value:ct,prefix:lt,local:vt,uri:gt};lt&&lt!=="xmlns"&&!gt&&(Ze(te,"Unbound namespace prefix: "+JSON.stringify(lt)),dt.uri=lt),te.tag.attributes[ot]=dt,Pe(te,"onattribute",dt)}te.attribList.length=0}te.tag.isSelfClosing=!!Z,te.sawRoot=!0,te.tags.push(te.tag),Pe(te,"onopentag",te.tag),Z||(!te.noscript&&te.tagName.toLowerCase()==="script"?te.state=xe.SCRIPT:te.state=xe.TEXT,te.tag=null,te.tagName=""),te.attribName=te.attribValue="",te.attribList.length=0}function Qe(te){if(!te.tagName){Ze(te,"Weird empty close tag."),te.textNode+="</>",te.state=xe.TEXT;return}if(te.script){if(te.tagName!=="script"){te.script+="</"+te.tagName+">",te.tagName="",te.state=xe.SCRIPT;return}Pe(te,"onscript",te.script),te.script=""}var Z=te.tags.length,De=te.tagName;te.strict||(De=De[te.looseCase]());for(var Te=De;Z--;){var je=te.tags[Z];if(je.name!==Te)Ze(te,"Unexpected close tag");else break}if(Z<0){Ze(te,"Unmatched closing tag: "+te.tagName),te.textNode+="</"+te.tagName+">",te.state=xe.TEXT;return}te.tagName=De;for(var Ve=te.tags.length;Ve-- >Z;){var Xe=te.tag=te.tags.pop();te.tagName=te.tag.name,Pe(te,"onclosetag",te.tagName);var tt={};for(var ot in Xe.ns)tt[ot]=Xe.ns[ot];var ct=te.tags[te.tags.length-1]||te;te.opt.xmlns&&Xe.ns!==ct.ns&&Object.keys(Xe.ns).forEach(function(et){var lt=Xe.ns[et];Pe(te,"onclosenamespace",{prefix:et,uri:lt})})}Z===0&&(te.closedRoot=!0),te.tagName=te.attribValue=te.attribName="",te.attribList.length=0,te.state=xe.TEXT}function _t(te){var Z=te.entity,De=Z.toLowerCase(),Te,je="";return te.ENTITIES[Z]?te.ENTITIES[Z]:te.ENTITIES[De]?te.ENTITIES[De]:(Z=De,Z.charAt(0)==="#"&&(Z.charAt(1)==="x"?(Z=Z.slice(2),Te=parseInt(Z,16),je=Te.toString(16)):(Z=Z.slice(1),Te=parseInt(Z,10),je=Te.toString(10))),Z=Z.replace(/^0+/,""),isNaN(Te)||je.toLowerCase()!==Z?(Ze(te,"Invalid character entity"),"&"+te.entity+";"):String.fromCodePoint(Te))}function pt(te,Z){Z==="<"?(te.state=xe.OPEN_WAKA,te.startTagPosition=te.position):Re(Z)||(Ze(te,"Non-whitespace before first tag."),te.textNode=Z,te.state=xe.TEXT)}function mt(te,Z){var De="";return Z<te.length&&(De=te.charAt(Z)),De}function Et(te){var Z=this;if(this.error)throw this.error;if(Z.closed)return it(Z,"Cannot write after close. Assign an onready handler.");if(te===null)return nt(Z);typeof te=="object"&&(te=te.toString());for(var De=0,Te="";Te=mt(te,De++),Z.c=Te,!!Te;)switch(Z.trackPosition&&(Z.position++,Te===`
`?(Z.line++,Z.column=0):Z.column++),Z.state){case xe.BEGIN:if(Z.state=xe.BEGIN_WHITESPACE,Te==="\uFEFF")continue;pt(Z,Te);continue;case xe.BEGIN_WHITESPACE:pt(Z,Te);continue;case xe.TEXT:if(Z.sawRoot&&!Z.closedRoot){for(var je=De-1;Te&&Te!=="<"&&Te!=="&";)Te=mt(te,De++),Te&&Z.trackPosition&&(Z.position++,Te===`
`?(Z.line++,Z.column=0):Z.column++);Z.textNode+=te.substring(je,De-1)}Te==="<"&&!(Z.sawRoot&&Z.closedRoot&&!Z.strict)?(Z.state=xe.OPEN_WAKA,Z.startTagPosition=Z.position):(!Re(Te)&&(!Z.sawRoot||Z.closedRoot)&&Ze(Z,"Text data outside of root node."),Te==="&"?Z.state=xe.TEXT_ENTITY:Z.textNode+=Te);continue;case xe.SCRIPT:Te==="<"?Z.state=xe.SCRIPT_ENDING:Z.script+=Te;continue;case xe.SCRIPT_ENDING:Te==="/"?Z.state=xe.CLOSE_TAG:(Z.script+="<"+Te,Z.state=xe.SCRIPT);continue;case xe.OPEN_WAKA:if(Te==="!")Z.state=xe.SGML_DECL,Z.sgmlDecl="";else if(!Re(Te))if(Le(Ie,Te))Z.state=xe.OPEN_TAG,Z.tagName=Te;else if(Te==="/")Z.state=xe.CLOSE_TAG,Z.tagName="";else if(Te==="?")Z.state=xe.PROC_INST,Z.procInstName=Z.procInstBody="";else{if(Ze(Z,"Unencoded <"),Z.startTagPosition+1<Z.position){var Ve=Z.position-Z.startTagPosition;Te=new Array(Ve).join(" ")+Te}Z.textNode+="<"+Te,Z.state=xe.TEXT}continue;case xe.SGML_DECL:(Z.sgmlDecl+Te).toUpperCase()===$e?(Pe(Z,"onopencdata"),Z.state=xe.CDATA,Z.sgmlDecl="",Z.cdata=""):Z.sgmlDecl+Te==="--"?(Z.state=xe.COMMENT,Z.comment="",Z.sgmlDecl=""):(Z.sgmlDecl+Te).toUpperCase()===_e?(Z.state=xe.DOCTYPE,(Z.doctype||Z.sawRoot)&&Ze(Z,"Inappropriately located doctype declaration"),Z.doctype="",Z.sgmlDecl=""):Te===">"?(Pe(Z,"onsgmldeclaration",Z.sgmlDecl),Z.sgmlDecl="",Z.state=xe.TEXT):(Oe(Te)&&(Z.state=xe.SGML_DECL_QUOTED),Z.sgmlDecl+=Te);continue;case xe.SGML_DECL_QUOTED:Te===Z.q&&(Z.state=xe.SGML_DECL,Z.q=""),Z.sgmlDecl+=Te;continue;case xe.DOCTYPE:Te===">"?(Z.state=xe.TEXT,Pe(Z,"ondoctype",Z.doctype),Z.doctype=!0):(Z.doctype+=Te,Te==="["?Z.state=xe.DOCTYPE_DTD:Oe(Te)&&(Z.state=xe.DOCTYPE_QUOTED,Z.q=Te));continue;case xe.DOCTYPE_QUOTED:Z.doctype+=Te,Te===Z.q&&(Z.q="",Z.state=xe.DOCTYPE);continue;case xe.DOCTYPE_DTD:Z.doctype+=Te,Te==="]"?Z.state=xe.DOCTYPE:Oe(Te)&&(Z.state=xe.DOCTYPE_DTD_QUOTED,Z.q=Te);continue;case xe.DOCTYPE_DTD_QUOTED:Z.doctype+=Te,Te===Z.q&&(Z.state=xe.DOCTYPE_DTD,Z.q="");continue;case xe.COMMENT:Te==="-"?Z.state=xe.COMMENT_ENDING:Z.comment+=Te;continue;case xe.COMMENT_ENDING:Te==="-"?(Z.state=xe.COMMENT_ENDED,Z.comment=Ye(Z.opt,Z.comment),Z.comment&&Pe(Z,"oncomment",Z.comment),Z.comment=""):(Z.comment+="-"+Te,Z.state=xe.COMMENT);continue;case xe.COMMENT_ENDED:Te!==">"?(Ze(Z,"Malformed comment"),Z.comment+="--"+Te,Z.state=xe.COMMENT):Z.state=xe.TEXT;continue;case xe.CDATA:Te==="]"?Z.state=xe.CDATA_ENDING:Z.cdata+=Te;continue;case xe.CDATA_ENDING:Te==="]"?Z.state=xe.CDATA_ENDING_2:(Z.cdata+="]"+Te,Z.state=xe.CDATA);continue;case xe.CDATA_ENDING_2:Te===">"?(Z.cdata&&Pe(Z,"oncdata",Z.cdata),Pe(Z,"onclosecdata"),Z.cdata="",Z.state=xe.TEXT):Te==="]"?Z.cdata+="]":(Z.cdata+="]]"+Te,Z.state=xe.CDATA);continue;case xe.PROC_INST:Te==="?"?Z.state=xe.PROC_INST_ENDING:Re(Te)?Z.state=xe.PROC_INST_BODY:Z.procInstName+=Te;continue;case xe.PROC_INST_BODY:if(!Z.procInstBody&&Re(Te))continue;Te==="?"?Z.state=xe.PROC_INST_ENDING:Z.procInstBody+=Te;continue;case xe.PROC_INST_ENDING:Te===">"?(Pe(Z,"onprocessinginstruction",{name:Z.procInstName,body:Z.procInstBody}),Z.procInstName=Z.procInstBody="",Z.state=xe.TEXT):(Z.procInstBody+="?"+Te,Z.state=xe.PROC_INST_BODY);continue;case xe.OPEN_TAG:Le(Ne,Te)?Z.tagName+=Te:(at(Z),Te===">"?We(Z):Te==="/"?Z.state=xe.OPEN_TAG_SLASH:(Re(Te)||Ze(Z,"Invalid character in tag name"),Z.state=xe.ATTRIB));continue;case xe.OPEN_TAG_SLASH:Te===">"?(We(Z,!0),Qe(Z)):(Ze(Z,"Forward-slash in opening tag not followed by >"),Z.state=xe.ATTRIB);continue;case xe.ATTRIB:if(Re(Te))continue;Te===">"?We(Z):Te==="/"?Z.state=xe.OPEN_TAG_SLASH:Le(Ie,Te)?(Z.attribName=Te,Z.attribValue="",Z.state=xe.ATTRIB_NAME):Ze(Z,"Invalid attribute name");continue;case xe.ATTRIB_NAME:Te==="="?Z.state=xe.ATTRIB_VALUE:Te===">"?(Ze(Z,"Attribute without value"),Z.attribValue=Z.attribName,ut(Z),We(Z)):Re(Te)?Z.state=xe.ATTRIB_NAME_SAW_WHITE:Le(Ne,Te)?Z.attribName+=Te:Ze(Z,"Invalid attribute name");continue;case xe.ATTRIB_NAME_SAW_WHITE:if(Te==="=")Z.state=xe.ATTRIB_VALUE;else{if(Re(Te))continue;Ze(Z,"Attribute without value"),Z.tag.attributes[Z.attribName]="",Z.attribValue="",Pe(Z,"onattribute",{name:Z.attribName,value:""}),Z.attribName="",Te===">"?We(Z):Le(Ie,Te)?(Z.attribName=Te,Z.state=xe.ATTRIB_NAME):(Ze(Z,"Invalid attribute name"),Z.state=xe.ATTRIB)}continue;case xe.ATTRIB_VALUE:if(Re(Te))continue;Oe(Te)?(Z.q=Te,Z.state=xe.ATTRIB_VALUE_QUOTED):(Ze(Z,"Unquoted attribute value"),Z.state=xe.ATTRIB_VALUE_UNQUOTED,Z.attribValue=Te);continue;case xe.ATTRIB_VALUE_QUOTED:if(Te!==Z.q){Te==="&"?Z.state=xe.ATTRIB_VALUE_ENTITY_Q:Z.attribValue+=Te;continue}ut(Z),Z.q="",Z.state=xe.ATTRIB_VALUE_CLOSED;continue;case xe.ATTRIB_VALUE_CLOSED:Re(Te)?Z.state=xe.ATTRIB:Te===">"?We(Z):Te==="/"?Z.state=xe.OPEN_TAG_SLASH:Le(Ie,Te)?(Ze(Z,"No whitespace between attributes"),Z.attribName=Te,Z.attribValue="",Z.state=xe.ATTRIB_NAME):Ze(Z,"Invalid attribute name");continue;case xe.ATTRIB_VALUE_UNQUOTED:if(!Ue(Te)){Te==="&"?Z.state=xe.ATTRIB_VALUE_ENTITY_U:Z.attribValue+=Te;continue}ut(Z),Te===">"?We(Z):Z.state=xe.ATTRIB;continue;case xe.CLOSE_TAG:if(Z.tagName)Te===">"?Qe(Z):Le(Ne,Te)?Z.tagName+=Te:Z.script?(Z.script+="</"+Z.tagName,Z.tagName="",Z.state=xe.SCRIPT):(Re(Te)||Ze(Z,"Invalid tagname in closing tag"),Z.state=xe.CLOSE_TAG_SAW_WHITE);else{if(Re(Te))continue;Me(Ie,Te)?Z.script?(Z.script+="</"+Te,Z.state=xe.SCRIPT):Ze(Z,"Invalid tagname in closing tag."):Z.tagName=Te}continue;case xe.CLOSE_TAG_SAW_WHITE:if(Re(Te))continue;Te===">"?Qe(Z):Ze(Z,"Invalid characters in closing tag");continue;case xe.TEXT_ENTITY:case xe.ATTRIB_VALUE_ENTITY_Q:case xe.ATTRIB_VALUE_ENTITY_U:var Xe,tt;switch(Z.state){case xe.TEXT_ENTITY:Xe=xe.TEXT,tt="textNode";break;case xe.ATTRIB_VALUE_ENTITY_Q:Xe=xe.ATTRIB_VALUE_QUOTED,tt="attribValue";break;case xe.ATTRIB_VALUE_ENTITY_U:Xe=xe.ATTRIB_VALUE_UNQUOTED,tt="attribValue";break}if(Te===";")if(Z.opt.unparsedEntities){var ot=_t(Z);Z.entity="",Z.state=Xe,Z.write(ot)}else Z[tt]+=_t(Z),Z.entity="",Z.state=Xe;else Le(Z.entity.length?Be:Ce,Te)?Z.entity+=Te:(Ze(Z,"Invalid character in entity name"),Z[tt]+="&"+Z.entity+Te,Z.entity="",Z.state=Xe);continue;default:throw new Error(Z,"Unknown state: "+Z.state)}return Z.position>=Z.bufferCheckPosition&&I(Z),Z}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var te=String.fromCharCode,Z=Math.floor,De=function(){var Te=16384,je=[],Ve,Xe,tt=-1,ot=arguments.length;if(!ot)return"";for(var ct="";++tt<ot;){var et=Number(arguments[tt]);if(!isFinite(et)||et<0||et>1114111||Z(et)!==et)throw RangeError("Invalid code point: "+et);et<=65535?je.push(et):(et-=65536,Ve=(et>>10)+55296,Xe=et%1024+56320,je.push(Ve,Xe)),(tt+1===ot||je.length>Te)&&(ct+=te.apply(null,je),je.length=0)}return ct};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:De,configurable:!0,writable:!0}):String.fromCodePoint=De}()})(r)})(sax);const logger={debug:()=>{}},_$2=r=>{const g=sax.parser(!0,{trim:!1,normalize:!1});let l,v=null;return new Promise((I,D)=>{g.onopentag=L=>{const S={_parent:v||void 0,_children:[],_fTextNode:!1,_tag:L.name,_attrs:L.attributes};v!=null?v._children.push(S):l=S,v=S},g.onclosetag=()=>{v=v!=null?v._parent:null},g.ontext=L=>{v!=null&&v._children.push({_parent:v,_children:[],_fTextNode:!0,_text:L})},g.onend=()=>{I(l)},g.onerror=L=>{D(L)},g.write(r),g.end()})};function m$1(r,g,l="",v=!0){const I=l.length||!v?"":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>',D=[Buffer.from(I,"utf-8")];if(r._fTextNode)D.push(Buffer.from(N(r._text,g)));else{let L="";const S=r._attrs;Object.keys(S).forEach(_e=>{L+=` ${_e}="${x(S[_e])}"`});const ee=r._children.length>0,U=ee?"":"/",Y=g.indentXml?`
${l}`:"";D.push(Buffer.from(`${Y}<${r._tag}${L}${U}>`));let $e=!1;if(r._children.forEach(_e=>{D.push(m$1(_e,g,g.indentXml?`${l}  `:"",!1)),$e=!_e._fTextNode}),ee){const _e=g.indentXml&&$e?`
${l}`:"";D.push(Buffer.from(`${_e}</${r._tag}>`))}}return Buffer.concat(D)}const h$2={"&":"&amp;","<":"&lt;",">":"&gt;"},T=/[&<>]/g,E$1={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"},X$2=/[&<>'"]/g,N=(r,g)=>{const l=r.split(g.literalXmlDelimiter),v=[];let I=!1;for(let D=0;D<l.length;D++){const L=l[D];v.push(I?L:L.replace(T,S=>h$2[S])),I=!I}return v.join("")},x=r=>(typeof r=="string"?r:r.value).replace(X$2,g=>E$1[g]);var n=Object.defineProperty,c$2=(r,g,l)=>g in r?n(r,g,{enumerable:!0,configurable:!0,writable:!0,value:l}):r[g]=l,e=(r,g,l)=>c$2(r,typeof g!="symbol"?g+"":g,l);function isError(r){return r instanceof Error||typeof r=="object"&&!!r&&"name"in r&&"message"in r}class NullishCommandResultError extends Error{constructor(g){super(`Result of command ${g} is null or undefined and rejectNullish is set`),e(this,"command"),Object.setPrototypeOf(this,NullishCommandResultError.prototype),this.command=g}}class ObjectCommandResultError extends Error{constructor(g,l){super(`Result of command '${g}' is an object`),e(this,"command"),e(this,"result"),Object.setPrototypeOf(this,ObjectCommandResultError.prototype),this.command=g,this.result=l}}class CommandSyntaxError extends Error{constructor(g){super(`Invalid command syntax: ${g}`),e(this,"command"),Object.setPrototypeOf(this,CommandSyntaxError.prototype),this.command=g}}class InvalidCommandError extends Error{constructor(g,l){super(`${g}: ${l}`),e(this,"command"),Object.setPrototypeOf(this,InvalidCommandError.prototype),this.command=l}}class CommandExecutionError extends Error{constructor(g,l){super(`Error executing command '${l}': ${g.name}: ${g.message}`),e(this,"command"),e(this,"err"),Object.setPrototypeOf(this,CommandExecutionError.prototype),this.command=l,this.err=g}}class ImageError extends CommandExecutionError{}class InternalError extends Error{constructor(g){super(`INTERNAL ERROR: ${g}`)}}class TemplateParseError extends Error{}class IncompleteConditionalStatementError extends Error{constructor(){super("Incomplete IF/END-IF statement. Make sure each IF-statement has a corresponding END-IF command.")}}class UnterminatedForLoopError extends Error{constructor(g){super(`Unterminated FOR-loop ('FOR ${g.varName}'). Make sure each FOR loop has a corresponding END-FOR command.`)}}const i=r=>r._fTextNode?{_children:[],_fTextNode:!0,_text:r._text}:{_children:[],_fTextNode:!1,_tag:r._tag,_attrs:r._attrs},_$1=r=>{const g=r._parent;if(g==null)return null;const l=g._children,v=l.indexOf(r);return v<0||v>=l.length-1?null:l[v+1]},a$1=r=>{const g=r._parent;if(!(g&&!g._fTextNode&&g._tag==="w:t"))throw new TemplateParseError("Template syntax error: text node not within w:t");const l=g._parent;if(l==null)throw new TemplateParseError("Template syntax error: w:t node has no parent");const v=l._children.indexOf(g);if(v<0)throw new TemplateParseError("Template syntax error");const I=i(g);I._parent=l;const D={_parent:I,_children:[],_fTextNode:!0,_text:""};return I._children=[D],l._children.splice(v+1,0,I),D},c$1=(r,g={},l=[])=>{const v={_fTextNode:!1,_tag:r,_attrs:g,_children:l};return v._children.forEach(I=>{I._parent=v}),v},u=r=>({_children:[],_fTextNode:!0,_text:r}),p$1=(r,g)=>(r._children.push(g),g._parent=r,g),s=r=>r.loops.length?r.loops[r.loops.length-1]:null,f$1=r=>{const g=s(r);return g!=null&&g.idx<0},h$1=r=>{if(!r.length)return;const g=r.length-1,{varName:l,idx:v,loopOver:I,isIf:D}=r[g],L=v>=0?v+1:"EXPLORATION";logger.debug(`${D?"IF":"FOR"} loop on ${g}:${l}${L}/${I.length}`)},p=(r,g,l)=>{let v=r,I=!1,D=null,L=0;const S=`${g[0]}CMD_NODE${g[1]}`;for(;v!=null;){if(l&&!v._fTextNode&&v._tag==="w:t"&&(v._attrs["xml:space"]="preserve"),!v._fTextNode&&v._tag==="w:p"&&D&&(D._text+=" "),v._fTextNode&&v._parent&&!v._parent._fTextNode&&v._parent._tag==="w:t"){D==null&&(D=v);const ee=v._text;v._text="";for(let U=0;U<ee.length;U++){const Y=ee[U],$e=I?g[1]:g[0];if(Y===$e[L]){if(L+=1,L===$e.length){I=!I;const _e=v===D;I&&D._text.length&&(D=a$1(D),_e&&(v=D)),D._text+=$e,!I&&U<ee.length-1&&(D=a$1(D),_e&&(v=D)),L=0,I||(D=v)}}else L&&(D._text+=$e.slice(0,L),L=0,I||(D=v)),D._text+=Y}!I&&!L&&(D=null),ee.length&&!v._text.length&&(v._text=S)}if(v._children.length)v=v._children[0];else{let ee=!1;for(;v._parent!=null;){const U=v._parent,Y=_$1(v);if(Y){ee=!0,v=Y;break}v=U}ee||(v=null)}}return r};var vmBrowserify={};(function(exports){var indexOf=function(r,g){if(r.indexOf)return r.indexOf(g);for(var l=0;l<r.length;l++)if(r[l]===g)return l;return-1},Object_keys=function(r){if(Object.keys)return Object.keys(r);var g=[];for(var l in r)g.push(l);return g},forEach=function(r,g){if(r.forEach)return r.forEach(g);for(var l=0;l<r.length;l++)g(r[l],l,r)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(r,g,l){Object.defineProperty(r,g,{writable:!0,enumerable:!1,configurable:!0,value:l})}}catch(r){return function(g,l,v){g[l]=v}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}Context.prototype={};var Script=exports.Script=function(g){if(!(this instanceof Script))return new Script(g);this.code=g};Script.prototype.runInContext=function(r){if(!(r instanceof Context))throw new TypeError("needs a 'context' argument.");var g=document.createElement("iframe");g.style||(g.style={}),g.style.display="none",document.body.appendChild(g);var l=g.contentWindow,v=l.eval,I=l.execScript;!v&&I&&(I.call(l,"null"),v=l.eval),forEach(Object_keys(r),function(S){l[S]=r[S]}),forEach(globals,function(S){r[S]&&(l[S]=r[S])});var D=Object_keys(l),L=v.call(l,this.code);return forEach(Object_keys(l),function(S){(S in r||indexOf(D,S)===-1)&&(r[S]=l[S])}),forEach(globals,function(S){S in r||defineProp(r,S,l[S])}),document.body.removeChild(g),L},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(r){var g=Script.createContext(r),l=this.runInContext(g);return r&&forEach(Object_keys(g),function(v){r[v]=g[v]}),l},forEach(Object_keys(Script.prototype),function(r){exports[r]=Script[r]=function(g){var l=Script(g);return l[r].apply(l,[].slice.call(arguments,1))}}),exports.isContext=function(r){return r instanceof Context},exports.createScript=function(r){return exports.Script(r)},exports.createContext=Script.createContext=function(r){var g=new Context;return typeof r=="object"&&forEach(Object_keys(r),function(l){g[l]=r[l]}),g}})(vmBrowserify);var w=Object.defineProperty,C=Object.defineProperties,c=Object.getOwnPropertyDescriptors,_=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable,m=(r,g,l)=>g in r?w(r,g,{enumerable:!0,configurable:!0,writable:!0,value:l}):r[g]=l,a=(r,g)=>{for(var l in g||(g={}))h.call(g,l)&&m(r,l,g[l]);if(_)for(var l of _(g))b.call(g,l)&&m(r,l,g[l]);return r},d=(r,g)=>C(r,c(g));async function runUserJsAndGetRaw(r,g,l){var v;const I=a(a(d(a({},l.jsSandbox||{}),{__code__:g,__result__:void 0}),r),l.options.additionalJsContext),D=s(l);D&&(I.$idx=D.idx),Object.keys(l.vars).forEach(ee=>{I[`$${ee}`]=l.vars[ee]});let L,S;try{if(l.options.runJs){const ee=l.options.runJs({sandbox:I,ctx:l});L=ee.modifiedSandbox,S=await ee.result}else if(l.options.noSandbox)L=I,S=await new Function("with(this) { return eval(__code__); }").call(L);else{const ee=new vmBrowserify.Script((v=I.__code__)!=null?v:"");L=vmBrowserify.createContext(I),S=await ee.runInContext(L)}}catch(ee){const U=isError(ee)?ee:new Error(`${ee}`);if(l.options.errorHandler!=null)L=I,S=await l.options.errorHandler(U,g);else throw new CommandExecutionError(U,g)}if(l.options.rejectNullish&&S==null){const ee=new NullishCommandResultError(g);if(l.options.errorHandler!=null)S=await l.options.errorHandler(ee,g);else throw ee}return l.jsSandbox=d(a({},L),{__code__:void 0,__result__:void 0}),S}const ImageExtensions=[".png",".gif",".jpg",".jpeg",".svg"],BUILT_IN_COMMANDS=["QUERY","CMD_NODE","ALIAS","FOR","END-FOR","IF","END-IF","INS","EXEC","IMAGE","LINK","HTML"];class Node{constructor(g){this.value=g,this.next=void 0}}let Queue$1=class{constructor(){this.clear()}enqueue(g){const l=new Node(g);this._head?(this._tail.next=l,this._tail=l):(this._head=l,this._tail=l),this._size++}dequeue(){const g=this._head;if(g)return this._head=this._head.next,this._size--,g.value}clear(){this._head=void 0,this._tail=void 0,this._size=0}get size(){return this._size}*[Symbol.iterator](){let g=this._head;for(;g;)yield g.value,g=g.next}};var yoctoQueue=Queue$1;const Queue=yoctoQueue,pLimit=r=>{if(!((Number.isInteger(r)||r===1/0)&&r>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");const g=new Queue;let l=0;const v=()=>{l--,g.size>0&&g.dequeue()()},I=async(S,ee,...U)=>{l++;const Y=(async()=>S(...U))();ee(Y);try{await Y}catch($e){}v()},D=(S,ee,...U)=>{g.enqueue(I.bind(null,S,ee,...U)),(async()=>(await Promise.resolve(),l<r&&g.size>0&&g.dequeue()()))()},L=(S,...ee)=>new Promise(U=>{D(S,U,...ee)});return Object.defineProperties(L,{activeCount:{get:()=>l},pendingCount:{get:()=>g.size},clearQueue:{value:()=>{g.clear()}}}),L};var pLimit_1=pLimit,W=Object.defineProperty,X$1=Object.defineProperties,V=Object.getOwnPropertyDescriptors,$=Object.getOwnPropertySymbols,q=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable,F$1=(r,g,l)=>g in r?W(r,g,{enumerable:!0,configurable:!0,writable:!0,value:l}):r[g]=l,k=(r,g)=>{for(var l in g||(g={}))q.call(g,l)&&F$1(r,l,g[l]);if($)for(var l of $(g))K.call(g,l)&&F$1(r,l,g[l]);return r},M=(r,g)=>X$1(r,V(g));const re$1=10;function newContext(r,g=0){return{gCntIf:0,gCntEndIf:0,level:1,fCmd:!1,cmd:"",fSeekQuery:!1,buffers:{"w:p":{text:"",cmds:"",fInsertedText:!1},"w:tr":{text:"",cmds:"",fInsertedText:!1},"w:tc":{text:"",cmds:"",fInsertedText:!1}},imageAndShapeIdIncrement:g,images:{},linkId:0,links:{},htmlId:0,htmls:{},vars:{},loops:[],fJump:!1,shorthands:{},options:r,pIfCheckMap:new Map,trIfCheckMap:new Map,pendingImageDownloads:[]}}async function extractQuery(r,g){const l=newContext(g);l.fSeekQuery=!0;let v=r;for(;;){if(v._children.length)v=v._children[0];else{let D=!1;for(;v._parent!=null;){const L=v._parent,S=_$1(v);if(S){v=S,D=!0;break}v=L}if(!D)break}if(!v)break;const I=v._parent;if(v._fTextNode&&I&&!I._fTextNode&&I._tag==="w:t"&&await J$1(null,v,l,G),l.query!=null)break}return l.query}async function produceJsReport(r,g,l){return walkTemplate(r,g,l,G)}function findHighestImgId(r){const g=[],l=v=>{for(const I of v._children){const D=I._fTextNode?null:I._tag;if(D!=null){if(D==="wp:docPr"){if(I._fTextNode)continue;const L=I._attrs.id;if(typeof L!="string")continue;const S=Number.parseInt(L,10);Number.isSafeInteger(S)&&g.push(S)}I._children.length>0&&l(I)}}};return l(r),g.length>0?Math.max(...g):0}const P=r=>JSON.stringify(r._fTextNode?{_ifName:r._ifName,_fTextNode:r._fTextNode,_text:r==null?void 0:r._text}:{_ifName:r._ifName,_fTextNode:r._fTextNode,_tag:r==null?void 0:r._tag,_attrs:r==null?void 0:r._attrs}),H=r=>{let g=r._parent,l=null;for(;g!=null&&l==null;){if((g._fTextNode?null:g._tag)==="w:p"){const v=g._parent!=null?g._parent._parent:null;v!=null&&!v._fTextNode&&v._tag==="w:tr"?l=v:l=g}g=g._parent}return l},ie$1=r=>{let g=r._parent;for(;g!=null;){if(!g._fTextNode&&g._tag==="w:tc")return!0;g=g._parent}return!1},se$1=r=>r.loops.some(g=>g.isTableCellLoop===!0);async function walkTemplate(r,g,l,v){var I;const D=i(g);let L=g,S=D,ee,U=0;const Y=[];let $e=0;const _e=((I=l.options)==null?void 0:I.maximumWalkingDepth)||1e6;for(;;){const ve=s(l);let we=null;if(l.fJump){if(!ve)throw new InternalError("jumping while curLoop is null");logger.debug(`Jumping to level ${ve.refNodeLevel}...`,P(ve.refNode)),U=l.level-ve.refNodeLevel,L=ve.refNode,l.level=ve.refNodeLevel,l.fJump=!1,ee="JUMP"}else if(L._children.length&&ee!=="UP")L=L._children[0],l.level+=1,ee="DOWN";else if(we=_$1(L))L=we,ee="SIDE";else{const Se=L._parent;if(Se==null)break;if($e>_e)throw logger.debug(`=== parent is still not null after ${$e} loops, something must be wrong ...`,P(Se)),new InternalError("infinite loop or massive dataset detected. Please review and try again");L=Se,l.level-=1,ee="UP"}if(logger.debug(`Next node [${ee}, level ${l.level}]`,P(L)),ee!=="DOWN"){const Se=S._fTextNode?null:S._tag;let Ie=!1;if((Se==="w:p"||Se==="w:tbl"||Se==="w:tr"||Se==="w:tc")&&f$1(l))Ie=!0;else if(Se==="w:p"||Se==="w:tr"){const Ne=l.buffers[Se];Ie=Ne.text===""&&Ne.cmds!==""&&!Ne.fInsertedText,Se==="w:tr"&&Ie&&(Ie=L._children.filter(Ce=>!Ce._fTextNode&&Ce._tag==="w:tr").length!==1)}else if(Se==="w:tc"&&(se$1(l)||l.tableCellLoopJustEnded)){const Ne=l.buffers[Se];Ie=Ne.text===""&&Ne.cmds!==""&&!Ne.fInsertedText,Ie&&(Ie=!(S._children.filter(Ce=>!Ce._fTextNode&&Ce._tag==="w:tbl").length>0)),l.tableCellLoopJustEnded=!1}Ie&&S._parent!=null&&S._parent._children.pop()}if(ee==="UP"){f$1(l)&&ve&&L===ve.refNode._parent&&(ve.refNode=L,ve.refNodeLevel-=1,logger.debug(`Updated loop '${ve.varName}' refNode: `+P(L)));const Se=S._parent;if(Se==null)throw new InternalError("node parent is null");if(S=Se,l.pendingImageNode&&!S._fTextNode&&S._tag==="w:t"){const Ie=l.pendingImageNode.image,Ne=l.pendingImageNode.caption,Ce=S._parent;if(Ce){Ie._parent=Ce,Ce._children.pop(),Ce._children.push(Ie),Ne&&Ce._children.push(...Ne);const Be=l.pendingImageDownloads[l.pendingImageDownloads.length-1];Be&&Be.drawingNode===Ie&&(Be.captionParent=Ce),l.buffers["w:p"].fInsertedText=!0,l.buffers["w:tr"].fInsertedText=!0,l.buffers["w:tc"].fInsertedText=!0}delete l.pendingImageNode}if(l.pendingLinkNode&&!S._fTextNode&&S._tag==="w:r"){const Ie=l.pendingLinkNode,Ne=S._parent;Ne&&(Ie._parent=Ne,Ne._children.pop(),Ne._children.push(Ie),l.buffers["w:p"].fInsertedText=!0,l.buffers["w:tr"].fInsertedText=!0,l.buffers["w:tc"].fInsertedText=!0),delete l.pendingLinkNode}if(l.pendingHtmlNode&&!S._fTextNode&&S._tag==="w:p"){const Ie=l.pendingHtmlNode,Ne=S._parent;Ne&&(Ie._parent=Ne,Ne._children.pop(),Ne._children.push(Ie),l.buffers["w:p"].fInsertedText=!0,l.buffers["w:tr"].fInsertedText=!0,l.buffers["w:tc"].fInsertedText=!0),delete l.pendingHtmlNode}!S._fTextNode&&S._tag==="w:tc"&&!S._children.filter(Ie=>!Ie._fTextNode&&(Ie._tag==="w:p"||Ie._tag==="w:altChunk")).length&&S._children.push({_parent:S,_children:[],_fTextNode:!1,_tag:"w:p",_attrs:{}}),!S._fTextNode&&S._tag==="w:rPr"&&(l.textRunPropsNode=S),!L._fTextNode&&L._tag==="w:r"&&delete l.textRunPropsNode}if(ee==="DOWN"||ee==="SIDE"){if(ee==="SIDE"){if(S._parent==null)throw new InternalError("node parent is null");S=S._parent}const Se=L._fTextNode?null:L._tag;(Se==="w:p"||Se==="w:tr"||Se==="w:tc")&&(l.buffers[Se]={text:"",cmds:"",fInsertedText:!1});const Ie=i(L);Ie._parent=S,S._children.push(Ie);const Ne=Ie._tag;!f$1(l)&&(Ne==="wp:docPr"||Ne==="v:shape")&&(logger.debug("detected a - ",P(Ie)),he$1(Ie,l));const Ce=L._parent;if(L._fTextNode&&Ce&&!Ce._fTextNode&&Ce._tag==="w:t"){const Be=await J$1(r,L,l,v);typeof Be=="string"?(Ie._text=Be,logger.debug("Inserted command result string into node. Updated node: "+P(Ie))):Y.push(...Be)}S=Ie}if(ee==="JUMP")for(;U>0;){if(S._parent==null)throw new InternalError("node parent is null");S=S._parent,U-=1}$e++}if(l.gCntIf!==l.gCntEndIf){const ve=new IncompleteConditionalStatementError;if(l.options.failFast)throw ve;Y.push(ve)}if(l.loops.filter(ve=>!ve.isIf).length>0){const ve=l.loops[l.loops.length-1],we=new UnterminatedForLoopError(ve);if(l.options.failFast)throw we;Y.push(we)}return Y.length>0?{status:"errors",errors:Y}:{status:"success",report:D,images:l.images,links:l.links,htmls:l.htmls}}const J$1=async(r,g,l,v)=>{const{cmdDelimiter:I,failFast:D}=l.options,L=g._text;if(L==null||L==="")return"";const S=L.split(I[0]).map(Y=>Y.split(I[1])).reduce((Y,$e)=>Y.concat($e)),ee=[],U=[];for(let Y=0;Y<S.length;Y++){Y>0&&R(I[0],l,{fCmd:!0});const $e=S[Y];if(l.fCmd?l.cmd+=$e:f$1(l)||ee.push($e),R($e,l,{fCmd:l.fCmd}),Y<S.length-1){if(l.fCmd){const _e=await v(r,g,l);if(_e!=null)if(typeof _e=="string")ee.push(_e),R(_e,l,{fCmd:!1,fInsertedText:!0});else{if(D)throw _e;U.push(_e)}}l.fCmd=!l.fCmd}}return U.length>0?U:ee.join("")},G=async(r,g,l)=>{var v;const I=getCommand(l.cmd,l.shorthands,l.options.fixSmartQuotes);l.cmd="";const{cmdName:D,cmdRest:L}=splitCommand(I);try{if(D!=="CMD_NODE"&&logger.debug(`Processing cmd: ${I}`),l.fSeekQuery){D==="QUERY"&&(l.query=L);return}if(!(D==="QUERY"||D==="CMD_NODE"))if(D==="ALIAS"){const S=/^(\S+)\s+(.+)/.exec(L);if(!S)throw new InvalidCommandError("Invalid ALIAS command",I);const ee=S[1],U=S[2];l.shorthands[ee]=U,logger.debug(`Defined alias '${ee}' for: ${U}`)}else if(D==="FOR"||D==="IF")await de(r,g,l,I,D,L);else if(D==="END-FOR"||D==="END-IF")fe(g,l,I,D,L);else if(D==="INS"){if(!f$1(l)){let S=await runUserJsAndGetRaw(r,L,l);if(S==null)return"";if(typeof S=="object"&&!Array.isArray(S)){const U=new ObjectCommandResultError(L,S);if(l.options.errorHandler!=null)S=await l.options.errorHandler(U,L);else throw U}let ee=String(S);if(l.options.processLineBreaks){const{literalXmlDelimiter:U}=l.options;if(l.options.processLineBreaksAsNewText){const Y=ee.split(`
`),$e=`${U}<w:br/>${U}`,_e=`${U}</w:t>${U}`,ve=`${U}<w:t xml:space="preserve">${U}`;ee=Y.join(`${_e}${$e}${ve}`)}else ee=ee.replace(/\n/g,`${U}<w:br/>${U}`)}return ee}}else if(D==="EXEC")f$1(l)||await runUserJsAndGetRaw(r,L,l);else if(D==="IMAGE"){if(!f$1(l))if(l.options.imageConcurrency!=null){l.imageAndShapeIdIncrement+=1;const S=String(l.imageAndShapeIdIncrement),ee=`img${S}`,U=pe(l,ee,S,I),Y=l.loops.length>0,$e=Y?k({},l.vars):null,_e=Y?(v=s(l))==null?void 0:v.idx:void 0;U.fetchImage=()=>{if($e!==null){const ve=l.vars,we=s(l),Se=we==null?void 0:we.idx;l.vars=$e,we&&_e!==void 0&&(we.idx=_e);try{return runUserJsAndGetRaw(r,L,l)}finally{l.vars=ve,we&&Se!==void 0&&(we.idx=Se)}}return runUserJsAndGetRaw(r,L,l)},l.pendingImageDownloads.push(U)}else{const S=await runUserJsAndGetRaw(r,L,l);if(S!=null)try{me(l,S)}catch(ee){throw isError(ee)?new ImageError(ee,I):ee}}}else if(D==="LINK"){if(!f$1(l)){const S=await runUserJsAndGetRaw(r,L,l);S!=null&&await ue(l,S)}}else if(D==="HTML"){if(!f$1(l)){const S=await runUserJsAndGetRaw(r,L,l);S!=null&&await ce(l,S)}}else throw new CommandSyntaxError(I);return}catch(S){if(!isError(S))throw S;return l.options.errorHandler!=null?l.options.errorHandler(S,L):S}},ae$1=BUILT_IN_COMMANDS.map(r=>new RegExp(`^${r}\\b`)),le=r=>!ae$1.some(g=>g.test(r.toUpperCase()));function getCommand(r,g,l){let v=r.trim();if(v[0]==="*"){const I=v.slice(1).trim();if(!g[I])throw new InvalidCommandError("Unknown alias",v);v=g[I]}else v[0]==="="?v=`INS ${v.slice(1).trim()}`:v[0]==="!"?v=`EXEC ${v.slice(1).trim()}`:le(v)&&(v=`INS ${v.trim()}`);return l&&(v=v.replace(/[\u201C\u201D\u201E]/g,'"').replace(/[\u2018\u2019\u201A]/g,"'")),v.trim()}function splitCommand(r){const g=/^(\S+)\s*/.exec(r);let l,v="";return g!=null&&(l=g[1].toUpperCase(),v=r.slice(l.length).trim()),{cmdName:l,cmdRest:v}}const de=async(r,g,l,v,I,D)=>{const L=I==="IF";let S=null,ee;if(L)g._ifName||(g._ifName=`__if_${l.gCntIf}`,l.gCntIf+=1),ee=g._ifName;else{if(S=/^(\S+)\s+IN\s+(.+)/i.exec(D),!S)throw new InvalidCommandError("Invalid FOR command",v);ee=S[1]}const U=s(l);if(!(U&&U.varName===ee)){if(L&&!l.options.allowNestedIf){const ve=H(g),we=ve!=null?ve._fTextNode?null:ve._tag:null;if(ve!=null){if(we==="w:p"){if(l.pIfCheckMap.has(ve)&&l.pIfCheckMap.get(ve)!==v)throw new InvalidCommandError("Invalid IF command nested into another IF command on the same line",v);l.pIfCheckMap.set(ve,v)}else if(we==="w:tr"){if(l.trIfCheckMap.has(ve)&&l.trIfCheckMap.get(ve)!==v)throw new InvalidCommandError("Invalid IF command nested into another IF command on the same table row",v);l.trIfCheckMap.set(ve,v)}}}const Y=l.loops.length-1,$e=Y>=0&&l.loops[Y].idx===-1;let _e;if($e)_e=[];else if(L)_e=await runUserJsAndGetRaw(r,D,l)?[1]:[];else{if(!S)throw new InvalidCommandError("Invalid FOR command",v);if(_e=await runUserJsAndGetRaw(r,S[2],l),!Array.isArray(_e))throw new InvalidCommandError("Invalid FOR command (can only iterate over Array)",v)}l.loops.push({refNode:g,refNodeLevel:l.level,varName:ee,loopOver:_e,isIf:L,idx:-1,isTableCellLoop:!L&&ie$1(g)})}h$1(l.loops)},fe=(r,g,l,v,I)=>{const D=v==="END-IF",L=s(g);if(!L)throw new InvalidCommandError(`Unexpected ${v} outside of ${D?"IF statement":"FOR loop"} context`,l);const S=H(r),ee=S!=null?S._fTextNode?null:S._tag:null;ee==="w:p"?g.pIfCheckMap.delete(S):ee==="w:tr"&&g.trIfCheckMap.delete(S),D&&!r._ifName&&(r._ifName=L.varName,g.gCntEndIf+=1);const U=D?r._ifName:I;if(L.varName!==U){if(g.loops.find(_e=>_e.varName===U)==null){logger.debug(`Ignoring ${l} (${U}, but we're expecting ${L.varName})`);return}throw new InvalidCommandError("Invalid command",l)}const Y=L.idx+1,$e=L.loopOver[Y];$e!=null?(g.vars[U]=$e,g.fJump=!0,L.idx=Y):(L.isTableCellLoop&&(g.tableCellLoopJustEnded=!0),g.loops.pop())},Q=(r,g)=>{E(g),r.imageAndShapeIdIncrement+=1;const l=`img${String(r.imageAndShapeIdIncrement)}`;return r.images[l]=g,l};function E(r){if(!(r.data instanceof Uint8Array||r.data instanceof ArrayBuffer||typeof r.data=="string"))throw new Error("image .data property needs to be provided as Uint8Array (e.g. Buffer), ArrayBuffer, or as a base64-encoded string");if(!ImageExtensions.includes(r.extension))throw new Error(`An extension (one of ${ImageExtensions}) needs to be provided when providing an image or a thumbnail.`)}function j(r){if(!Number.isFinite(r.width))throw new Error(`invalid image width: ${r.width} (in cm)`);if(!Number.isFinite(r.height))throw new Error(`invalid image height: ${r.height} (in cm)`);E(r),r.thumbnail&&E(r.thumbnail)}const pe=(r,g,l,v)=>{const I=c$1,D=I("wp:extent",{cx:"0",cy:"0"}),L=I("a:ext",{cx:"0",cy:"0"}),S=I("a:xfrm",{},[I("a:off",{x:"0",y:"0"}),L]),ee=I("wp:docPr",{id:l,name:`Picture ${l}`,descr:""}),U=I("pic:cNvPr",{id:"0",name:`Picture ${l}`,descr:""}),Y=I("a:extLst",{},[I("a:ext",{uri:"{28A0092B-C50C-407E-A947-70E740481C1C}"},[I("a14:useLocalDpi",{"xmlns:a14":"http://schemas.microsoft.com/office/drawing/2010/main",val:"0"})])]),$e=I("a:blip",{"r:embed":g,cstate:"print"},[Y]),_e=I("pic:pic",{"xmlns:pic":"http://schemas.openxmlformats.org/drawingml/2006/picture"},[I("pic:nvPicPr",{},[U,I("pic:cNvPicPr",{},[I("a:picLocks",{noChangeAspect:"1",noChangeArrowheads:"1"})])]),I("pic:blipFill",{},[$e,I("a:srcRect"),I("a:stretch",{},[I("a:fillRect")])]),I("pic:spPr",{bwMode:"auto"},[S,I("a:prstGeom",{prst:"rect"},[I("a:avLst")]),I("a:noFill"),I("a:ln",{},[I("a:noFill")])])]),ve=I("w:drawing",{},[I("wp:inline",{distT:"0",distB:"0",distL:"0",distR:"0"},[D,ee,I("wp:cNvGraphicFramePr",{},[I("a:graphicFrameLocks",{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main",noChangeAspect:"1"})]),I("a:graphic",{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},[I("a:graphicData",{uri:"http://schemas.openxmlformats.org/drawingml/2006/picture"},[_e])])])]);return r.pendingImageNode={image:ve},{id:g,fetchImage:()=>Promise.resolve(void 0),cmd:v,extentNode:D,picExtNode:L,xfrmNode:S,blipNode:$e,extLstNode:Y,docPrNode:ee,cNvPrNode:U,drawingNode:ve}};async function resolvePendingImages(r,g=re$1){var l;const v=r.pendingImageDownloads;if(v.length===0)return;logger.debug(`Resolving ${v.length} pending image downloads with concurrency limit of ${g}...`);const I=pLimit_1(g),D=await Promise.allSettled(v.map(L=>I(()=>L.fetchImage())));for(let L=0;L<D.length;L++){const S=D[L],ee=v[L];if(S.status==="rejected"){const Y=S.reason;if(r.options.errorHandler!=null)await r.options.errorHandler(Y instanceof Error?Y:new Error(String(Y)),ee.cmd);else if(r.options.failFast)throw new ImageError(Y instanceof Error?Y:new Error(String(Y)),ee.cmd);continue}const U=S.value;if(U!=null)try{j(U);const Y=(U.width*36e4).toFixed(0),$e=(U.height*36e4).toFixed(0);if(ee.extentNode&&(ee.extentNode._attrs.cx=Y,ee.extentNode._attrs.cy=$e),ee.picExtNode&&(ee.picExtNode._attrs.cx=Y,ee.picExtNode._attrs.cy=$e),U.rotation&&ee.xfrmNode){const we=(U.rotation*6e4).toString();ee.xfrmNode._attrs.rot=we}const _e=U.alt||"";ee.docPrNode&&(ee.docPrNode._attrs.descr=_e),ee.cNvPrNode&&(ee.cNvPrNode._attrs.descr=_e);const ve=A(U);if(E(ve),ve.extension===".svg"){const we=(l=U.thumbnail)!=null?l:{data:"bm90aGluZwo=",extension:".png"};r.images[ee.id]=ve,r.imageAndShapeIdIncrement+=1;const Se=`img${String(r.imageAndShapeIdIncrement)}`;if(E(we),r.images[Se]=we,ee.extLstNode){const Ie=c$1("asvg:svgBlip",{"xmlns:asvg":"http://schemas.microsoft.com/office/drawing/2016/SVG/main","r:embed":ee.id}),Ne=c$1("a:ext",{uri:"{96DAC541-7B7A-43D3-8B79-37D633B846F1}"},[Ie]);Ne._parent=ee.extLstNode,Ie._parent=Ne,ee.extLstNode._children.push(Ne)}ee.blipNode&&(ee.blipNode._attrs["r:embed"]=Se)}else r.images[ee.id]=ve;if(U.caption&&ee.captionParent){const we=c$1("w:br",{}),Se=u(U.caption),Ie=c$1("w:t",{},[Se]);we._parent=ee.captionParent,Ie._parent=ee.captionParent,Se._parent=Ie,ee.captionParent._children.push(we),ee.captionParent._children.push(Ie)}}catch(Y){if(!isError(Y))throw Y;if(r.options.errorHandler!=null)await r.options.errorHandler(Y,ee.cmd);else if(r.options.failFast)throw new ImageError(Y,ee.cmd)}}r.pendingImageDownloads=[]}function A(r){const{data:g,extension:l}=r;if(!l)throw new Error("If you return image `data`, make sure you return an extension as well!");return{extension:l,data:g}}const me=(r,g,l)=>{var v;j(g);const I=(g.width*36e4).toFixed(0),D=(g.height*36e4).toFixed(0);let L,S;if(l){L=l,S=l.replace("img","");const we=A(g);E(we),r.images[L]=we}else L=Q(r,A(g)),S=String(r.imageAndShapeIdIncrement);const ee=g.alt||"",U=c$1,Y=[];Y.push(U("a:ext",{uri:"{28A0092B-C50C-407E-A947-70E740481C1C}"},[U("a14:useLocalDpi",{"xmlns:a14":"http://schemas.microsoft.com/office/drawing/2010/main",val:"0"})]));const $e=g.rotation?(g.rotation*6e4).toString():void 0;if(r.images[L].extension===".svg"){const we=(v=g.thumbnail)!=null?v:{data:"bm90aGluZwo=",extension:".png"},Se=Q(r,we);Y.push(U("a:ext",{uri:"{96DAC541-7B7A-43D3-8B79-37D633B846F1}"},[U("asvg:svgBlip",{"xmlns:asvg":"http://schemas.microsoft.com/office/drawing/2016/SVG/main","r:embed":L})])),L=Se}const _e=U("pic:pic",{"xmlns:pic":"http://schemas.openxmlformats.org/drawingml/2006/picture"},[U("pic:nvPicPr",{},[U("pic:cNvPr",{id:"0",name:`Picture ${S}`,descr:ee}),U("pic:cNvPicPr",{},[U("a:picLocks",{noChangeAspect:"1",noChangeArrowheads:"1"})])]),U("pic:blipFill",{},[U("a:blip",{"r:embed":L,cstate:"print"},[U("a:extLst",{},Y)]),U("a:srcRect"),U("a:stretch",{},[U("a:fillRect")])]),U("pic:spPr",{bwMode:"auto"},[U("a:xfrm",$e?{rot:$e}:{},[U("a:off",{x:"0",y:"0"}),U("a:ext",{cx:I,cy:D})]),U("a:prstGeom",{prst:"rect"},[U("a:avLst")]),U("a:noFill"),U("a:ln",{},[U("a:noFill")])])]),ve=U("w:drawing",{},[U("wp:inline",{distT:"0",distB:"0",distL:"0",distR:"0"},[U("wp:extent",{cx:I,cy:D}),U("wp:docPr",{id:S,name:`Picture ${S}`,descr:ee}),U("wp:cNvGraphicFramePr",{},[U("a:graphicFrameLocks",{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main",noChangeAspect:"1"})]),U("a:graphic",{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},[U("a:graphicData",{uri:"http://schemas.openxmlformats.org/drawingml/2006/picture"},[_e])])])]);r.pendingImageNode={image:ve},g.caption&&(r.pendingImageNode.caption=[U("w:br"),U("w:t",{},[u(g.caption)])])},ue=async(r,g)=>{const{url:l,label:v=l}=g;r.linkId+=1;const I=`link${String(r.linkId)}`;r.links[I]={url:l};const D=c$1,{textRunPropsNode:L}=r,S=D("w:hyperlink",{"r:id":I,"w:history":"1"},[D("w:r",{},[L||D("w:rPr",{},[D("w:u",{"w:val":"single"})]),D("w:t",{},[u(v)])])]);r.pendingLinkNode=S},ce=async(r,g)=>{r.htmlId+=1;const l=`html${String(r.htmlId)}`;r.htmls[l]=g;const v=c$1("w:altChunk",{"r:id":l});r.pendingHtmlNode=v},ge=["w:p","w:tr","w:tc"],R=(r,g,l)=>{if(g.fSeekQuery)return;const{fCmd:v,fInsertedText:I}=l,D=v?"cmds":"text";ge.forEach(L=>{const S=g.buffers[L];S[D]+=r,I&&(S.fInsertedText=!0)})};function he$1(r,g){g.imageAndShapeIdIncrement+=1;const l=String(g.imageAndShapeIdIncrement);r._attrs=M(k({},r._attrs),{id:`${l}`})}const ne="+++",X="||",J="[Content_Types].xml",f="word",he=new RegExp(`${f}\\/[^\\/]+\\.xml`);async function parseTemplate(r){const g=await t(r),l=await readContentTypes(g),v=getMainDoc(l),I=`${f}/${v}`,D=await s$1(g,I);if(D==null)throw new TemplateParseError(`${v} could not be found`);logger.debug(`${I} file length: ${D.length}`),new Date().getTime();const L=await _$2(D);return new Date().getTime(),{jsTemplate:L,mainDocument:v,zip:g,contentTypes:l}}async function re(r,g,l){const v=[];r.forEach(async D=>{he.test(D)&&D!==`${f}/${g}`&&D.indexOf(`${f}/template`)!==0&&v.push(D)}),v.sort();const I=[];for(const D of v){const L=await s$1(r,D);if(L==null)throw new TemplateParseError(`${D} could not be read`);logger.debug(`${D} file length: ${L.length}`);const S=await _$2(L),ee=p(S,l.cmdDelimiter,l.preserveSpace);I.push([ee,D])}return I}async function ye(r,g){var l,v,I,D,L;const{template:S,data:ee,queryVars:U}=r,Y=r.literalXmlDelimiter||X,$e={cmdDelimiter:ie(r.cmdDelimiter),literalXmlDelimiter:Y,processLineBreaks:r.processLineBreaks!=null?r.processLineBreaks:!0,noSandbox:r.noSandbox||!1,runJs:r.runJs,additionalJsContext:r.additionalJsContext||{},failFast:r.failFast==null?!0:r.failFast,rejectNullish:r.rejectNullish==null?!1:r.rejectNullish,errorHandler:typeof r.errorHandler=="function"?r.errorHandler:null,fixSmartQuotes:r.fixSmartQuotes==null?!1:r.fixSmartQuotes,processLineBreaksAsNewText:r.processLineBreaksAsNewText==null?!1:r.processLineBreaksAsNewText,maximumWalkingDepth:r.maximumWalkingDepth,indentXml:(l=r.indentXml)!=null?l:!0,preserveSpace:(v=r.preserveSpace)!=null?v:!0,compressionLevel:(I=r.compressionLevel)!=null?I:1,allowNestedIf:(D=r.allowNestedIf)!=null?D:!1,imageConcurrency:(L=r.imageConcurrency)!=null?L:10},_e={literalXmlDelimiter:Y,indentXml:$e.indentXml},{jsTemplate:ve,mainDocument:we,zip:Se,contentTypes:Ie}=await parseTemplate(S),Ne=p(ve,$e.cmdDelimiter,$e.preserveSpace);let Ce=null;if(typeof ee=="function"){const Ye=await extractQuery(Ne,$e);Ce=await ee(Ye,U)}else Ce=ee;const Be=await re(Se,we,$e),Re=Math.max(...Be.map(([Ye,it])=>findHighestImgId(Ye)),findHighestImgId(Ne));let Oe=newContext($e,Re);const Ue=await produceJsReport(Ce,Ne,Oe);if(Ue.status==="errors")throw Ue.errors;$e.imageConcurrency!=null&&await resolvePendingImages(Oe,$e.imageConcurrency);const{report:Le,images:Me,links:xe,htmls:He}=Ue;if(g==="JS")return Le;const Fe=m$1(Le,_e);if(g==="XML")return Fe.toString("utf-8");o(Se,`${f}/${we}`,Fe);let Pe=Object.keys(Me).length,rt=Object.keys(He).length;await se(Me,we,Se,$e.indentXml),await oe(xe,we,Se,$e.indentXml),await ae(He,we,Se,$e.indentXml);for(const[Ye,it]of Be){Oe=newContext($e,Oe.imageAndShapeIdIncrement);const nt=await produceJsReport(Ce,Ye,Oe);if(nt.status==="errors")throw nt.errors;$e.imageConcurrency!=null&&await resolvePendingImages(Oe,$e.imageConcurrency);const{report:Ze,images:at,links:ft,htmls:ut}=nt,We=m$1(Ze,_e);o(Se,it,We),Pe+=Object.keys(at).length,rt+=Object.keys(ut).length;const Qe=it.split("/"),_t=Qe[Qe.length-1];await se(at,_t,Se,$e.indentXml),await oe(ft,we,Se,$e.indentXml),await ae(ut,we,Se,$e.indentXml)}if(Pe||rt){const Ye=(nt,Ze)=>{Ie._children.filter(at=>{var ft;return!at._fTextNode&&((ft=at._attrs.Extension)==null?void 0:ft.toLowerCase())===(nt==null?void 0:nt.toLowerCase())}).length||p$1(Ie,c$1("Default",{Extension:nt,ContentType:Ze}))};Pe&&(Ye("png","image/png"),Ye("jpg","image/jpeg"),Ye("jpeg","image/jpeg"),Ye("gif","image/gif"),Ye("bmp","image/bmp"),Ye("svg","image/svg+xml")),rt&&Ye("html","text/html");const it=m$1(Ie,_e);o(Se,J,it)}return await p$2(Se,$e.compressionLevel)}async function listCommands(r,g){const l={cmdDelimiter:ie(g),literalXmlDelimiter:X,processLineBreaks:!0,noSandbox:!1,additionalJsContext:{},failFast:!1,rejectNullish:!1,errorHandler:null,fixSmartQuotes:!1,processLineBreaksAsNewText:!1,indentXml:!0,preserveSpace:!0,compressionLevel:1,allowNestedIf:!1,imageConcurrency:10},{jsTemplate:v,mainDocument:I,zip:D}=await parseTemplate(r),L=await re(D,I,l),S=[v,...L.map(([U,Y])=>U)],ee=[];for(const U of S){const Y=p(U,l.cmdDelimiter,l.preserveSpace),$e=newContext(l);await walkTemplate(void 0,Y,$e,async(_e,ve,we)=>{const Se=getCommand(we.cmd,we.shorthands,we.options.fixSmartQuotes);we.cmd="";const{cmdName:Ie,cmdRest:Ne}=splitCommand(Se),Ce=Ie;Ce!=null&&Ce!=="CMD_NODE"&&ee.push({raw:Se,type:Ce,code:Ne})})}return ee}async function getMetadata(r){const g="docProps/app.xml",l="docProps/core.xml",v=await t(r),I=await B(v,g),D=await B(v,l);function L(U){if(U._children.length===0)return;const Y=U._children[0];if(Y._fTextNode)return Y._text;throw new Error("Not a text node")}function S(U,Y){for(const $e of U._children)if(!$e._fTextNode&&$e._tag===Y)return L($e)}const ee=U=>{const Y=Number(U);if(Number.isFinite(Y))return Y};return{pages:ee(S(I,"Pages")),words:ee(S(I,"Words")),characters:ee(S(I,"Characters")),lines:ee(S(I,"Lines")),paragraphs:ee(S(I,"Paragraphs")),company:S(I,"Company"),template:S(I,"Template"),title:S(D,"dc:title"),subject:S(D,"dc:subject"),creator:S(D,"dc:creator"),description:S(D,"dc:description"),lastModifiedBy:S(D,"cp:lastModifiedBy"),revision:S(D,"cp:revision"),lastPrinted:S(D,"cp:lastPrinted"),created:S(D,"dcterms:created"),modified:S(D,"dcterms:modified"),category:S(D,"cp:category")}}async function B(r,g){const l=await s$1(r,g);if(l==null)throw new TemplateParseError(`${g} could not be read`);const v=await _$2(l);if(v._fTextNode)throw new TemplateParseError(`${g} is a text node when parsed`);return v}async function readContentTypes(r){return await B(r,J)}function getMainDoc(r){const g=["application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","application/vnd.ms-word.document.macroEnabled.main+xml"];for(const l of r._children)if(!l._fTextNode&&l._attrs.ContentType!=null&&g.includes(l._attrs.ContentType)){const v=l._attrs.PartName;if(v)return v.replace("/word/","")}throw new TemplateParseError(`Could not find main document (e.g. document.xml) in ${J}`)}const se=async(r,g,l,v)=>{const I=Object.keys(r);if(!I.length)return;const D=`${f}/_rels/${g}.rels`,L=await F(l,D);for(const ee of I){const{extension:U,data:Y}=r[ee],$e=`template_${g}_${ee}${U}`,_e=`${f}/media/${$e}`;typeof Y=="string"?l.file(_e,Y,{base64:!0}):l.file(_e,Y,{binary:!0}),p$1(L,c$1("Relationship",{Id:ee,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`media/${$e}`})),delete r[ee]}const S=m$1(L,{literalXmlDelimiter:X,indentXml:v});o(l,D,S)},oe=async(r,g,l,v)=>{const I=Object.keys(r);if(I.length){const D=`${f}/_rels/${g}.rels`,L=await F(l,D);for(const ee of I){const{url:U}=r[ee];p$1(L,c$1("Relationship",{Id:ee,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Target:U,TargetMode:"External"}))}const S=m$1(L,{literalXmlDelimiter:X,indentXml:v});o(l,D,S)}},ae=async(r,g,l,v)=>{const I=Object.keys(r);if(I.length){const D=`${f}/_rels/${g}.rels`,L=await F(l,D);for(const ee of I){const U=r[ee],Y=`template_${g.replace(/\./g,"_")}_${ee}.html`,$e=`${f}/${Y}`;o(l,$e,Buffer.from(U)),p$1(L,c$1("Relationship",{Id:ee,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk",Target:`${Y}`}))}const S=m$1(L,{literalXmlDelimiter:X,indentXml:v});o(l,D,S)}},F=async(r,g)=>{let l=await s$1(r,g);return l||(l=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
        <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
        </Relationships>`),_$2(l)},ie=r=>r?typeof r=="string"?[r,r]:r:[ne,ne];export{CommandExecutionError,CommandSyntaxError,ImageError,IncompleteConditionalStatementError,InternalError,InvalidCommandError,NullishCommandResultError,ObjectCommandResultError,TemplateParseError,UnterminatedForLoopError,ye as createReport,getMetadata,isError,listCommands};
//# sourceMappingURL=browser.js.map
