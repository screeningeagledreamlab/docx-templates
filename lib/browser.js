var commonjsGlobal=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},buffer$1={},base64Js={};base64Js.byteLength=byteLength,base64Js.toByteArray=toByteArray,base64Js.fromByteArray=fromByteArray;for(var lookup=[],revLookup=[],Arr=typeof Uint8Array!="undefined"?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i$2=0,len=code.length;i$2<len;++i$2)lookup[i$2]=code[i$2],revLookup[code.charCodeAt(i$2)]=i$2;revLookup[45]=62,revLookup[95]=63;function getLens(r){var g=r.length;if(g%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var l=r.indexOf("=");l===-1&&(l=g);var v=l===g?0:4-l%4;return[l,v]}function byteLength(r){var g=getLens(r),l=g[0],v=g[1];return(l+v)*3/4-v}function _byteLength(r,g,l){return(g+l)*3/4-l}function toByteArray(r){var g,l=getLens(r),v=l[0],I=l[1],k=new Arr(_byteLength(r,v,I)),O=0,S=I>0?v-4:v,Y;for(Y=0;Y<S;Y+=4)g=revLookup[r.charCodeAt(Y)]<<18|revLookup[r.charCodeAt(Y+1)]<<12|revLookup[r.charCodeAt(Y+2)]<<6|revLookup[r.charCodeAt(Y+3)],k[O++]=g>>16&255,k[O++]=g>>8&255,k[O++]=g&255;return I===2&&(g=revLookup[r.charCodeAt(Y)]<<2|revLookup[r.charCodeAt(Y+1)]>>4,k[O++]=g&255),I===1&&(g=revLookup[r.charCodeAt(Y)]<<10|revLookup[r.charCodeAt(Y+1)]<<4|revLookup[r.charCodeAt(Y+2)]>>2,k[O++]=g>>8&255,k[O++]=g&255),k}function tripletToBase64(r){return lookup[r>>18&63]+lookup[r>>12&63]+lookup[r>>6&63]+lookup[r&63]}function encodeChunk(r,g,l){for(var v,I=[],k=g;k<l;k+=3)v=(r[k]<<16&16711680)+(r[k+1]<<8&65280)+(r[k+2]&255),I.push(tripletToBase64(v));return I.join("")}function fromByteArray(r){for(var g,l=r.length,v=l%3,I=[],k=16383,O=0,S=l-v;O<S;O+=k)I.push(encodeChunk(r,O,O+k>S?S:O+k));return v===1?(g=r[l-1],I.push(lookup[g>>2]+lookup[g<<4&63]+"==")):v===2&&(g=(r[l-2]<<8)+r[l-1],I.push(lookup[g>>10]+lookup[g>>4&63]+lookup[g<<2&63]+"=")),I.join("")}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ieee754.read=function(r,g,l,v,I){var k,O,S=I*8-v-1,Y=(1<<S)-1,L=Y>>1,z=-7,Te=l?I-1:0,te=l?-1:1,ge=r[g+Te];for(Te+=te,k=ge&(1<<-z)-1,ge>>=-z,z+=S;z>0;k=k*256+r[g+Te],Te+=te,z-=8);for(O=k&(1<<-z)-1,k>>=-z,z+=v;z>0;O=O*256+r[g+Te],Te+=te,z-=8);if(k===0)k=1-L;else{if(k===Y)return O?NaN:(ge?-1:1)*(1/0);O=O+Math.pow(2,v),k=k-L}return(ge?-1:1)*O*Math.pow(2,k-v)},ieee754.write=function(r,g,l,v,I,k){var O,S,Y,L=k*8-I-1,z=(1<<L)-1,Te=z>>1,te=I===23?Math.pow(2,-24)-Math.pow(2,-77):0,ge=v?0:k-1,Ee=v?1:-1,be=g<0||g===0&&1/g<0?1:0;for(g=Math.abs(g),isNaN(g)||g===1/0?(S=isNaN(g)?1:0,O=z):(O=Math.floor(Math.log(g)/Math.LN2),g*(Y=Math.pow(2,-O))<1&&(O--,Y*=2),O+Te>=1?g+=te/Y:g+=te*Math.pow(2,1-Te),g*Y>=2&&(O++,Y/=2),O+Te>=z?(S=0,O=z):O+Te>=1?(S=(g*Y-1)*Math.pow(2,I),O=O+Te):(S=g*Math.pow(2,Te-1)*Math.pow(2,I),O=0));I>=8;r[l+ge]=S&255,ge+=Ee,S/=256,I-=8);for(O=O<<I|S,L+=I;L>0;r[l+ge]=O&255,ge+=Ee,O/=256,L-=8);r[l+ge-Ee]|=be*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(r){const g=base64Js,l=ieee754,v=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=S,r.SlowBuffer=Ie,r.INSPECT_MAX_BYTES=50;const I=2147483647;r.kMaxLength=I,S.TYPED_ARRAY_SUPPORT=k(),!S.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function k(){try{const Z=new Uint8Array(1),y={foo:function(){return 42}};return Object.setPrototypeOf(y,Uint8Array.prototype),Object.setPrototypeOf(Z,y),Z.foo()===42}catch(Z){return!1}}Object.defineProperty(S.prototype,"parent",{enumerable:!0,get:function(){if(S.isBuffer(this))return this.buffer}}),Object.defineProperty(S.prototype,"offset",{enumerable:!0,get:function(){if(S.isBuffer(this))return this.byteOffset}});function O(Z){if(Z>I)throw new RangeError('The value "'+Z+'" is invalid for option "size"');const y=new Uint8Array(Z);return Object.setPrototypeOf(y,S.prototype),y}function S(Z,y,D){if(typeof Z=="number"){if(typeof y=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Te(Z)}return Y(Z,y,D)}S.poolSize=8192;function Y(Z,y,D){if(typeof Z=="string")return te(Z,y);if(ArrayBuffer.isView(Z))return Ee(Z);if(Z==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Z);if(at(Z,ArrayBuffer)||Z&&at(Z.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(at(Z,SharedArrayBuffer)||Z&&at(Z.buffer,SharedArrayBuffer)))return be(Z,y,D);if(typeof Z=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const _e=Z.valueOf&&Z.valueOf();if(_e!=null&&_e!==Z)return S.from(_e,y,D);const we=Se(Z);if(we)return we;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof Z[Symbol.toPrimitive]=="function")return S.from(Z[Symbol.toPrimitive]("string"),y,D);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Z)}S.from=function(Z,y,D){return Y(Z,y,D)},Object.setPrototypeOf(S.prototype,Uint8Array.prototype),Object.setPrototypeOf(S,Uint8Array);function L(Z){if(typeof Z!="number")throw new TypeError('"size" argument must be of type number');if(Z<0)throw new RangeError('The value "'+Z+'" is invalid for option "size"')}function z(Z,y,D){return L(Z),Z<=0?O(Z):y!==void 0?typeof D=="string"?O(Z).fill(y,D):O(Z).fill(y):O(Z)}S.alloc=function(Z,y,D){return z(Z,y,D)};function Te(Z){return L(Z),O(Z<0?0:Ae(Z)|0)}S.allocUnsafe=function(Z){return Te(Z)},S.allocUnsafeSlow=function(Z){return Te(Z)};function te(Z,y){if((typeof y!="string"||y==="")&&(y="utf8"),!S.isEncoding(y))throw new TypeError("Unknown encoding: "+y);const D=Re(Z,y)|0;let _e=O(D);const we=_e.write(Z,y);return we!==D&&(_e=_e.slice(0,we)),_e}function ge(Z){const y=Z.length<0?0:Ae(Z.length)|0,D=O(y);for(let _e=0;_e<y;_e+=1)D[_e]=Z[_e]&255;return D}function Ee(Z){if(at(Z,Uint8Array)){const y=new Uint8Array(Z);return be(y.buffer,y.byteOffset,y.byteLength)}return ge(Z)}function be(Z,y,D){if(y<0||Z.byteLength<y)throw new RangeError('"offset" is outside of buffer bounds');if(Z.byteLength<y+(D||0))throw new RangeError('"length" is outside of buffer bounds');let _e;return y===void 0&&D===void 0?_e=new Uint8Array(Z):D===void 0?_e=new Uint8Array(Z,y):_e=new Uint8Array(Z,y,D),Object.setPrototypeOf(_e,S.prototype),_e}function Se(Z){if(S.isBuffer(Z)){const y=Ae(Z.length)|0,D=O(y);return D.length===0||Z.copy(D,0,0,y),D}if(Z.length!==void 0)return typeof Z.length!="number"||Et(Z.length)?O(0):ge(Z);if(Z.type==="Buffer"&&Array.isArray(Z.data))return ge(Z.data)}function Ae(Z){if(Z>=I)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+I.toString(16)+" bytes");return Z|0}function Ie(Z){return+Z!=Z&&(Z=0),S.alloc(+Z)}S.isBuffer=function(y){return y!=null&&y._isBuffer===!0&&y!==S.prototype},S.compare=function(y,D){if(at(y,Uint8Array)&&(y=S.from(y,y.offset,y.byteLength)),at(D,Uint8Array)&&(D=S.from(D,D.offset,D.byteLength)),!S.isBuffer(y)||!S.isBuffer(D))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(y===D)return 0;let _e=y.length,we=D.length;for(let $e=0,Ne=Math.min(_e,we);$e<Ne;++$e)if(y[$e]!==D[$e]){_e=y[$e],we=D[$e];break}return _e<we?-1:we<_e?1:0},S.isEncoding=function(y){switch(String(y).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},S.concat=function(y,D){if(!Array.isArray(y))throw new TypeError('"list" argument must be an Array of Buffers');if(y.length===0)return S.alloc(0);let _e;if(D===void 0)for(D=0,_e=0;_e<y.length;++_e)D+=y[_e].length;const we=S.allocUnsafe(D);let $e=0;for(_e=0;_e<y.length;++_e){let Ne=y[_e];if(at(Ne,Uint8Array))$e+Ne.length>we.length?(S.isBuffer(Ne)||(Ne=S.from(Ne)),Ne.copy(we,$e)):Uint8Array.prototype.set.call(we,Ne,$e);else if(S.isBuffer(Ne))Ne.copy(we,$e);else throw new TypeError('"list" argument must be an Array of Buffers');$e+=Ne.length}return we};function Re(Z,y){if(S.isBuffer(Z))return Z.length;if(ArrayBuffer.isView(Z)||at(Z,ArrayBuffer))return Z.byteLength;if(typeof Z!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Z);const D=Z.length,_e=arguments.length>2&&arguments[2]===!0;if(!_e&&D===0)return 0;let we=!1;for(;;)switch(y){case"ascii":case"latin1":case"binary":return D;case"utf8":case"utf-8":return Je(Z).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D*2;case"hex":return D>>>1;case"base64":return pt(Z).length;default:if(we)return _e?-1:Je(Z).length;y=(""+y).toLowerCase(),we=!0}}S.byteLength=Re;function ke(Z,y,D){let _e=!1;if((y===void 0||y<0)&&(y=0),y>this.length||((D===void 0||D>this.length)&&(D=this.length),D<=0)||(D>>>=0,y>>>=0,D<=y))return"";for(Z||(Z="utf8");;)switch(Z){case"hex":return st(this,y,D);case"utf8":case"utf-8":return Ge(this,y,D);case"ascii":return Ue(this,y,D);case"latin1":case"binary":return it(this,y,D);case"base64":return et(this,y,D);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return lt(this,y,D);default:if(_e)throw new TypeError("Unknown encoding: "+Z);Z=(Z+"").toLowerCase(),_e=!0}}S.prototype._isBuffer=!0;function De(Z,y,D){const _e=Z[y];Z[y]=Z[D],Z[D]=_e}S.prototype.swap16=function(){const y=this.length;if(y%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let D=0;D<y;D+=2)De(this,D,D+1);return this},S.prototype.swap32=function(){const y=this.length;if(y%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let D=0;D<y;D+=4)De(this,D,D+3),De(this,D+1,D+2);return this},S.prototype.swap64=function(){const y=this.length;if(y%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let D=0;D<y;D+=8)De(this,D,D+7),De(this,D+1,D+6),De(this,D+2,D+5),De(this,D+3,D+4);return this},S.prototype.toString=function(){const y=this.length;return y===0?"":arguments.length===0?Ge(this,0,y):ke.apply(this,arguments)},S.prototype.toLocaleString=S.prototype.toString,S.prototype.equals=function(y){if(!S.isBuffer(y))throw new TypeError("Argument must be a Buffer");return this===y?!0:S.compare(this,y)===0},S.prototype.inspect=function(){let y="";const D=r.INSPECT_MAX_BYTES;return y=this.toString("hex",0,D).replace(/(.{2})/g,"$1 ").trim(),this.length>D&&(y+=" ... "),"<Buffer "+y+">"},v&&(S.prototype[v]=S.prototype.inspect),S.prototype.compare=function(y,D,_e,we,$e){if(at(y,Uint8Array)&&(y=S.from(y,y.offset,y.byteLength)),!S.isBuffer(y))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof y);if(D===void 0&&(D=0),_e===void 0&&(_e=y?y.length:0),we===void 0&&(we=0),$e===void 0&&($e=this.length),D<0||_e>y.length||we<0||$e>this.length)throw new RangeError("out of range index");if(we>=$e&&D>=_e)return 0;if(we>=$e)return-1;if(D>=_e)return 1;if(D>>>=0,_e>>>=0,we>>>=0,$e>>>=0,this===y)return 0;let Ne=$e-we,Pe=_e-D;const Ke=Math.min(Ne,Pe),Xe=this.slice(we,$e),Ve=y.slice(D,_e);for(let je=0;je<Ke;++je)if(Xe[je]!==Ve[je]){Ne=Xe[je],Pe=Ve[je];break}return Ne<Pe?-1:Pe<Ne?1:0};function Le(Z,y,D,_e,we){if(Z.length===0)return-1;if(typeof D=="string"?(_e=D,D=0):D>2147483647?D=2147483647:D<-2147483648&&(D=-2147483648),D=+D,Et(D)&&(D=we?0:Z.length-1),D<0&&(D=Z.length+D),D>=Z.length){if(we)return-1;D=Z.length-1}else if(D<0)if(we)D=0;else return-1;if(typeof y=="string"&&(y=S.from(y,_e)),S.isBuffer(y))return y.length===0?-1:Be(Z,y,D,_e,we);if(typeof y=="number")return y=y&255,typeof Uint8Array.prototype.indexOf=="function"?we?Uint8Array.prototype.indexOf.call(Z,y,D):Uint8Array.prototype.lastIndexOf.call(Z,y,D):Be(Z,[y],D,_e,we);throw new TypeError("val must be string, number or Buffer")}function Be(Z,y,D,_e,we){let $e=1,Ne=Z.length,Pe=y.length;if(_e!==void 0&&(_e=String(_e).toLowerCase(),_e==="ucs2"||_e==="ucs-2"||_e==="utf16le"||_e==="utf-16le")){if(Z.length<2||y.length<2)return-1;$e=2,Ne/=2,Pe/=2,D/=2}function Ke(Ve,je){return $e===1?Ve[je]:Ve.readUInt16BE(je*$e)}let Xe;if(we){let Ve=-1;for(Xe=D;Xe<Ne;Xe++)if(Ke(Z,Xe)===Ke(y,Ve===-1?0:Xe-Ve)){if(Ve===-1&&(Ve=Xe),Xe-Ve+1===Pe)return Ve*$e}else Ve!==-1&&(Xe-=Xe-Ve),Ve=-1}else for(D+Pe>Ne&&(D=Ne-Pe),Xe=D;Xe>=0;Xe--){let Ve=!0;for(let je=0;je<Pe;je++)if(Ke(Z,Xe+je)!==Ke(y,je)){Ve=!1;break}if(Ve)return Xe}return-1}S.prototype.includes=function(y,D,_e){return this.indexOf(y,D,_e)!==-1},S.prototype.indexOf=function(y,D,_e){return Le(this,y,D,_e,!0)},S.prototype.lastIndexOf=function(y,D,_e){return Le(this,y,D,_e,!1)};function Fe(Z,y,D,_e){D=Number(D)||0;const we=Z.length-D;_e?(_e=Number(_e),_e>we&&(_e=we)):_e=we;const $e=y.length;_e>$e/2&&(_e=$e/2);let Ne;for(Ne=0;Ne<_e;++Ne){const Pe=parseInt(y.substr(Ne*2,2),16);if(Et(Pe))return Ne;Z[D+Ne]=Pe}return Ne}function ve(Z,y,D,_e){return ut(Je(y,Z.length-D),Z,D,_e)}function Ze(Z,y,D,_e){return ut(ot(y),Z,D,_e)}function Oe(Z,y,D,_e){return ut(pt(y),Z,D,_e)}function Me(Z,y,D,_e){return ut(gt(y,Z.length-D),Z,D,_e)}S.prototype.write=function(y,D,_e,we){if(D===void 0)we="utf8",_e=this.length,D=0;else if(_e===void 0&&typeof D=="string")we=D,_e=this.length,D=0;else if(isFinite(D))D=D>>>0,isFinite(_e)?(_e=_e>>>0,we===void 0&&(we="utf8")):(we=_e,_e=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const $e=this.length-D;if((_e===void 0||_e>$e)&&(_e=$e),y.length>0&&(_e<0||D<0)||D>this.length)throw new RangeError("Attempt to write outside buffer bounds");we||(we="utf8");let Ne=!1;for(;;)switch(we){case"hex":return Fe(this,y,D,_e);case"utf8":case"utf-8":return ve(this,y,D,_e);case"ascii":case"latin1":case"binary":return Ze(this,y,D,_e);case"base64":return Oe(this,y,D,_e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Me(this,y,D,_e);default:if(Ne)throw new TypeError("Unknown encoding: "+we);we=(""+we).toLowerCase(),Ne=!0}},S.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function et(Z,y,D){return y===0&&D===Z.length?g.fromByteArray(Z):g.fromByteArray(Z.slice(y,D))}function Ge(Z,y,D){D=Math.min(Z.length,D);const _e=[];let we=y;for(;we<D;){const $e=Z[we];let Ne=null,Pe=$e>239?4:$e>223?3:$e>191?2:1;if(we+Pe<=D){let Ke,Xe,Ve,je;switch(Pe){case 1:$e<128&&(Ne=$e);break;case 2:Ke=Z[we+1],(Ke&192)===128&&(je=($e&31)<<6|Ke&63,je>127&&(Ne=je));break;case 3:Ke=Z[we+1],Xe=Z[we+2],(Ke&192)===128&&(Xe&192)===128&&(je=($e&15)<<12|(Ke&63)<<6|Xe&63,je>2047&&(je<55296||je>57343)&&(Ne=je));break;case 4:Ke=Z[we+1],Xe=Z[we+2],Ve=Z[we+3],(Ke&192)===128&&(Xe&192)===128&&(Ve&192)===128&&(je=($e&15)<<18|(Ke&63)<<12|(Xe&63)<<6|Ve&63,je>65535&&je<1114112&&(Ne=je))}}Ne===null?(Ne=65533,Pe=1):Ne>65535&&(Ne-=65536,_e.push(Ne>>>10&1023|55296),Ne=56320|Ne&1023),_e.push(Ne),we+=Pe}return rt(_e)}const tt=4096;function rt(Z){const y=Z.length;if(y<=tt)return String.fromCharCode.apply(String,Z);let D="",_e=0;for(;_e<y;)D+=String.fromCharCode.apply(String,Z.slice(_e,_e+=tt));return D}function Ue(Z,y,D){let _e="";D=Math.min(Z.length,D);for(let we=y;we<D;++we)_e+=String.fromCharCode(Z[we]&127);return _e}function it(Z,y,D){let _e="";D=Math.min(Z.length,D);for(let we=y;we<D;++we)_e+=String.fromCharCode(Z[we]);return _e}function st(Z,y,D){const _e=Z.length;(!y||y<0)&&(y=0),(!D||D<0||D>_e)&&(D=_e);let we="";for(let $e=y;$e<D;++$e)we+=vt[Z[$e]];return we}function lt(Z,y,D){const _e=Z.slice(y,D);let we="";for(let $e=0;$e<_e.length-1;$e+=2)we+=String.fromCharCode(_e[$e]+_e[$e+1]*256);return we}S.prototype.slice=function(y,D){const _e=this.length;y=~~y,D=D===void 0?_e:~~D,y<0?(y+=_e,y<0&&(y=0)):y>_e&&(y=_e),D<0?(D+=_e,D<0&&(D=0)):D>_e&&(D=_e),D<y&&(D=y);const we=this.subarray(y,D);return Object.setPrototypeOf(we,S.prototype),we};function He(Z,y,D){if(Z%1!==0||Z<0)throw new RangeError("offset is not uint");if(Z+y>D)throw new RangeError("Trying to access beyond buffer length")}S.prototype.readUintLE=S.prototype.readUIntLE=function(y,D,_e){y=y>>>0,D=D>>>0,_e||He(y,D,this.length);let we=this[y],$e=1,Ne=0;for(;++Ne<D&&($e*=256);)we+=this[y+Ne]*$e;return we},S.prototype.readUintBE=S.prototype.readUIntBE=function(y,D,_e){y=y>>>0,D=D>>>0,_e||He(y,D,this.length);let we=this[y+--D],$e=1;for(;D>0&&($e*=256);)we+=this[y+--D]*$e;return we},S.prototype.readUint8=S.prototype.readUInt8=function(y,D){return y=y>>>0,D||He(y,1,this.length),this[y]},S.prototype.readUint16LE=S.prototype.readUInt16LE=function(y,D){return y=y>>>0,D||He(y,2,this.length),this[y]|this[y+1]<<8},S.prototype.readUint16BE=S.prototype.readUInt16BE=function(y,D){return y=y>>>0,D||He(y,2,this.length),this[y]<<8|this[y+1]},S.prototype.readUint32LE=S.prototype.readUInt32LE=function(y,D){return y=y>>>0,D||He(y,4,this.length),(this[y]|this[y+1]<<8|this[y+2]<<16)+this[y+3]*16777216},S.prototype.readUint32BE=S.prototype.readUInt32BE=function(y,D){return y=y>>>0,D||He(y,4,this.length),this[y]*16777216+(this[y+1]<<16|this[y+2]<<8|this[y+3])},S.prototype.readBigUInt64LE=ct(function(y){y=y>>>0,We(y,"offset");const D=this[y],_e=this[y+7];(D===void 0||_e===void 0)&&Qe(y,this.length-8);const we=D+this[++y]*2**8+this[++y]*2**16+this[++y]*2**24,$e=this[++y]+this[++y]*2**8+this[++y]*2**16+_e*2**24;return BigInt(we)+(BigInt($e)<<BigInt(32))}),S.prototype.readBigUInt64BE=ct(function(y){y=y>>>0,We(y,"offset");const D=this[y],_e=this[y+7];(D===void 0||_e===void 0)&&Qe(y,this.length-8);const we=D*2**24+this[++y]*2**16+this[++y]*2**8+this[++y],$e=this[++y]*2**24+this[++y]*2**16+this[++y]*2**8+_e;return(BigInt(we)<<BigInt(32))+BigInt($e)}),S.prototype.readIntLE=function(y,D,_e){y=y>>>0,D=D>>>0,_e||He(y,D,this.length);let we=this[y],$e=1,Ne=0;for(;++Ne<D&&($e*=256);)we+=this[y+Ne]*$e;return $e*=128,we>=$e&&(we-=Math.pow(2,8*D)),we},S.prototype.readIntBE=function(y,D,_e){y=y>>>0,D=D>>>0,_e||He(y,D,this.length);let we=D,$e=1,Ne=this[y+--we];for(;we>0&&($e*=256);)Ne+=this[y+--we]*$e;return $e*=128,Ne>=$e&&(Ne-=Math.pow(2,8*D)),Ne},S.prototype.readInt8=function(y,D){return y=y>>>0,D||He(y,1,this.length),this[y]&128?(255-this[y]+1)*-1:this[y]},S.prototype.readInt16LE=function(y,D){y=y>>>0,D||He(y,2,this.length);const _e=this[y]|this[y+1]<<8;return _e&32768?_e|4294901760:_e},S.prototype.readInt16BE=function(y,D){y=y>>>0,D||He(y,2,this.length);const _e=this[y+1]|this[y]<<8;return _e&32768?_e|4294901760:_e},S.prototype.readInt32LE=function(y,D){return y=y>>>0,D||He(y,4,this.length),this[y]|this[y+1]<<8|this[y+2]<<16|this[y+3]<<24},S.prototype.readInt32BE=function(y,D){return y=y>>>0,D||He(y,4,this.length),this[y]<<24|this[y+1]<<16|this[y+2]<<8|this[y+3]},S.prototype.readBigInt64LE=ct(function(y){y=y>>>0,We(y,"offset");const D=this[y],_e=this[y+7];(D===void 0||_e===void 0)&&Qe(y,this.length-8);const we=this[y+4]+this[y+5]*2**8+this[y+6]*2**16+(_e<<24);return(BigInt(we)<<BigInt(32))+BigInt(D+this[++y]*2**8+this[++y]*2**16+this[++y]*2**24)}),S.prototype.readBigInt64BE=ct(function(y){y=y>>>0,We(y,"offset");const D=this[y],_e=this[y+7];(D===void 0||_e===void 0)&&Qe(y,this.length-8);const we=(D<<24)+this[++y]*2**16+this[++y]*2**8+this[++y];return(BigInt(we)<<BigInt(32))+BigInt(this[++y]*2**24+this[++y]*2**16+this[++y]*2**8+_e)}),S.prototype.readFloatLE=function(y,D){return y=y>>>0,D||He(y,4,this.length),l.read(this,y,!0,23,4)},S.prototype.readFloatBE=function(y,D){return y=y>>>0,D||He(y,4,this.length),l.read(this,y,!1,23,4)},S.prototype.readDoubleLE=function(y,D){return y=y>>>0,D||He(y,8,this.length),l.read(this,y,!0,52,8)},S.prototype.readDoubleBE=function(y,D){return y=y>>>0,D||He(y,8,this.length),l.read(this,y,!1,52,8)};function qe(Z,y,D,_e,we,$e){if(!S.isBuffer(Z))throw new TypeError('"buffer" argument must be a Buffer instance');if(y>we||y<$e)throw new RangeError('"value" argument is out of bounds');if(D+_e>Z.length)throw new RangeError("Index out of range")}S.prototype.writeUintLE=S.prototype.writeUIntLE=function(y,D,_e,we){if(y=+y,D=D>>>0,_e=_e>>>0,!we){const Pe=Math.pow(2,8*_e)-1;qe(this,y,D,_e,Pe,0)}let $e=1,Ne=0;for(this[D]=y&255;++Ne<_e&&($e*=256);)this[D+Ne]=y/$e&255;return D+_e},S.prototype.writeUintBE=S.prototype.writeUIntBE=function(y,D,_e,we){if(y=+y,D=D>>>0,_e=_e>>>0,!we){const Pe=Math.pow(2,8*_e)-1;qe(this,y,D,_e,Pe,0)}let $e=_e-1,Ne=1;for(this[D+$e]=y&255;--$e>=0&&(Ne*=256);)this[D+$e]=y/Ne&255;return D+_e},S.prototype.writeUint8=S.prototype.writeUInt8=function(y,D,_e){return y=+y,D=D>>>0,_e||qe(this,y,D,1,255,0),this[D]=y&255,D+1},S.prototype.writeUint16LE=S.prototype.writeUInt16LE=function(y,D,_e){return y=+y,D=D>>>0,_e||qe(this,y,D,2,65535,0),this[D]=y&255,this[D+1]=y>>>8,D+2},S.prototype.writeUint16BE=S.prototype.writeUInt16BE=function(y,D,_e){return y=+y,D=D>>>0,_e||qe(this,y,D,2,65535,0),this[D]=y>>>8,this[D+1]=y&255,D+2},S.prototype.writeUint32LE=S.prototype.writeUInt32LE=function(y,D,_e){return y=+y,D=D>>>0,_e||qe(this,y,D,4,4294967295,0),this[D+3]=y>>>24,this[D+2]=y>>>16,this[D+1]=y>>>8,this[D]=y&255,D+4},S.prototype.writeUint32BE=S.prototype.writeUInt32BE=function(y,D,_e){return y=+y,D=D>>>0,_e||qe(this,y,D,4,4294967295,0),this[D]=y>>>24,this[D+1]=y>>>16,this[D+2]=y>>>8,this[D+3]=y&255,D+4};function dt(Z,y,D,_e,we){Ye(y,_e,we,Z,D,7);let $e=Number(y&BigInt(4294967295));Z[D++]=$e,$e=$e>>8,Z[D++]=$e,$e=$e>>8,Z[D++]=$e,$e=$e>>8,Z[D++]=$e;let Ne=Number(y>>BigInt(32)&BigInt(4294967295));return Z[D++]=Ne,Ne=Ne>>8,Z[D++]=Ne,Ne=Ne>>8,Z[D++]=Ne,Ne=Ne>>8,Z[D++]=Ne,D}function ht(Z,y,D,_e,we){Ye(y,_e,we,Z,D,7);let $e=Number(y&BigInt(4294967295));Z[D+7]=$e,$e=$e>>8,Z[D+6]=$e,$e=$e>>8,Z[D+5]=$e,$e=$e>>8,Z[D+4]=$e;let Ne=Number(y>>BigInt(32)&BigInt(4294967295));return Z[D+3]=Ne,Ne=Ne>>8,Z[D+2]=Ne,Ne=Ne>>8,Z[D+1]=Ne,Ne=Ne>>8,Z[D]=Ne,D+8}S.prototype.writeBigUInt64LE=ct(function(y,D=0){return dt(this,y,D,BigInt(0),BigInt("0xffffffffffffffff"))}),S.prototype.writeBigUInt64BE=ct(function(y,D=0){return ht(this,y,D,BigInt(0),BigInt("0xffffffffffffffff"))}),S.prototype.writeIntLE=function(y,D,_e,we){if(y=+y,D=D>>>0,!we){const Ke=Math.pow(2,8*_e-1);qe(this,y,D,_e,Ke-1,-Ke)}let $e=0,Ne=1,Pe=0;for(this[D]=y&255;++$e<_e&&(Ne*=256);)y<0&&Pe===0&&this[D+$e-1]!==0&&(Pe=1),this[D+$e]=(y/Ne>>0)-Pe&255;return D+_e},S.prototype.writeIntBE=function(y,D,_e,we){if(y=+y,D=D>>>0,!we){const Ke=Math.pow(2,8*_e-1);qe(this,y,D,_e,Ke-1,-Ke)}let $e=_e-1,Ne=1,Pe=0;for(this[D+$e]=y&255;--$e>=0&&(Ne*=256);)y<0&&Pe===0&&this[D+$e+1]!==0&&(Pe=1),this[D+$e]=(y/Ne>>0)-Pe&255;return D+_e},S.prototype.writeInt8=function(y,D,_e){return y=+y,D=D>>>0,_e||qe(this,y,D,1,127,-128),y<0&&(y=255+y+1),this[D]=y&255,D+1},S.prototype.writeInt16LE=function(y,D,_e){return y=+y,D=D>>>0,_e||qe(this,y,D,2,32767,-32768),this[D]=y&255,this[D+1]=y>>>8,D+2},S.prototype.writeInt16BE=function(y,D,_e){return y=+y,D=D>>>0,_e||qe(this,y,D,2,32767,-32768),this[D]=y>>>8,this[D+1]=y&255,D+2},S.prototype.writeInt32LE=function(y,D,_e){return y=+y,D=D>>>0,_e||qe(this,y,D,4,2147483647,-2147483648),this[D]=y&255,this[D+1]=y>>>8,this[D+2]=y>>>16,this[D+3]=y>>>24,D+4},S.prototype.writeInt32BE=function(y,D,_e){return y=+y,D=D>>>0,_e||qe(this,y,D,4,2147483647,-2147483648),y<0&&(y=4294967295+y+1),this[D]=y>>>24,this[D+1]=y>>>16,this[D+2]=y>>>8,this[D+3]=y&255,D+4},S.prototype.writeBigInt64LE=ct(function(y,D=0){return dt(this,y,D,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),S.prototype.writeBigInt64BE=ct(function(y,D=0){return ht(this,y,D,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function _t(Z,y,D,_e,we,$e){if(D+_e>Z.length)throw new RangeError("Index out of range");if(D<0)throw new RangeError("Index out of range")}function mt(Z,y,D,_e,we){return y=+y,D=D>>>0,we||_t(Z,y,D,4),l.write(Z,y,D,_e,23,4),D+4}S.prototype.writeFloatLE=function(y,D,_e){return mt(this,y,D,!0,_e)},S.prototype.writeFloatBE=function(y,D,_e){return mt(this,y,D,!1,_e)};function ee(Z,y,D,_e,we){return y=+y,D=D>>>0,we||_t(Z,y,D,8),l.write(Z,y,D,_e,52,8),D+8}S.prototype.writeDoubleLE=function(y,D,_e){return ee(this,y,D,!0,_e)},S.prototype.writeDoubleBE=function(y,D,_e){return ee(this,y,D,!1,_e)},S.prototype.copy=function(y,D,_e,we){if(!S.isBuffer(y))throw new TypeError("argument should be a Buffer");if(_e||(_e=0),!we&&we!==0&&(we=this.length),D>=y.length&&(D=y.length),D||(D=0),we>0&&we<_e&&(we=_e),we===_e||y.length===0||this.length===0)return 0;if(D<0)throw new RangeError("targetStart out of bounds");if(_e<0||_e>=this.length)throw new RangeError("Index out of range");if(we<0)throw new RangeError("sourceEnd out of bounds");we>this.length&&(we=this.length),y.length-D<we-_e&&(we=y.length-D+_e);const $e=we-_e;return this===y&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(D,_e,we):Uint8Array.prototype.set.call(y,this.subarray(_e,we),D),$e},S.prototype.fill=function(y,D,_e,we){if(typeof y=="string"){if(typeof D=="string"?(we=D,D=0,_e=this.length):typeof _e=="string"&&(we=_e,_e=this.length),we!==void 0&&typeof we!="string")throw new TypeError("encoding must be a string");if(typeof we=="string"&&!S.isEncoding(we))throw new TypeError("Unknown encoding: "+we);if(y.length===1){const Ne=y.charCodeAt(0);(we==="utf8"&&Ne<128||we==="latin1")&&(y=Ne)}}else typeof y=="number"?y=y&255:typeof y=="boolean"&&(y=Number(y));if(D<0||this.length<D||this.length<_e)throw new RangeError("Out of range index");if(_e<=D)return this;D=D>>>0,_e=_e===void 0?this.length:_e>>>0,y||(y=0);let $e;if(typeof y=="number")for($e=D;$e<_e;++$e)this[$e]=y;else{const Ne=S.isBuffer(y)?y:S.from(y,we),Pe=Ne.length;if(Pe===0)throw new TypeError('The value "'+y+'" is invalid for argument "value"');for($e=0;$e<_e-D;++$e)this[$e+D]=Ne[$e%Pe]}return this};const U={};function Ce(Z,y,D){U[Z]=class extends D{constructor(){super(),Object.defineProperty(this,"message",{value:y.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Z}]`,this.stack,delete this.name}get code(){return Z}set code(we){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:we,writable:!0})}toString(){return`${this.name} [${Z}]: ${this.message}`}}}Ce("ERR_BUFFER_OUT_OF_BOUNDS",function(Z){return Z?`${Z} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Ce("ERR_INVALID_ARG_TYPE",function(Z,y){return`The "${Z}" argument must be of type number. Received type ${typeof y}`},TypeError),Ce("ERR_OUT_OF_RANGE",function(Z,y,D){let _e=`The value of "${Z}" is out of range.`,we=D;return Number.isInteger(D)&&Math.abs(D)>2**32?we=xe(String(D)):typeof D=="bigint"&&(we=String(D),(D>BigInt(2)**BigInt(32)||D<-(BigInt(2)**BigInt(32)))&&(we=xe(we)),we+="n"),_e+=` It must be ${y}. Received ${we}`,_e},RangeError);function xe(Z){let y="",D=Z.length;const _e=Z[0]==="-"?1:0;for(;D>=_e+4;D-=3)y=`_${Z.slice(D-3,D)}${y}`;return`${Z.slice(0,D)}${y}`}function ze(Z,y,D){We(y,"offset"),(Z[y]===void 0||Z[y+D]===void 0)&&Qe(y,Z.length-(D+1))}function Ye(Z,y,D,_e,we,$e){if(Z>D||Z<y){const Ne=typeof y=="bigint"?"n":"";let Pe;throw $e>3?y===0||y===BigInt(0)?Pe=`>= 0${Ne} and < 2${Ne} ** ${($e+1)*8}${Ne}`:Pe=`>= -(2${Ne} ** ${($e+1)*8-1}${Ne}) and < 2 ** ${($e+1)*8-1}${Ne}`:Pe=`>= ${y}${Ne} and <= ${D}${Ne}`,new U.ERR_OUT_OF_RANGE("value",Pe,Z)}ze(_e,we,$e)}function We(Z,y){if(typeof Z!="number")throw new U.ERR_INVALID_ARG_TYPE(y,"number",Z)}function Qe(Z,y,D){throw Math.floor(Z)!==Z?(We(Z,D),new U.ERR_OUT_OF_RANGE(D||"offset","an integer",Z)):y<0?new U.ERR_BUFFER_OUT_OF_BOUNDS:new U.ERR_OUT_OF_RANGE(D||"offset",`>= ${D?1:0} and <= ${y}`,Z)}const nt=/[^+/0-9A-Za-z-_]/g;function ft(Z){if(Z=Z.split("=")[0],Z=Z.trim().replace(nt,""),Z.length<2)return"";for(;Z.length%4!==0;)Z=Z+"=";return Z}function Je(Z,y){y=y||1/0;let D;const _e=Z.length;let we=null;const $e=[];for(let Ne=0;Ne<_e;++Ne){if(D=Z.charCodeAt(Ne),D>55295&&D<57344){if(!we){if(D>56319){(y-=3)>-1&&$e.push(239,191,189);continue}else if(Ne+1===_e){(y-=3)>-1&&$e.push(239,191,189);continue}we=D;continue}if(D<56320){(y-=3)>-1&&$e.push(239,191,189),we=D;continue}D=(we-55296<<10|D-56320)+65536}else we&&(y-=3)>-1&&$e.push(239,191,189);if(we=null,D<128){if((y-=1)<0)break;$e.push(D)}else if(D<2048){if((y-=2)<0)break;$e.push(D>>6|192,D&63|128)}else if(D<65536){if((y-=3)<0)break;$e.push(D>>12|224,D>>6&63|128,D&63|128)}else if(D<1114112){if((y-=4)<0)break;$e.push(D>>18|240,D>>12&63|128,D>>6&63|128,D&63|128)}else throw new Error("Invalid code point")}return $e}function ot(Z){const y=[];for(let D=0;D<Z.length;++D)y.push(Z.charCodeAt(D)&255);return y}function gt(Z,y){let D,_e,we;const $e=[];for(let Ne=0;Ne<Z.length&&!((y-=2)<0);++Ne)D=Z.charCodeAt(Ne),_e=D>>8,we=D%256,$e.push(we),$e.push(_e);return $e}function pt(Z){return g.toByteArray(ft(Z))}function ut(Z,y,D,_e){let we;for(we=0;we<_e&&!(we+D>=y.length||we>=Z.length);++we)y[we+D]=Z[we];return we}function at(Z,y){return Z instanceof y||Z!=null&&Z.constructor!=null&&Z.constructor.name!=null&&Z.constructor.name===y.name}function Et(Z){return Z!==Z}const vt=function(){const Z="0123456789abcdef",y=new Array(256);for(let D=0;D<16;++D){const _e=D*16;for(let we=0;we<16;++we)y[_e+we]=Z[D]+Z[we]}return y}();function ct(Z){return typeof BigInt=="undefined"?wt:Z}function wt(){throw new Error("BigInt not supported")}})(buffer$1),globalThis.Buffer=buffer$1.Buffer;var utf8$5={},utils$r={},support$5={},nodestream,blob;if(support$5.base64=!0,support$5.array=!0,support$5.string=!0,support$5.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",support$5.nodebuffer=typeof Buffer!="undefined",support$5.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")blob=support$5.blob=!1;else{var buffer=new ArrayBuffer(0);try{blob=support$5.blob=new Blob([buffer],{type:"application/zip"}).size===0}catch(r){try{var Builder=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,builder=new Builder;builder.append(buffer),blob=support$5.blob=builder.getBlob("application/zip").size===0}catch(g){blob=support$5.blob=!1}}}try{nodestream=support$5.nodestream=!!require("readable-stream").Readable}catch(r){nodestream=support$5.nodestream=!1}var base64$1={},utils$q=utils$r,support$4=support$5,_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";base64$1.encode=function(r){for(var g=[],l,v,I,k,O,S,Y,L=0,z=r.length,Te=z,te=utils$q.getTypeOf(r)!=="string";L<r.length;)Te=z-L,te?(l=r[L++],v=L<z?r[L++]:0,I=L<z?r[L++]:0):(l=r.charCodeAt(L++),v=L<z?r.charCodeAt(L++):0,I=L<z?r.charCodeAt(L++):0),k=l>>2,O=(l&3)<<4|v>>4,S=Te>1?(v&15)<<2|I>>6:64,Y=Te>2?I&63:64,g.push(_keyStr.charAt(k)+_keyStr.charAt(O)+_keyStr.charAt(S)+_keyStr.charAt(Y));return g.join("")},base64$1.decode=function(r){var g,l,v,I,k,O,S,Y=0,L=0,z="data:";if(r.substr(0,z.length)===z)throw new Error("Invalid base64 input, it looks like a data url.");r=r.replace(/[^A-Za-z0-9+/=]/g,"");var Te=r.length*3/4;if(r.charAt(r.length-1)===_keyStr.charAt(64)&&Te--,r.charAt(r.length-2)===_keyStr.charAt(64)&&Te--,Te%1!==0)throw new Error("Invalid base64 input, bad content length.");var te;for(support$4.uint8array?te=new Uint8Array(Te|0):te=new Array(Te|0);Y<r.length;)I=_keyStr.indexOf(r.charAt(Y++)),k=_keyStr.indexOf(r.charAt(Y++)),O=_keyStr.indexOf(r.charAt(Y++)),S=_keyStr.indexOf(r.charAt(Y++)),g=I<<2|k>>4,l=(k&15)<<4|O>>2,v=(O&3)<<6|S,te[L++]=g,O!==64&&(te[L++]=l),S!==64&&(te[L++]=v);return te};var nodejsUtils$2={isNode:typeof Buffer!="undefined",newBufferFrom:function(r,g){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(r,g);if(typeof r=="number")throw new Error('The "data" argument must not be a number');return new Buffer(r,g)},allocBuffer:function(r){if(Buffer.alloc)return Buffer.alloc(r);var g=new Buffer(r);return g.fill(0),g},isBuffer:function(r){return Buffer.isBuffer(r)},isStream:function(r){return r&&typeof r.on=="function"&&typeof r.pause=="function"&&typeof r.resume=="function"}},Mutation=commonjsGlobal.MutationObserver||commonjsGlobal.WebKitMutationObserver,scheduleDrain;if(Mutation){var called=0,observer=new Mutation(nextTick),element=commonjsGlobal.document.createTextNode("");observer.observe(element,{characterData:!0}),scheduleDrain=function(){element.data=called=++called%2}}else if(!commonjsGlobal.setImmediate&&typeof commonjsGlobal.MessageChannel!="undefined"){var channel=new commonjsGlobal.MessageChannel;channel.port1.onmessage=nextTick,scheduleDrain=function(){channel.port2.postMessage(0)}}else"document"in commonjsGlobal&&"onreadystatechange"in commonjsGlobal.document.createElement("script")?scheduleDrain=function(){var r=commonjsGlobal.document.createElement("script");r.onreadystatechange=function(){nextTick(),r.onreadystatechange=null,r.parentNode.removeChild(r),r=null},commonjsGlobal.document.documentElement.appendChild(r)}:scheduleDrain=function(){setTimeout(nextTick,0)};var draining,queue=[];function nextTick(){draining=!0;for(var r,g,l=queue.length;l;){for(g=queue,queue=[],r=-1;++r<l;)g[r]();l=queue.length}draining=!1}var lib$2=immediate$1;function immediate$1(r){queue.push(r)===1&&!draining&&scheduleDrain()}var immediate=lib$2;function INTERNAL(){}var handlers={},REJECTED=["REJECTED"],FULFILLED=["FULFILLED"],PENDING=["PENDING"],lib$1=Promise$1;function Promise$1(r){if(typeof r!="function")throw new TypeError("resolver must be a function");this.state=PENDING,this.queue=[],this.outcome=void 0,r!==INTERNAL&&safelyResolveThenable(this,r)}Promise$1.prototype.finally=function(r){if(typeof r!="function")return this;var g=this.constructor;return this.then(l,v);function l(I){function k(){return I}return g.resolve(r()).then(k)}function v(I){function k(){throw I}return g.resolve(r()).then(k)}},Promise$1.prototype.catch=function(r){return this.then(null,r)},Promise$1.prototype.then=function(r,g){if(typeof r!="function"&&this.state===FULFILLED||typeof g!="function"&&this.state===REJECTED)return this;var l=new this.constructor(INTERNAL);if(this.state!==PENDING){var v=this.state===FULFILLED?r:g;unwrap(l,v,this.outcome)}else this.queue.push(new QueueItem(l,r,g));return l};function QueueItem(r,g,l){this.promise=r,typeof g=="function"&&(this.onFulfilled=g,this.callFulfilled=this.otherCallFulfilled),typeof l=="function"&&(this.onRejected=l,this.callRejected=this.otherCallRejected)}QueueItem.prototype.callFulfilled=function(r){handlers.resolve(this.promise,r)},QueueItem.prototype.otherCallFulfilled=function(r){unwrap(this.promise,this.onFulfilled,r)},QueueItem.prototype.callRejected=function(r){handlers.reject(this.promise,r)},QueueItem.prototype.otherCallRejected=function(r){unwrap(this.promise,this.onRejected,r)};function unwrap(r,g,l){immediate(function(){var v;try{v=g(l)}catch(I){return handlers.reject(r,I)}v===r?handlers.reject(r,new TypeError("Cannot resolve promise with itself")):handlers.resolve(r,v)})}handlers.resolve=function(r,g){var l=tryCatch(getThen,g);if(l.status==="error")return handlers.reject(r,l.value);var v=l.value;if(v)safelyResolveThenable(r,v);else{r.state=FULFILLED,r.outcome=g;for(var I=-1,k=r.queue.length;++I<k;)r.queue[I].callFulfilled(g)}return r},handlers.reject=function(r,g){r.state=REJECTED,r.outcome=g;for(var l=-1,v=r.queue.length;++l<v;)r.queue[l].callRejected(g);return r};function getThen(r){var g=r&&r.then;if(r&&(typeof r=="object"||typeof r=="function")&&typeof g=="function")return function(){g.apply(r,arguments)}}function safelyResolveThenable(r,g){var l=!1;function v(S){l||(l=!0,handlers.reject(r,S))}function I(S){l||(l=!0,handlers.resolve(r,S))}function k(){g(I,v)}var O=tryCatch(k);O.status==="error"&&v(O.value)}function tryCatch(r,g){var l={};try{l.value=r(g),l.status="success"}catch(v){l.status="error",l.value=v}return l}Promise$1.resolve=resolve;function resolve(r){return r instanceof this?r:handlers.resolve(new this(INTERNAL),r)}Promise$1.reject=reject;function reject(r){var g=new this(INTERNAL);return handlers.reject(g,r)}Promise$1.all=all;function all(r){var g=this;if(Object.prototype.toString.call(r)!=="[object Array]")return this.reject(new TypeError("must be an array"));var l=r.length,v=!1;if(!l)return this.resolve([]);for(var I=new Array(l),k=0,O=-1,S=new this(INTERNAL);++O<l;)Y(r[O],O);return S;function Y(L,z){g.resolve(L).then(Te,function(te){v||(v=!0,handlers.reject(S,te))});function Te(te){I[z]=te,++k===l&&!v&&(v=!0,handlers.resolve(S,I))}}}Promise$1.race=race;function race(r){var g=this;if(Object.prototype.toString.call(r)!=="[object Array]")return this.reject(new TypeError("must be an array"));var l=r.length,v=!1;if(!l)return this.resolve([]);for(var I=-1,k=new this(INTERNAL);++I<l;)O(r[I]);return k;function O(S){g.resolve(S).then(function(Y){v||(v=!0,handlers.resolve(k,Y))},function(Y){v||(v=!0,handlers.reject(k,Y))})}}var ES6Promise=null;typeof Promise!="undefined"?ES6Promise=Promise:ES6Promise=lib$1;var external$3={Promise:ES6Promise};(function(r,g){if(r.setImmediate)return;var l=1,v={},I=!1,k=r.document,O;function S(Ie){typeof Ie!="function"&&(Ie=new Function(""+Ie));for(var Re=new Array(arguments.length-1),ke=0;ke<Re.length;ke++)Re[ke]=arguments[ke+1];var De={callback:Ie,args:Re};return v[l]=De,O(l),l++}function Y(Ie){delete v[Ie]}function L(Ie){var Re=Ie.callback,ke=Ie.args;switch(ke.length){case 0:Re();break;case 1:Re(ke[0]);break;case 2:Re(ke[0],ke[1]);break;case 3:Re(ke[0],ke[1],ke[2]);break;default:Re.apply(g,ke);break}}function z(Ie){if(I)setTimeout(z,0,Ie);else{var Re=v[Ie];if(Re){I=!0;try{L(Re)}finally{Y(Ie),I=!1}}}}function Te(){O=function(Ie){setTimeout(function(){z(Ie)})}}function te(){if(r.postMessage&&!r.importScripts){var Ie=!0,Re=r.onmessage;return r.onmessage=function(){Ie=!1},r.postMessage("","*"),r.onmessage=Re,Ie}}function ge(){var Ie="setImmediate$"+Math.random()+"$",Re=function(ke){ke.source===r&&typeof ke.data=="string"&&ke.data.indexOf(Ie)===0&&z(+ke.data.slice(Ie.length))};r.addEventListener?r.addEventListener("message",Re,!1):r.attachEvent("onmessage",Re),O=function(ke){r.postMessage(Ie+ke,"*")}}function Ee(){var Ie=new MessageChannel;Ie.port1.onmessage=function(Re){var ke=Re.data;z(ke)},O=function(Re){Ie.port2.postMessage(Re)}}function be(){var Ie=k.documentElement;O=function(Re){var ke=k.createElement("script");ke.onreadystatechange=function(){z(Re),ke.onreadystatechange=null,Ie.removeChild(ke),ke=null},Ie.appendChild(ke)}}function Se(){O=function(Ie){setTimeout(z,0,Ie)}}var Ae=Object.getPrototypeOf&&Object.getPrototypeOf(r);Ae=Ae&&Ae.setTimeout?Ae:r,{}.toString.call(r.undefined)==="[object undefined]"?Te():te()?ge():r.MessageChannel?Ee():k&&"onreadystatechange"in k.createElement("script")?be():Se(),Ae.setImmediate=S,Ae.clearImmediate=Y})(typeof self=="undefined"?commonjsGlobal:self),function(r){var g=support$5,l=base64$1,v=nodejsUtils$2,I=external$3;function k(te){var ge=null;return g.uint8array?ge=new Uint8Array(te.length):ge=new Array(te.length),S(te,ge)}r.newBlob=function(te,ge){r.checkSupport("blob");try{return new Blob([te],{type:ge})}catch(Se){try{var Ee=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,be=new Ee;return be.append(te),be.getBlob(ge)}catch(Ae){throw new Error("Bug : can't construct the Blob.")}}};function O(te){return te}function S(te,ge){for(var Ee=0;Ee<te.length;++Ee)ge[Ee]=te.charCodeAt(Ee)&255;return ge}var Y={stringifyByChunk:function(te,ge,Ee){var be=[],Se=0,Ae=te.length;if(Ae<=Ee)return String.fromCharCode.apply(null,te);for(;Se<Ae;)ge==="array"||ge==="nodebuffer"?be.push(String.fromCharCode.apply(null,te.slice(Se,Math.min(Se+Ee,Ae)))):be.push(String.fromCharCode.apply(null,te.subarray(Se,Math.min(Se+Ee,Ae)))),Se+=Ee;return be.join("")},stringifyByChar:function(te){for(var ge="",Ee=0;Ee<te.length;Ee++)ge+=String.fromCharCode(te[Ee]);return ge},applyCanBeUsed:{uint8array:function(){try{return g.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch(te){return!1}}(),nodebuffer:function(){try{return g.nodebuffer&&String.fromCharCode.apply(null,v.allocBuffer(1)).length===1}catch(te){return!1}}()}};function L(te){var ge=65536,Ee=r.getTypeOf(te),be=!0;if(Ee==="uint8array"?be=Y.applyCanBeUsed.uint8array:Ee==="nodebuffer"&&(be=Y.applyCanBeUsed.nodebuffer),be)for(;ge>1;)try{return Y.stringifyByChunk(te,Ee,ge)}catch(Se){ge=Math.floor(ge/2)}return Y.stringifyByChar(te)}r.applyFromCharCode=L;function z(te,ge){for(var Ee=0;Ee<te.length;Ee++)ge[Ee]=te[Ee];return ge}var Te={};Te.string={string:O,array:function(te){return S(te,new Array(te.length))},arraybuffer:function(te){return Te.string.uint8array(te).buffer},uint8array:function(te){return S(te,new Uint8Array(te.length))},nodebuffer:function(te){return S(te,v.allocBuffer(te.length))}},Te.array={string:L,array:O,arraybuffer:function(te){return new Uint8Array(te).buffer},uint8array:function(te){return new Uint8Array(te)},nodebuffer:function(te){return v.newBufferFrom(te)}},Te.arraybuffer={string:function(te){return L(new Uint8Array(te))},array:function(te){return z(new Uint8Array(te),new Array(te.byteLength))},arraybuffer:O,uint8array:function(te){return new Uint8Array(te)},nodebuffer:function(te){return v.newBufferFrom(new Uint8Array(te))}},Te.uint8array={string:L,array:function(te){return z(te,new Array(te.length))},arraybuffer:function(te){return te.buffer},uint8array:O,nodebuffer:function(te){return v.newBufferFrom(te)}},Te.nodebuffer={string:L,array:function(te){return z(te,new Array(te.length))},arraybuffer:function(te){return Te.nodebuffer.uint8array(te).buffer},uint8array:function(te){return z(te,new Uint8Array(te.length))},nodebuffer:O},r.transformTo=function(te,ge){if(ge||(ge=""),!te)return ge;r.checkSupport(te);var Ee=r.getTypeOf(ge),be=Te[Ee][te](ge);return be},r.resolve=function(te){for(var ge=te.split("/"),Ee=[],be=0;be<ge.length;be++){var Se=ge[be];Se==="."||Se===""&&be!==0&&be!==ge.length-1||(Se===".."?Ee.pop():Ee.push(Se))}return Ee.join("/")},r.getTypeOf=function(te){if(typeof te=="string")return"string";if(Object.prototype.toString.call(te)==="[object Array]")return"array";if(g.nodebuffer&&v.isBuffer(te))return"nodebuffer";if(g.uint8array&&te instanceof Uint8Array)return"uint8array";if(g.arraybuffer&&te instanceof ArrayBuffer)return"arraybuffer"},r.checkSupport=function(te){var ge=g[te.toLowerCase()];if(!ge)throw new Error(te+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(te){var ge="",Ee,be;for(be=0;be<(te||"").length;be++)Ee=te.charCodeAt(be),ge+="\\x"+(Ee<16?"0":"")+Ee.toString(16).toUpperCase();return ge},r.delay=function(te,ge,Ee){setImmediate(function(){te.apply(Ee||null,ge||[])})},r.inherits=function(te,ge){var Ee=function(){};Ee.prototype=ge.prototype,te.prototype=new Ee},r.extend=function(){var te={},ge,Ee;for(ge=0;ge<arguments.length;ge++)for(Ee in arguments[ge])Object.prototype.hasOwnProperty.call(arguments[ge],Ee)&&typeof te[Ee]=="undefined"&&(te[Ee]=arguments[ge][Ee]);return te},r.prepareContent=function(te,ge,Ee,be,Se){var Ae=I.Promise.resolve(ge).then(function(Ie){var Re=g.blob&&(Ie instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(Ie))!==-1);return Re&&typeof FileReader!="undefined"?new I.Promise(function(ke,De){var Le=new FileReader;Le.onload=function(Be){ke(Be.target.result)},Le.onerror=function(Be){De(Be.target.error)},Le.readAsArrayBuffer(Ie)}):Ie});return Ae.then(function(Ie){var Re=r.getTypeOf(Ie);return Re?(Re==="arraybuffer"?Ie=r.transformTo("uint8array",Ie):Re==="string"&&(Se?Ie=l.decode(Ie):Ee&&be!==!0&&(Ie=k(Ie))),Ie):I.Promise.reject(new Error("Can't read the data of '"+te+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}}(utils$r);function GenericWorker$b(r){this.name=r||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}GenericWorker$b.prototype={push:function(r){this.emit("data",r)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(r){this.emit("error",r)}return!0},error:function(r){return this.isFinished?!1:(this.isPaused?this.generatedError=r:(this.isFinished=!0,this.emit("error",r),this.previous&&this.previous.error(r),this.cleanUp()),!0)},on:function(r,g){return this._listeners[r].push(g),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(r,g){if(this._listeners[r])for(var l=0;l<this._listeners[r].length;l++)this._listeners[r][l].call(this,g)},pipe:function(r){return r.registerPrevious(this)},registerPrevious:function(r){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=r.streamInfo,this.mergeStreamInfo(),this.previous=r;var g=this;return r.on("data",function(l){g.processChunk(l)}),r.on("end",function(){g.end()}),r.on("error",function(l){g.error(l)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var r=!1;return this.generatedError&&(this.error(this.generatedError),r=!0),this.previous&&this.previous.resume(),!r},flush:function(){},processChunk:function(r){this.push(r)},withStreamInfo:function(r,g){return this.extraStreamInfo[r]=g,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var r in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,r)&&(this.streamInfo[r]=this.extraStreamInfo[r])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var r="Worker "+this.name;return this.previous?this.previous+" -> "+r:r}};var GenericWorker_1=GenericWorker$b;(function(r){for(var g=utils$r,l=support$5,v=nodejsUtils$2,I=GenericWorker_1,k=new Array(256),O=0;O<256;O++)k[O]=O>=252?6:O>=248?5:O>=240?4:O>=224?3:O>=192?2:1;k[254]=k[254]=1;var S=function(te){var ge,Ee,be,Se,Ae,Ie=te.length,Re=0;for(Se=0;Se<Ie;Se++)Ee=te.charCodeAt(Se),(Ee&64512)===55296&&Se+1<Ie&&(be=te.charCodeAt(Se+1),(be&64512)===56320&&(Ee=65536+(Ee-55296<<10)+(be-56320),Se++)),Re+=Ee<128?1:Ee<2048?2:Ee<65536?3:4;for(l.uint8array?ge=new Uint8Array(Re):ge=new Array(Re),Ae=0,Se=0;Ae<Re;Se++)Ee=te.charCodeAt(Se),(Ee&64512)===55296&&Se+1<Ie&&(be=te.charCodeAt(Se+1),(be&64512)===56320&&(Ee=65536+(Ee-55296<<10)+(be-56320),Se++)),Ee<128?ge[Ae++]=Ee:Ee<2048?(ge[Ae++]=192|Ee>>>6,ge[Ae++]=128|Ee&63):Ee<65536?(ge[Ae++]=224|Ee>>>12,ge[Ae++]=128|Ee>>>6&63,ge[Ae++]=128|Ee&63):(ge[Ae++]=240|Ee>>>18,ge[Ae++]=128|Ee>>>12&63,ge[Ae++]=128|Ee>>>6&63,ge[Ae++]=128|Ee&63);return ge},Y=function(te,ge){var Ee;for(ge=ge||te.length,ge>te.length&&(ge=te.length),Ee=ge-1;Ee>=0&&(te[Ee]&192)===128;)Ee--;return Ee<0||Ee===0?ge:Ee+k[te[Ee]]>ge?Ee:ge},L=function(te){var ge,Ee,be,Se,Ae=te.length,Ie=new Array(Ae*2);for(Ee=0,ge=0;ge<Ae;){if(be=te[ge++],be<128){Ie[Ee++]=be;continue}if(Se=k[be],Se>4){Ie[Ee++]=65533,ge+=Se-1;continue}for(be&=Se===2?31:Se===3?15:7;Se>1&&ge<Ae;)be=be<<6|te[ge++]&63,Se--;if(Se>1){Ie[Ee++]=65533;continue}be<65536?Ie[Ee++]=be:(be-=65536,Ie[Ee++]=55296|be>>10&1023,Ie[Ee++]=56320|be&1023)}return Ie.length!==Ee&&(Ie.subarray?Ie=Ie.subarray(0,Ee):Ie.length=Ee),g.applyFromCharCode(Ie)};r.utf8encode=function(ge){return l.nodebuffer?v.newBufferFrom(ge,"utf-8"):S(ge)},r.utf8decode=function(ge){return l.nodebuffer?g.transformTo("nodebuffer",ge).toString("utf-8"):(ge=g.transformTo(l.uint8array?"uint8array":"array",ge),L(ge))};function z(){I.call(this,"utf-8 decode"),this.leftOver=null}g.inherits(z,I),z.prototype.processChunk=function(te){var ge=g.transformTo(l.uint8array?"uint8array":"array",te.data);if(this.leftOver&&this.leftOver.length){if(l.uint8array){var Ee=ge;ge=new Uint8Array(Ee.length+this.leftOver.length),ge.set(this.leftOver,0),ge.set(Ee,this.leftOver.length)}else ge=this.leftOver.concat(ge);this.leftOver=null}var be=Y(ge),Se=ge;be!==ge.length&&(l.uint8array?(Se=ge.subarray(0,be),this.leftOver=ge.subarray(be,ge.length)):(Se=ge.slice(0,be),this.leftOver=ge.slice(be,ge.length))),this.push({data:r.utf8decode(Se),meta:te.meta})},z.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=z;function Te(){I.call(this,"utf-8 encode")}g.inherits(Te,I),Te.prototype.processChunk=function(te){this.push({data:r.utf8encode(te.data),meta:te.meta})},r.Utf8EncodeWorker=Te})(utf8$5);var GenericWorker$a=GenericWorker_1,utils$p=utils$r;function ConvertWorker$1(r){GenericWorker$a.call(this,"ConvertWorker to "+r),this.destType=r}utils$p.inherits(ConvertWorker$1,GenericWorker$a),ConvertWorker$1.prototype.processChunk=function(r){this.push({data:utils$p.transformTo(this.destType,r.data),meta:r.meta})};var ConvertWorker_1=ConvertWorker$1,utils$o=utils$r,ConvertWorker=ConvertWorker_1,GenericWorker$9=GenericWorker_1,base64=base64$1,support$3=support$5,external$2=external$3,NodejsStreamOutputAdapter=null;if(support$3.nodestream)try{NodejsStreamOutputAdapter=require("../nodejs/NodejsStreamOutputAdapter")}catch(r){}function transformZipOutput(r,g,l){switch(r){case"blob":return utils$o.newBlob(utils$o.transformTo("arraybuffer",g),l);case"base64":return base64.encode(g);default:return utils$o.transformTo(r,g)}}function concat(r,g){var l,v=0,I=null,k=0;for(l=0;l<g.length;l++)k+=g[l].length;switch(r){case"string":return g.join("");case"array":return Array.prototype.concat.apply([],g);case"uint8array":for(I=new Uint8Array(k),l=0;l<g.length;l++)I.set(g[l],v),v+=g[l].length;return I;case"nodebuffer":return Buffer.concat(g);default:throw new Error("concat : unsupported type '"+r+"'")}}function accumulate(r,g){return new external$2.Promise(function(l,v){var I=[],k=r._internalType,O=r._outputType,S=r._mimeType;r.on("data",function(Y,L){I.push(Y),g&&g(L)}).on("error",function(Y){I=[],v(Y)}).on("end",function(){try{var Y=transformZipOutput(O,concat(k,I),S);l(Y)}catch(L){v(L)}I=[]}).resume()})}function StreamHelper$2(r,g,l){var v=g;switch(g){case"blob":case"arraybuffer":v="uint8array";break;case"base64":v="string";break}try{this._internalType=v,this._outputType=g,this._mimeType=l,utils$o.checkSupport(v),this._worker=r.pipe(new ConvertWorker(v)),r.lock()}catch(I){this._worker=new GenericWorker$9("error"),this._worker.error(I)}}StreamHelper$2.prototype={accumulate:function(r){return accumulate(this,r)},on:function(r,g){var l=this;return r==="data"?this._worker.on(r,function(v){g.call(l,v.data,v.meta)}):this._worker.on(r,function(){utils$o.delay(g,arguments,l)}),this},resume:function(){return utils$o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(r){if(utils$o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new NodejsStreamOutputAdapter(this,{objectMode:this._outputType!=="nodebuffer"},r)}};var StreamHelper_1=StreamHelper$2,defaults$1={};defaults$1.base64=!1,defaults$1.binary=!1,defaults$1.dir=!1,defaults$1.createFolders=!0,defaults$1.date=null,defaults$1.compression=null,defaults$1.compressionOptions=null,defaults$1.comment=null,defaults$1.unixPermissions=null,defaults$1.dosPermissions=null;var utils$n=utils$r,GenericWorker$8=GenericWorker_1,DEFAULT_BLOCK_SIZE=16*1024;function DataWorker$2(r){GenericWorker$8.call(this,"DataWorker");var g=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,r.then(function(l){g.dataIsReady=!0,g.data=l,g.max=l&&l.length||0,g.type=utils$n.getTypeOf(l),g.isPaused||g._tickAndRepeat()},function(l){g.error(l)})}utils$n.inherits(DataWorker$2,GenericWorker$8),DataWorker$2.prototype.cleanUp=function(){GenericWorker$8.prototype.cleanUp.call(this),this.data=null},DataWorker$2.prototype.resume=function(){return GenericWorker$8.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,utils$n.delay(this._tickAndRepeat,[],this)),!0):!1},DataWorker$2.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(utils$n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},DataWorker$2.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var r=DEFAULT_BLOCK_SIZE,g=null,l=Math.min(this.max,this.index+r);if(this.index>=this.max)return this.end();switch(this.type){case"string":g=this.data.substring(this.index,l);break;case"uint8array":g=this.data.subarray(this.index,l);break;case"array":case"nodebuffer":g=this.data.slice(this.index,l);break}return this.index=l,this.push({data:g,meta:{percent:this.max?this.index/this.max*100:0}})};var DataWorker_1=DataWorker$2,utils$m=utils$r;function makeTable$1(){for(var r,g=[],l=0;l<256;l++){r=l;for(var v=0;v<8;v++)r=r&1?3988292384^r>>>1:r>>>1;g[l]=r}return g}var crcTable$1=makeTable$1();function crc32$5(r,g,l,v){var I=crcTable$1,k=v+l;r=r^-1;for(var O=v;O<k;O++)r=r>>>8^I[(r^g[O])&255];return r^-1}function crc32str(r,g,l,v){var I=crcTable$1,k=v+l;r=r^-1;for(var O=v;O<k;O++)r=r>>>8^I[(r^g.charCodeAt(O))&255];return r^-1}var crc32_1$1=function(g,l){if(typeof g=="undefined"||!g.length)return 0;var v=utils$m.getTypeOf(g)!=="string";return v?crc32$5(l|0,g,g.length,0):crc32str(l|0,g,g.length,0)},GenericWorker$7=GenericWorker_1,crc32$4=crc32_1$1,utils$l=utils$r;function Crc32Probe$2(){GenericWorker$7.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}utils$l.inherits(Crc32Probe$2,GenericWorker$7),Crc32Probe$2.prototype.processChunk=function(r){this.streamInfo.crc32=crc32$4(r.data,this.streamInfo.crc32||0),this.push(r)};var Crc32Probe_1=Crc32Probe$2,utils$k=utils$r,GenericWorker$6=GenericWorker_1;function DataLengthProbe$1(r){GenericWorker$6.call(this,"DataLengthProbe for "+r),this.propName=r,this.withStreamInfo(r,0)}utils$k.inherits(DataLengthProbe$1,GenericWorker$6),DataLengthProbe$1.prototype.processChunk=function(r){if(r){var g=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=g+r.data.length}GenericWorker$6.prototype.processChunk.call(this,r)};var DataLengthProbe_1=DataLengthProbe$1,external$1=external$3,DataWorker$1=DataWorker_1,Crc32Probe$1=Crc32Probe_1,DataLengthProbe=DataLengthProbe_1;function CompressedObject$3(r,g,l,v,I){this.compressedSize=r,this.uncompressedSize=g,this.crc32=l,this.compression=v,this.compressedContent=I}CompressedObject$3.prototype={getContentWorker:function(){var r=new DataWorker$1(external$1.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new DataLengthProbe("data_length")),g=this;return r.on("end",function(){if(this.streamInfo.data_length!==g.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),r},getCompressedWorker:function(){return new DataWorker$1(external$1.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},CompressedObject$3.createWorkerFrom=function(r,g,l){return r.pipe(new Crc32Probe$1).pipe(new DataLengthProbe("uncompressedSize")).pipe(g.compressWorker(l)).pipe(new DataLengthProbe("compressedSize")).withStreamInfo("compression",g)};var compressedObject=CompressedObject$3,StreamHelper$1=StreamHelper_1,DataWorker=DataWorker_1,utf8$4=utf8$5,CompressedObject$2=compressedObject,GenericWorker$5=GenericWorker_1,ZipObject$1=function(r,g,l){this.name=r,this.dir=l.dir,this.date=l.date,this.comment=l.comment,this.unixPermissions=l.unixPermissions,this.dosPermissions=l.dosPermissions,this._data=g,this._dataBinary=l.binary,this.options={compression:l.compression,compressionOptions:l.compressionOptions}};ZipObject$1.prototype={internalStream:function(r){var g=null,l="string";try{if(!r)throw new Error("No output type specified.");l=r.toLowerCase();var v=l==="string"||l==="text";(l==="binarystring"||l==="text")&&(l="string"),g=this._decompressWorker();var I=!this._dataBinary;I&&!v&&(g=g.pipe(new utf8$4.Utf8EncodeWorker)),!I&&v&&(g=g.pipe(new utf8$4.Utf8DecodeWorker))}catch(k){g=new GenericWorker$5("error"),g.error(k)}return new StreamHelper$1(g,l,"")},async:function(r,g){return this.internalStream(r).accumulate(g)},nodeStream:function(r,g){return this.internalStream(r||"nodebuffer").toNodejsStream(g)},_compressWorker:function(r,g){if(this._data instanceof CompressedObject$2&&this._data.compression.magic===r.magic)return this._data.getCompressedWorker();var l=this._decompressWorker();return this._dataBinary||(l=l.pipe(new utf8$4.Utf8EncodeWorker)),CompressedObject$2.createWorkerFrom(l,r,g)},_decompressWorker:function(){return this._data instanceof CompressedObject$2?this._data.getContentWorker():this._data instanceof GenericWorker$5?this._data:new DataWorker(this._data)}};for(var removedMethods=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],removedFn=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},i$1=0;i$1<removedMethods.length;i$1++)ZipObject$1.prototype[removedMethods[i$1]]=removedFn;var zipObject=ZipObject$1,generate$1={},compressions$2={},flate={},common={};(function(r){var g=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";function l(k,O){return Object.prototype.hasOwnProperty.call(k,O)}r.assign=function(k){for(var O=Array.prototype.slice.call(arguments,1);O.length;){var S=O.shift();if(S){if(typeof S!="object")throw new TypeError(S+"must be non-object");for(var Y in S)l(S,Y)&&(k[Y]=S[Y])}}return k},r.shrinkBuf=function(k,O){return k.length===O?k:k.subarray?k.subarray(0,O):(k.length=O,k)};var v={arraySet:function(k,O,S,Y,L){if(O.subarray&&k.subarray){k.set(O.subarray(S,S+Y),L);return}for(var z=0;z<Y;z++)k[L+z]=O[S+z]},flattenChunks:function(k){var O,S,Y,L,z,Te;for(Y=0,O=0,S=k.length;O<S;O++)Y+=k[O].length;for(Te=new Uint8Array(Y),L=0,O=0,S=k.length;O<S;O++)z=k[O],Te.set(z,L),L+=z.length;return Te}},I={arraySet:function(k,O,S,Y,L){for(var z=0;z<Y;z++)k[L+z]=O[S+z]},flattenChunks:function(k){return[].concat.apply([],k)}};r.setTyped=function(k){k?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,v)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,I))},r.setTyped(g)})(common);var deflate$4={},deflate$3={},trees$1={},utils$j=common,Z_FIXED$1=4,Z_BINARY=0,Z_TEXT=1,Z_UNKNOWN$1=2;function zero$1(r){for(var g=r.length;--g>=0;)r[g]=0}var STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,BL_CODES$1=19,HEAP_SIZE$1=2*L_CODES$1+1,MAX_BITS$1=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],DIST_CODE_LEN=512,static_ltree=new Array((L_CODES$1+2)*2);zero$1(static_ltree);var static_dtree=new Array(D_CODES$1*2);zero$1(static_dtree);var _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);var _length_code=new Array(MAX_MATCH$1-MIN_MATCH$1+1);zero$1(_length_code);var base_length=new Array(LENGTH_CODES$1);zero$1(base_length);var base_dist=new Array(D_CODES$1);zero$1(base_dist);function StaticTreeDesc(r,g,l,v,I){this.static_tree=r,this.extra_bits=g,this.extra_base=l,this.elems=v,this.max_length=I,this.has_stree=r&&r.length}var static_l_desc,static_d_desc,static_bl_desc;function TreeDesc(r,g){this.dyn_tree=r,this.max_code=0,this.stat_desc=g}function d_code(r){return r<256?_dist_code[r]:_dist_code[256+(r>>>7)]}function put_short(r,g){r.pending_buf[r.pending++]=g&255,r.pending_buf[r.pending++]=g>>>8&255}function send_bits(r,g,l){r.bi_valid>Buf_size-l?(r.bi_buf|=g<<r.bi_valid&65535,put_short(r,r.bi_buf),r.bi_buf=g>>Buf_size-r.bi_valid,r.bi_valid+=l-Buf_size):(r.bi_buf|=g<<r.bi_valid&65535,r.bi_valid+=l)}function send_code(r,g,l){send_bits(r,l[g*2],l[g*2+1])}function bi_reverse(r,g){var l=0;do l|=r&1,r>>>=1,l<<=1;while(--g>0);return l>>>1}function bi_flush(r){r.bi_valid===16?(put_short(r,r.bi_buf),r.bi_buf=0,r.bi_valid=0):r.bi_valid>=8&&(r.pending_buf[r.pending++]=r.bi_buf&255,r.bi_buf>>=8,r.bi_valid-=8)}function gen_bitlen(r,g){var l=g.dyn_tree,v=g.max_code,I=g.stat_desc.static_tree,k=g.stat_desc.has_stree,O=g.stat_desc.extra_bits,S=g.stat_desc.extra_base,Y=g.stat_desc.max_length,L,z,Te,te,ge,Ee,be=0;for(te=0;te<=MAX_BITS$1;te++)r.bl_count[te]=0;for(l[r.heap[r.heap_max]*2+1]=0,L=r.heap_max+1;L<HEAP_SIZE$1;L++)z=r.heap[L],te=l[l[z*2+1]*2+1]+1,te>Y&&(te=Y,be++),l[z*2+1]=te,!(z>v)&&(r.bl_count[te]++,ge=0,z>=S&&(ge=O[z-S]),Ee=l[z*2],r.opt_len+=Ee*(te+ge),k&&(r.static_len+=Ee*(I[z*2+1]+ge)));if(be!==0){do{for(te=Y-1;r.bl_count[te]===0;)te--;r.bl_count[te]--,r.bl_count[te+1]+=2,r.bl_count[Y]--,be-=2}while(be>0);for(te=Y;te!==0;te--)for(z=r.bl_count[te];z!==0;)Te=r.heap[--L],!(Te>v)&&(l[Te*2+1]!==te&&(r.opt_len+=(te-l[Te*2+1])*l[Te*2],l[Te*2+1]=te),z--)}}function gen_codes(r,g,l){var v=new Array(MAX_BITS$1+1),I=0,k,O;for(k=1;k<=MAX_BITS$1;k++)v[k]=I=I+l[k-1]<<1;for(O=0;O<=g;O++){var S=r[O*2+1];S!==0&&(r[O*2]=bi_reverse(v[S]++,S))}}function tr_static_init(){var r,g,l,v,I,k=new Array(MAX_BITS$1+1);for(l=0,v=0;v<LENGTH_CODES$1-1;v++)for(base_length[v]=l,r=0;r<1<<extra_lbits[v];r++)_length_code[l++]=v;for(_length_code[l-1]=v,I=0,v=0;v<16;v++)for(base_dist[v]=I,r=0;r<1<<extra_dbits[v];r++)_dist_code[I++]=v;for(I>>=7;v<D_CODES$1;v++)for(base_dist[v]=I<<7,r=0;r<1<<extra_dbits[v]-7;r++)_dist_code[256+I++]=v;for(g=0;g<=MAX_BITS$1;g++)k[g]=0;for(r=0;r<=143;)static_ltree[r*2+1]=8,r++,k[8]++;for(;r<=255;)static_ltree[r*2+1]=9,r++,k[9]++;for(;r<=279;)static_ltree[r*2+1]=7,r++,k[7]++;for(;r<=287;)static_ltree[r*2+1]=8,r++,k[8]++;for(gen_codes(static_ltree,L_CODES$1+1,k),r=0;r<D_CODES$1;r++)static_dtree[r*2+1]=5,static_dtree[r*2]=bi_reverse(r,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS$1+1,L_CODES$1,MAX_BITS$1),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES$1,MAX_BITS$1),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES$1,MAX_BL_BITS)}function init_block(r){var g;for(g=0;g<L_CODES$1;g++)r.dyn_ltree[g*2]=0;for(g=0;g<D_CODES$1;g++)r.dyn_dtree[g*2]=0;for(g=0;g<BL_CODES$1;g++)r.bl_tree[g*2]=0;r.dyn_ltree[END_BLOCK*2]=1,r.opt_len=r.static_len=0,r.last_lit=r.matches=0}function bi_windup(r){r.bi_valid>8?put_short(r,r.bi_buf):r.bi_valid>0&&(r.pending_buf[r.pending++]=r.bi_buf),r.bi_buf=0,r.bi_valid=0}function copy_block(r,g,l,v){bi_windup(r),v&&(put_short(r,l),put_short(r,~l)),utils$j.arraySet(r.pending_buf,r.window,g,l,r.pending),r.pending+=l}function smaller(r,g,l,v){var I=g*2,k=l*2;return r[I]<r[k]||r[I]===r[k]&&v[g]<=v[l]}function pqdownheap(r,g,l){for(var v=r.heap[l],I=l<<1;I<=r.heap_len&&(I<r.heap_len&&smaller(g,r.heap[I+1],r.heap[I],r.depth)&&I++,!smaller(g,v,r.heap[I],r.depth));)r.heap[l]=r.heap[I],l=I,I<<=1;r.heap[l]=v}function compress_block(r,g,l){var v,I,k=0,O,S;if(r.last_lit!==0)do v=r.pending_buf[r.d_buf+k*2]<<8|r.pending_buf[r.d_buf+k*2+1],I=r.pending_buf[r.l_buf+k],k++,v===0?send_code(r,I,g):(O=_length_code[I],send_code(r,O+LITERALS$1+1,g),S=extra_lbits[O],S!==0&&(I-=base_length[O],send_bits(r,I,S)),v--,O=d_code(v),send_code(r,O,l),S=extra_dbits[O],S!==0&&(v-=base_dist[O],send_bits(r,v,S)));while(k<r.last_lit);send_code(r,END_BLOCK,g)}function build_tree(r,g){var l=g.dyn_tree,v=g.stat_desc.static_tree,I=g.stat_desc.has_stree,k=g.stat_desc.elems,O,S,Y=-1,L;for(r.heap_len=0,r.heap_max=HEAP_SIZE$1,O=0;O<k;O++)l[O*2]!==0?(r.heap[++r.heap_len]=Y=O,r.depth[O]=0):l[O*2+1]=0;for(;r.heap_len<2;)L=r.heap[++r.heap_len]=Y<2?++Y:0,l[L*2]=1,r.depth[L]=0,r.opt_len--,I&&(r.static_len-=v[L*2+1]);for(g.max_code=Y,O=r.heap_len>>1;O>=1;O--)pqdownheap(r,l,O);L=k;do O=r.heap[1],r.heap[1]=r.heap[r.heap_len--],pqdownheap(r,l,1),S=r.heap[1],r.heap[--r.heap_max]=O,r.heap[--r.heap_max]=S,l[L*2]=l[O*2]+l[S*2],r.depth[L]=(r.depth[O]>=r.depth[S]?r.depth[O]:r.depth[S])+1,l[O*2+1]=l[S*2+1]=L,r.heap[1]=L++,pqdownheap(r,l,1);while(r.heap_len>=2);r.heap[--r.heap_max]=r.heap[1],gen_bitlen(r,g),gen_codes(l,Y,r.bl_count)}function scan_tree(r,g,l){var v,I=-1,k,O=g[0*2+1],S=0,Y=7,L=4;for(O===0&&(Y=138,L=3),g[(l+1)*2+1]=65535,v=0;v<=l;v++)k=O,O=g[(v+1)*2+1],!(++S<Y&&k===O)&&(S<L?r.bl_tree[k*2]+=S:k!==0?(k!==I&&r.bl_tree[k*2]++,r.bl_tree[REP_3_6*2]++):S<=10?r.bl_tree[REPZ_3_10*2]++:r.bl_tree[REPZ_11_138*2]++,S=0,I=k,O===0?(Y=138,L=3):k===O?(Y=6,L=3):(Y=7,L=4))}function send_tree(r,g,l){var v,I=-1,k,O=g[0*2+1],S=0,Y=7,L=4;for(O===0&&(Y=138,L=3),v=0;v<=l;v++)if(k=O,O=g[(v+1)*2+1],!(++S<Y&&k===O)){if(S<L)do send_code(r,k,r.bl_tree);while(--S!==0);else k!==0?(k!==I&&(send_code(r,k,r.bl_tree),S--),send_code(r,REP_3_6,r.bl_tree),send_bits(r,S-3,2)):S<=10?(send_code(r,REPZ_3_10,r.bl_tree),send_bits(r,S-3,3)):(send_code(r,REPZ_11_138,r.bl_tree),send_bits(r,S-11,7));S=0,I=k,O===0?(Y=138,L=3):k===O?(Y=6,L=3):(Y=7,L=4)}}function build_bl_tree(r){var g;for(scan_tree(r,r.dyn_ltree,r.l_desc.max_code),scan_tree(r,r.dyn_dtree,r.d_desc.max_code),build_tree(r,r.bl_desc),g=BL_CODES$1-1;g>=3&&r.bl_tree[bl_order[g]*2+1]===0;g--);return r.opt_len+=3*(g+1)+5+5+4,g}function send_all_trees(r,g,l,v){var I;for(send_bits(r,g-257,5),send_bits(r,l-1,5),send_bits(r,v-4,4),I=0;I<v;I++)send_bits(r,r.bl_tree[bl_order[I]*2+1],3);send_tree(r,r.dyn_ltree,g-1),send_tree(r,r.dyn_dtree,l-1)}function detect_data_type(r){var g=4093624447,l;for(l=0;l<=31;l++,g>>>=1)if(g&1&&r.dyn_ltree[l*2]!==0)return Z_BINARY;if(r.dyn_ltree[9*2]!==0||r.dyn_ltree[10*2]!==0||r.dyn_ltree[13*2]!==0)return Z_TEXT;for(l=32;l<LITERALS$1;l++)if(r.dyn_ltree[l*2]!==0)return Z_TEXT;return Z_BINARY}var static_init_done=!1;function _tr_init(r){static_init_done||(tr_static_init(),static_init_done=!0),r.l_desc=new TreeDesc(r.dyn_ltree,static_l_desc),r.d_desc=new TreeDesc(r.dyn_dtree,static_d_desc),r.bl_desc=new TreeDesc(r.bl_tree,static_bl_desc),r.bi_buf=0,r.bi_valid=0,init_block(r)}function _tr_stored_block(r,g,l,v){send_bits(r,(STORED_BLOCK<<1)+(v?1:0),3),copy_block(r,g,l,!0)}function _tr_align(r){send_bits(r,STATIC_TREES<<1,3),send_code(r,END_BLOCK,static_ltree),bi_flush(r)}function _tr_flush_block(r,g,l,v){var I,k,O=0;r.level>0?(r.strm.data_type===Z_UNKNOWN$1&&(r.strm.data_type=detect_data_type(r)),build_tree(r,r.l_desc),build_tree(r,r.d_desc),O=build_bl_tree(r),I=r.opt_len+3+7>>>3,k=r.static_len+3+7>>>3,k<=I&&(I=k)):I=k=l+5,l+4<=I&&g!==-1?_tr_stored_block(r,g,l,v):r.strategy===Z_FIXED$1||k===I?(send_bits(r,(STATIC_TREES<<1)+(v?1:0),3),compress_block(r,static_ltree,static_dtree)):(send_bits(r,(DYN_TREES<<1)+(v?1:0),3),send_all_trees(r,r.l_desc.max_code+1,r.d_desc.max_code+1,O+1),compress_block(r,r.dyn_ltree,r.dyn_dtree)),init_block(r),v&&bi_windup(r)}function _tr_tally(r,g,l){return r.pending_buf[r.d_buf+r.last_lit*2]=g>>>8&255,r.pending_buf[r.d_buf+r.last_lit*2+1]=g&255,r.pending_buf[r.l_buf+r.last_lit]=l&255,r.last_lit++,g===0?r.dyn_ltree[l*2]++:(r.matches++,g--,r.dyn_ltree[(_length_code[l]+LITERALS$1+1)*2]++,r.dyn_dtree[d_code(g)*2]++),r.last_lit===r.lit_bufsize-1}trees$1._tr_init=_tr_init,trees$1._tr_stored_block=_tr_stored_block,trees$1._tr_flush_block=_tr_flush_block,trees$1._tr_tally=_tr_tally,trees$1._tr_align=_tr_align;function adler32$2(r,g,l,v){for(var I=r&65535|0,k=r>>>16&65535|0,O=0;l!==0;){O=l>2e3?2e3:l,l-=O;do I=I+g[v++]|0,k=k+I|0;while(--O);I%=65521,k%=65521}return I|k<<16|0}var adler32_1=adler32$2;function makeTable(){for(var r,g=[],l=0;l<256;l++){r=l;for(var v=0;v<8;v++)r=r&1?3988292384^r>>>1:r>>>1;g[l]=r}return g}var crcTable=makeTable();function crc32$3(r,g,l,v){var I=crcTable,k=v+l;r^=-1;for(var O=v;O<k;O++)r=r>>>8^I[(r^g[O])&255];return r^-1}var crc32_1=crc32$3,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},utils$i=common,trees=trees$1,adler32$1=adler32_1,crc32$2=crc32_1,msg$2=messages,Z_NO_FLUSH$1=0,Z_PARTIAL_FLUSH=1,Z_FULL_FLUSH=3,Z_FINISH$2=4,Z_BLOCK$1=5,Z_OK$2=0,Z_STREAM_END$2=1,Z_STREAM_ERROR$1=-2,Z_DATA_ERROR$1=-3,Z_BUF_ERROR$1=-5,Z_DEFAULT_COMPRESSION$1=-1,Z_FILTERED=1,Z_HUFFMAN_ONLY=2,Z_RLE=3,Z_FIXED=4,Z_DEFAULT_STRATEGY$1=0,Z_UNKNOWN=2,Z_DEFLATED$2=8,MAX_MEM_LEVEL=9,MAX_WBITS$1=15,DEF_MEM_LEVEL=8,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,PRESET_DICT=32,INIT_STATE=42,EXTRA_STATE=69,NAME_STATE=73,COMMENT_STATE=91,HCRC_STATE=103,BUSY_STATE=113,FINISH_STATE=666,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,OS_CODE=3;function err(r,g){return r.msg=msg$2[g],g}function rank(r){return(r<<1)-(r>4?9:0)}function zero(r){for(var g=r.length;--g>=0;)r[g]=0}function flush_pending(r){var g=r.state,l=g.pending;l>r.avail_out&&(l=r.avail_out),l!==0&&(utils$i.arraySet(r.output,g.pending_buf,g.pending_out,l,r.next_out),r.next_out+=l,g.pending_out+=l,r.total_out+=l,r.avail_out-=l,g.pending-=l,g.pending===0&&(g.pending_out=0))}function flush_block_only(r,g){trees._tr_flush_block(r,r.block_start>=0?r.block_start:-1,r.strstart-r.block_start,g),r.block_start=r.strstart,flush_pending(r.strm)}function put_byte(r,g){r.pending_buf[r.pending++]=g}function putShortMSB(r,g){r.pending_buf[r.pending++]=g>>>8&255,r.pending_buf[r.pending++]=g&255}function read_buf(r,g,l,v){var I=r.avail_in;return I>v&&(I=v),I===0?0:(r.avail_in-=I,utils$i.arraySet(g,r.input,r.next_in,I,l),r.state.wrap===1?r.adler=adler32$1(r.adler,g,I,l):r.state.wrap===2&&(r.adler=crc32$2(r.adler,g,I,l)),r.next_in+=I,r.total_in+=I,I)}function longest_match(r,g){var l=r.max_chain_length,v=r.strstart,I,k,O=r.prev_length,S=r.nice_match,Y=r.strstart>r.w_size-MIN_LOOKAHEAD?r.strstart-(r.w_size-MIN_LOOKAHEAD):0,L=r.window,z=r.w_mask,Te=r.prev,te=r.strstart+MAX_MATCH,ge=L[v+O-1],Ee=L[v+O];r.prev_length>=r.good_match&&(l>>=2),S>r.lookahead&&(S=r.lookahead);do if(I=g,!(L[I+O]!==Ee||L[I+O-1]!==ge||L[I]!==L[v]||L[++I]!==L[v+1])){v+=2,I++;do;while(L[++v]===L[++I]&&L[++v]===L[++I]&&L[++v]===L[++I]&&L[++v]===L[++I]&&L[++v]===L[++I]&&L[++v]===L[++I]&&L[++v]===L[++I]&&L[++v]===L[++I]&&v<te);if(k=MAX_MATCH-(te-v),v=te-MAX_MATCH,k>O){if(r.match_start=g,O=k,k>=S)break;ge=L[v+O-1],Ee=L[v+O]}}while((g=Te[g&z])>Y&&--l!==0);return O<=r.lookahead?O:r.lookahead}function fill_window(r){var g=r.w_size,l,v,I,k,O;do{if(k=r.window_size-r.lookahead-r.strstart,r.strstart>=g+(g-MIN_LOOKAHEAD)){utils$i.arraySet(r.window,r.window,g,g,0),r.match_start-=g,r.strstart-=g,r.block_start-=g,v=r.hash_size,l=v;do I=r.head[--l],r.head[l]=I>=g?I-g:0;while(--v);v=g,l=v;do I=r.prev[--l],r.prev[l]=I>=g?I-g:0;while(--v);k+=g}if(r.strm.avail_in===0)break;if(v=read_buf(r.strm,r.window,r.strstart+r.lookahead,k),r.lookahead+=v,r.lookahead+r.insert>=MIN_MATCH)for(O=r.strstart-r.insert,r.ins_h=r.window[O],r.ins_h=(r.ins_h<<r.hash_shift^r.window[O+1])&r.hash_mask;r.insert&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[O+MIN_MATCH-1])&r.hash_mask,r.prev[O&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=O,O++,r.insert--,!(r.lookahead+r.insert<MIN_MATCH)););}while(r.lookahead<MIN_LOOKAHEAD&&r.strm.avail_in!==0)}function deflate_stored(r,g){var l=65535;for(l>r.pending_buf_size-5&&(l=r.pending_buf_size-5);;){if(r.lookahead<=1){if(fill_window(r),r.lookahead===0&&g===Z_NO_FLUSH$1)return BS_NEED_MORE;if(r.lookahead===0)break}r.strstart+=r.lookahead,r.lookahead=0;var v=r.block_start+l;if((r.strstart===0||r.strstart>=v)&&(r.lookahead=r.strstart-v,r.strstart=v,flush_block_only(r,!1),r.strm.avail_out===0)||r.strstart-r.block_start>=r.w_size-MIN_LOOKAHEAD&&(flush_block_only(r,!1),r.strm.avail_out===0))return BS_NEED_MORE}return r.insert=0,g===Z_FINISH$2?(flush_block_only(r,!0),r.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):(r.strstart>r.block_start&&(flush_block_only(r,!1),r.strm.avail_out===0),BS_NEED_MORE)}function deflate_fast(r,g){for(var l,v;;){if(r.lookahead<MIN_LOOKAHEAD){if(fill_window(r),r.lookahead<MIN_LOOKAHEAD&&g===Z_NO_FLUSH$1)return BS_NEED_MORE;if(r.lookahead===0)break}if(l=0,r.lookahead>=MIN_MATCH&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+MIN_MATCH-1])&r.hash_mask,l=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),l!==0&&r.strstart-l<=r.w_size-MIN_LOOKAHEAD&&(r.match_length=longest_match(r,l)),r.match_length>=MIN_MATCH)if(v=trees._tr_tally(r,r.strstart-r.match_start,r.match_length-MIN_MATCH),r.lookahead-=r.match_length,r.match_length<=r.max_lazy_match&&r.lookahead>=MIN_MATCH){r.match_length--;do r.strstart++,r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+MIN_MATCH-1])&r.hash_mask,l=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart;while(--r.match_length!==0);r.strstart++}else r.strstart+=r.match_length,r.match_length=0,r.ins_h=r.window[r.strstart],r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+1])&r.hash_mask;else v=trees._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++;if(v&&(flush_block_only(r,!1),r.strm.avail_out===0))return BS_NEED_MORE}return r.insert=r.strstart<MIN_MATCH-1?r.strstart:MIN_MATCH-1,g===Z_FINISH$2?(flush_block_only(r,!0),r.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):r.last_lit&&(flush_block_only(r,!1),r.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_slow(r,g){for(var l,v,I;;){if(r.lookahead<MIN_LOOKAHEAD){if(fill_window(r),r.lookahead<MIN_LOOKAHEAD&&g===Z_NO_FLUSH$1)return BS_NEED_MORE;if(r.lookahead===0)break}if(l=0,r.lookahead>=MIN_MATCH&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+MIN_MATCH-1])&r.hash_mask,l=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),r.prev_length=r.match_length,r.prev_match=r.match_start,r.match_length=MIN_MATCH-1,l!==0&&r.prev_length<r.max_lazy_match&&r.strstart-l<=r.w_size-MIN_LOOKAHEAD&&(r.match_length=longest_match(r,l),r.match_length<=5&&(r.strategy===Z_FILTERED||r.match_length===MIN_MATCH&&r.strstart-r.match_start>4096)&&(r.match_length=MIN_MATCH-1)),r.prev_length>=MIN_MATCH&&r.match_length<=r.prev_length){I=r.strstart+r.lookahead-MIN_MATCH,v=trees._tr_tally(r,r.strstart-1-r.prev_match,r.prev_length-MIN_MATCH),r.lookahead-=r.prev_length-1,r.prev_length-=2;do++r.strstart<=I&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+MIN_MATCH-1])&r.hash_mask,l=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart);while(--r.prev_length!==0);if(r.match_available=0,r.match_length=MIN_MATCH-1,r.strstart++,v&&(flush_block_only(r,!1),r.strm.avail_out===0))return BS_NEED_MORE}else if(r.match_available){if(v=trees._tr_tally(r,0,r.window[r.strstart-1]),v&&flush_block_only(r,!1),r.strstart++,r.lookahead--,r.strm.avail_out===0)return BS_NEED_MORE}else r.match_available=1,r.strstart++,r.lookahead--}return r.match_available&&(v=trees._tr_tally(r,0,r.window[r.strstart-1]),r.match_available=0),r.insert=r.strstart<MIN_MATCH-1?r.strstart:MIN_MATCH-1,g===Z_FINISH$2?(flush_block_only(r,!0),r.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):r.last_lit&&(flush_block_only(r,!1),r.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_rle(r,g){for(var l,v,I,k,O=r.window;;){if(r.lookahead<=MAX_MATCH){if(fill_window(r),r.lookahead<=MAX_MATCH&&g===Z_NO_FLUSH$1)return BS_NEED_MORE;if(r.lookahead===0)break}if(r.match_length=0,r.lookahead>=MIN_MATCH&&r.strstart>0&&(I=r.strstart-1,v=O[I],v===O[++I]&&v===O[++I]&&v===O[++I])){k=r.strstart+MAX_MATCH;do;while(v===O[++I]&&v===O[++I]&&v===O[++I]&&v===O[++I]&&v===O[++I]&&v===O[++I]&&v===O[++I]&&v===O[++I]&&I<k);r.match_length=MAX_MATCH-(k-I),r.match_length>r.lookahead&&(r.match_length=r.lookahead)}if(r.match_length>=MIN_MATCH?(l=trees._tr_tally(r,1,r.match_length-MIN_MATCH),r.lookahead-=r.match_length,r.strstart+=r.match_length,r.match_length=0):(l=trees._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++),l&&(flush_block_only(r,!1),r.strm.avail_out===0))return BS_NEED_MORE}return r.insert=0,g===Z_FINISH$2?(flush_block_only(r,!0),r.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):r.last_lit&&(flush_block_only(r,!1),r.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_huff(r,g){for(var l;;){if(r.lookahead===0&&(fill_window(r),r.lookahead===0)){if(g===Z_NO_FLUSH$1)return BS_NEED_MORE;break}if(r.match_length=0,l=trees._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++,l&&(flush_block_only(r,!1),r.strm.avail_out===0))return BS_NEED_MORE}return r.insert=0,g===Z_FINISH$2?(flush_block_only(r,!0),r.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):r.last_lit&&(flush_block_only(r,!1),r.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function Config(r,g,l,v,I){this.good_length=r,this.max_lazy=g,this.nice_length=l,this.max_chain=v,this.func=I}var configuration_table;configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)];function lm_init(r){r.window_size=2*r.w_size,zero(r.head),r.max_lazy_match=configuration_table[r.level].max_lazy,r.good_match=configuration_table[r.level].good_length,r.nice_match=configuration_table[r.level].nice_length,r.max_chain_length=configuration_table[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=MIN_MATCH-1,r.match_available=0,r.ins_h=0}function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED$2,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new utils$i.Buf16(HEAP_SIZE*2),this.dyn_dtree=new utils$i.Buf16((2*D_CODES+1)*2),this.bl_tree=new utils$i.Buf16((2*BL_CODES+1)*2),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new utils$i.Buf16(MAX_BITS+1),this.heap=new utils$i.Buf16(2*L_CODES+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new utils$i.Buf16(2*L_CODES+1),zero(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function deflateResetKeep(r){var g;return!r||!r.state?err(r,Z_STREAM_ERROR$1):(r.total_in=r.total_out=0,r.data_type=Z_UNKNOWN,g=r.state,g.pending=0,g.pending_out=0,g.wrap<0&&(g.wrap=-g.wrap),g.status=g.wrap?INIT_STATE:BUSY_STATE,r.adler=g.wrap===2?0:1,g.last_flush=Z_NO_FLUSH$1,trees._tr_init(g),Z_OK$2)}function deflateReset(r){var g=deflateResetKeep(r);return g===Z_OK$2&&lm_init(r.state),g}function deflateSetHeader(r,g){return!r||!r.state||r.state.wrap!==2?Z_STREAM_ERROR$1:(r.state.gzhead=g,Z_OK$2)}function deflateInit2(r,g,l,v,I,k){if(!r)return Z_STREAM_ERROR$1;var O=1;if(g===Z_DEFAULT_COMPRESSION$1&&(g=6),v<0?(O=0,v=-v):v>15&&(O=2,v-=16),I<1||I>MAX_MEM_LEVEL||l!==Z_DEFLATED$2||v<8||v>15||g<0||g>9||k<0||k>Z_FIXED)return err(r,Z_STREAM_ERROR$1);v===8&&(v=9);var S=new DeflateState;return r.state=S,S.strm=r,S.wrap=O,S.gzhead=null,S.w_bits=v,S.w_size=1<<S.w_bits,S.w_mask=S.w_size-1,S.hash_bits=I+7,S.hash_size=1<<S.hash_bits,S.hash_mask=S.hash_size-1,S.hash_shift=~~((S.hash_bits+MIN_MATCH-1)/MIN_MATCH),S.window=new utils$i.Buf8(S.w_size*2),S.head=new utils$i.Buf16(S.hash_size),S.prev=new utils$i.Buf16(S.w_size),S.lit_bufsize=1<<I+6,S.pending_buf_size=S.lit_bufsize*4,S.pending_buf=new utils$i.Buf8(S.pending_buf_size),S.d_buf=1*S.lit_bufsize,S.l_buf=3*S.lit_bufsize,S.level=g,S.strategy=k,S.method=l,deflateReset(r)}function deflateInit(r,g){return deflateInit2(r,g,Z_DEFLATED$2,MAX_WBITS$1,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY$1)}function deflate$2(r,g){var l,v,I,k;if(!r||!r.state||g>Z_BLOCK$1||g<0)return r?err(r,Z_STREAM_ERROR$1):Z_STREAM_ERROR$1;if(v=r.state,!r.output||!r.input&&r.avail_in!==0||v.status===FINISH_STATE&&g!==Z_FINISH$2)return err(r,r.avail_out===0?Z_BUF_ERROR$1:Z_STREAM_ERROR$1);if(v.strm=r,l=v.last_flush,v.last_flush=g,v.status===INIT_STATE)if(v.wrap===2)r.adler=0,put_byte(v,31),put_byte(v,139),put_byte(v,8),v.gzhead?(put_byte(v,(v.gzhead.text?1:0)+(v.gzhead.hcrc?2:0)+(v.gzhead.extra?4:0)+(v.gzhead.name?8:0)+(v.gzhead.comment?16:0)),put_byte(v,v.gzhead.time&255),put_byte(v,v.gzhead.time>>8&255),put_byte(v,v.gzhead.time>>16&255),put_byte(v,v.gzhead.time>>24&255),put_byte(v,v.level===9?2:v.strategy>=Z_HUFFMAN_ONLY||v.level<2?4:0),put_byte(v,v.gzhead.os&255),v.gzhead.extra&&v.gzhead.extra.length&&(put_byte(v,v.gzhead.extra.length&255),put_byte(v,v.gzhead.extra.length>>8&255)),v.gzhead.hcrc&&(r.adler=crc32$2(r.adler,v.pending_buf,v.pending,0)),v.gzindex=0,v.status=EXTRA_STATE):(put_byte(v,0),put_byte(v,0),put_byte(v,0),put_byte(v,0),put_byte(v,0),put_byte(v,v.level===9?2:v.strategy>=Z_HUFFMAN_ONLY||v.level<2?4:0),put_byte(v,OS_CODE),v.status=BUSY_STATE);else{var O=Z_DEFLATED$2+(v.w_bits-8<<4)<<8,S=-1;v.strategy>=Z_HUFFMAN_ONLY||v.level<2?S=0:v.level<6?S=1:v.level===6?S=2:S=3,O|=S<<6,v.strstart!==0&&(O|=PRESET_DICT),O+=31-O%31,v.status=BUSY_STATE,putShortMSB(v,O),v.strstart!==0&&(putShortMSB(v,r.adler>>>16),putShortMSB(v,r.adler&65535)),r.adler=1}if(v.status===EXTRA_STATE)if(v.gzhead.extra){for(I=v.pending;v.gzindex<(v.gzhead.extra.length&65535)&&!(v.pending===v.pending_buf_size&&(v.gzhead.hcrc&&v.pending>I&&(r.adler=crc32$2(r.adler,v.pending_buf,v.pending-I,I)),flush_pending(r),I=v.pending,v.pending===v.pending_buf_size));)put_byte(v,v.gzhead.extra[v.gzindex]&255),v.gzindex++;v.gzhead.hcrc&&v.pending>I&&(r.adler=crc32$2(r.adler,v.pending_buf,v.pending-I,I)),v.gzindex===v.gzhead.extra.length&&(v.gzindex=0,v.status=NAME_STATE)}else v.status=NAME_STATE;if(v.status===NAME_STATE)if(v.gzhead.name){I=v.pending;do{if(v.pending===v.pending_buf_size&&(v.gzhead.hcrc&&v.pending>I&&(r.adler=crc32$2(r.adler,v.pending_buf,v.pending-I,I)),flush_pending(r),I=v.pending,v.pending===v.pending_buf_size)){k=1;break}v.gzindex<v.gzhead.name.length?k=v.gzhead.name.charCodeAt(v.gzindex++)&255:k=0,put_byte(v,k)}while(k!==0);v.gzhead.hcrc&&v.pending>I&&(r.adler=crc32$2(r.adler,v.pending_buf,v.pending-I,I)),k===0&&(v.gzindex=0,v.status=COMMENT_STATE)}else v.status=COMMENT_STATE;if(v.status===COMMENT_STATE)if(v.gzhead.comment){I=v.pending;do{if(v.pending===v.pending_buf_size&&(v.gzhead.hcrc&&v.pending>I&&(r.adler=crc32$2(r.adler,v.pending_buf,v.pending-I,I)),flush_pending(r),I=v.pending,v.pending===v.pending_buf_size)){k=1;break}v.gzindex<v.gzhead.comment.length?k=v.gzhead.comment.charCodeAt(v.gzindex++)&255:k=0,put_byte(v,k)}while(k!==0);v.gzhead.hcrc&&v.pending>I&&(r.adler=crc32$2(r.adler,v.pending_buf,v.pending-I,I)),k===0&&(v.status=HCRC_STATE)}else v.status=HCRC_STATE;if(v.status===HCRC_STATE&&(v.gzhead.hcrc?(v.pending+2>v.pending_buf_size&&flush_pending(r),v.pending+2<=v.pending_buf_size&&(put_byte(v,r.adler&255),put_byte(v,r.adler>>8&255),r.adler=0,v.status=BUSY_STATE)):v.status=BUSY_STATE),v.pending!==0){if(flush_pending(r),r.avail_out===0)return v.last_flush=-1,Z_OK$2}else if(r.avail_in===0&&rank(g)<=rank(l)&&g!==Z_FINISH$2)return err(r,Z_BUF_ERROR$1);if(v.status===FINISH_STATE&&r.avail_in!==0)return err(r,Z_BUF_ERROR$1);if(r.avail_in!==0||v.lookahead!==0||g!==Z_NO_FLUSH$1&&v.status!==FINISH_STATE){var Y=v.strategy===Z_HUFFMAN_ONLY?deflate_huff(v,g):v.strategy===Z_RLE?deflate_rle(v,g):configuration_table[v.level].func(v,g);if((Y===BS_FINISH_STARTED||Y===BS_FINISH_DONE)&&(v.status=FINISH_STATE),Y===BS_NEED_MORE||Y===BS_FINISH_STARTED)return r.avail_out===0&&(v.last_flush=-1),Z_OK$2;if(Y===BS_BLOCK_DONE&&(g===Z_PARTIAL_FLUSH?trees._tr_align(v):g!==Z_BLOCK$1&&(trees._tr_stored_block(v,0,0,!1),g===Z_FULL_FLUSH&&(zero(v.head),v.lookahead===0&&(v.strstart=0,v.block_start=0,v.insert=0))),flush_pending(r),r.avail_out===0))return v.last_flush=-1,Z_OK$2}return g!==Z_FINISH$2?Z_OK$2:v.wrap<=0?Z_STREAM_END$2:(v.wrap===2?(put_byte(v,r.adler&255),put_byte(v,r.adler>>8&255),put_byte(v,r.adler>>16&255),put_byte(v,r.adler>>24&255),put_byte(v,r.total_in&255),put_byte(v,r.total_in>>8&255),put_byte(v,r.total_in>>16&255),put_byte(v,r.total_in>>24&255)):(putShortMSB(v,r.adler>>>16),putShortMSB(v,r.adler&65535)),flush_pending(r),v.wrap>0&&(v.wrap=-v.wrap),v.pending!==0?Z_OK$2:Z_STREAM_END$2)}function deflateEnd(r){var g;return!r||!r.state?Z_STREAM_ERROR$1:(g=r.state.status,g!==INIT_STATE&&g!==EXTRA_STATE&&g!==NAME_STATE&&g!==COMMENT_STATE&&g!==HCRC_STATE&&g!==BUSY_STATE&&g!==FINISH_STATE?err(r,Z_STREAM_ERROR$1):(r.state=null,g===BUSY_STATE?err(r,Z_DATA_ERROR$1):Z_OK$2))}function deflateSetDictionary(r,g){var l=g.length,v,I,k,O,S,Y,L,z;if(!r||!r.state||(v=r.state,O=v.wrap,O===2||O===1&&v.status!==INIT_STATE||v.lookahead))return Z_STREAM_ERROR$1;for(O===1&&(r.adler=adler32$1(r.adler,g,l,0)),v.wrap=0,l>=v.w_size&&(O===0&&(zero(v.head),v.strstart=0,v.block_start=0,v.insert=0),z=new utils$i.Buf8(v.w_size),utils$i.arraySet(z,g,l-v.w_size,v.w_size,0),g=z,l=v.w_size),S=r.avail_in,Y=r.next_in,L=r.input,r.avail_in=l,r.next_in=0,r.input=g,fill_window(v);v.lookahead>=MIN_MATCH;){I=v.strstart,k=v.lookahead-(MIN_MATCH-1);do v.ins_h=(v.ins_h<<v.hash_shift^v.window[I+MIN_MATCH-1])&v.hash_mask,v.prev[I&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=I,I++;while(--k);v.strstart=I,v.lookahead=MIN_MATCH-1,fill_window(v)}return v.strstart+=v.lookahead,v.block_start=v.strstart,v.insert=v.lookahead,v.lookahead=0,v.match_length=v.prev_length=MIN_MATCH-1,v.match_available=0,r.next_in=Y,r.input=L,r.avail_in=S,v.wrap=O,Z_OK$2}deflate$3.deflateInit=deflateInit,deflate$3.deflateInit2=deflateInit2,deflate$3.deflateReset=deflateReset,deflate$3.deflateResetKeep=deflateResetKeep,deflate$3.deflateSetHeader=deflateSetHeader,deflate$3.deflate=deflate$2,deflate$3.deflateEnd=deflateEnd,deflate$3.deflateSetDictionary=deflateSetDictionary,deflate$3.deflateInfo="pako deflate (from Nodeca project)";var strings$2={},utils$h=common,STR_APPLY_OK=!0,STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,[0])}catch(r){STR_APPLY_OK=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(r){STR_APPLY_UIA_OK=!1}for(var _utf8len=new utils$h.Buf8(256),q$1=0;q$1<256;q$1++)_utf8len[q$1]=q$1>=252?6:q$1>=248?5:q$1>=240?4:q$1>=224?3:q$1>=192?2:1;_utf8len[254]=_utf8len[254]=1,strings$2.string2buf=function(r){var g,l,v,I,k,O=r.length,S=0;for(I=0;I<O;I++)l=r.charCodeAt(I),(l&64512)===55296&&I+1<O&&(v=r.charCodeAt(I+1),(v&64512)===56320&&(l=65536+(l-55296<<10)+(v-56320),I++)),S+=l<128?1:l<2048?2:l<65536?3:4;for(g=new utils$h.Buf8(S),k=0,I=0;k<S;I++)l=r.charCodeAt(I),(l&64512)===55296&&I+1<O&&(v=r.charCodeAt(I+1),(v&64512)===56320&&(l=65536+(l-55296<<10)+(v-56320),I++)),l<128?g[k++]=l:l<2048?(g[k++]=192|l>>>6,g[k++]=128|l&63):l<65536?(g[k++]=224|l>>>12,g[k++]=128|l>>>6&63,g[k++]=128|l&63):(g[k++]=240|l>>>18,g[k++]=128|l>>>12&63,g[k++]=128|l>>>6&63,g[k++]=128|l&63);return g};function buf2binstring(r,g){if(g<65534&&(r.subarray&&STR_APPLY_UIA_OK||!r.subarray&&STR_APPLY_OK))return String.fromCharCode.apply(null,utils$h.shrinkBuf(r,g));for(var l="",v=0;v<g;v++)l+=String.fromCharCode(r[v]);return l}strings$2.buf2binstring=function(r){return buf2binstring(r,r.length)},strings$2.binstring2buf=function(r){for(var g=new utils$h.Buf8(r.length),l=0,v=g.length;l<v;l++)g[l]=r.charCodeAt(l);return g},strings$2.buf2string=function(r,g){var l,v,I,k,O=g||r.length,S=new Array(O*2);for(v=0,l=0;l<O;){if(I=r[l++],I<128){S[v++]=I;continue}if(k=_utf8len[I],k>4){S[v++]=65533,l+=k-1;continue}for(I&=k===2?31:k===3?15:7;k>1&&l<O;)I=I<<6|r[l++]&63,k--;if(k>1){S[v++]=65533;continue}I<65536?S[v++]=I:(I-=65536,S[v++]=55296|I>>10&1023,S[v++]=56320|I&1023)}return buf2binstring(S,v)},strings$2.utf8border=function(r,g){var l;for(g=g||r.length,g>r.length&&(g=r.length),l=g-1;l>=0&&(r[l]&192)===128;)l--;return l<0||l===0?g:l+_utf8len[r[l]]>g?l:g};function ZStream$2(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream=ZStream$2,zlib_deflate=deflate$3,utils$g=common,strings$1=strings$2,msg$1=messages,ZStream$1=zstream,toString$1=Object.prototype.toString,Z_NO_FLUSH=0,Z_FINISH$1=4,Z_OK$1=0,Z_STREAM_END$1=1,Z_SYNC_FLUSH=2,Z_DEFAULT_COMPRESSION=-1,Z_DEFAULT_STRATEGY=0,Z_DEFLATED$1=8;function Deflate(r){if(!(this instanceof Deflate))return new Deflate(r);this.options=utils$g.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED$1,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY,to:""},r||{});var g=this.options;g.raw&&g.windowBits>0?g.windowBits=-g.windowBits:g.gzip&&g.windowBits>0&&g.windowBits<16&&(g.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream$1,this.strm.avail_out=0;var l=zlib_deflate.deflateInit2(this.strm,g.level,g.method,g.windowBits,g.memLevel,g.strategy);if(l!==Z_OK$1)throw new Error(msg$1[l]);if(g.header&&zlib_deflate.deflateSetHeader(this.strm,g.header),g.dictionary){var v;if(typeof g.dictionary=="string"?v=strings$1.string2buf(g.dictionary):toString$1.call(g.dictionary)==="[object ArrayBuffer]"?v=new Uint8Array(g.dictionary):v=g.dictionary,l=zlib_deflate.deflateSetDictionary(this.strm,v),l!==Z_OK$1)throw new Error(msg$1[l]);this._dict_set=!0}}Deflate.prototype.push=function(r,g){var l=this.strm,v=this.options.chunkSize,I,k;if(this.ended)return!1;k=g===~~g?g:g===!0?Z_FINISH$1:Z_NO_FLUSH,typeof r=="string"?l.input=strings$1.string2buf(r):toString$1.call(r)==="[object ArrayBuffer]"?l.input=new Uint8Array(r):l.input=r,l.next_in=0,l.avail_in=l.input.length;do{if(l.avail_out===0&&(l.output=new utils$g.Buf8(v),l.next_out=0,l.avail_out=v),I=zlib_deflate.deflate(l,k),I!==Z_STREAM_END$1&&I!==Z_OK$1)return this.onEnd(I),this.ended=!0,!1;(l.avail_out===0||l.avail_in===0&&(k===Z_FINISH$1||k===Z_SYNC_FLUSH))&&(this.options.to==="string"?this.onData(strings$1.buf2binstring(utils$g.shrinkBuf(l.output,l.next_out))):this.onData(utils$g.shrinkBuf(l.output,l.next_out)))}while((l.avail_in>0||l.avail_out===0)&&I!==Z_STREAM_END$1);return k===Z_FINISH$1?(I=zlib_deflate.deflateEnd(this.strm),this.onEnd(I),this.ended=!0,I===Z_OK$1):(k===Z_SYNC_FLUSH&&(this.onEnd(Z_OK$1),l.avail_out=0),!0)},Deflate.prototype.onData=function(r){this.chunks.push(r)},Deflate.prototype.onEnd=function(r){r===Z_OK$1&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=utils$g.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function deflate$1(r,g){var l=new Deflate(g);if(l.push(r,!0),l.err)throw l.msg||msg$1[l.err];return l.result}function deflateRaw(r,g){return g=g||{},g.raw=!0,deflate$1(r,g)}function gzip(r,g){return g=g||{},g.gzip=!0,deflate$1(r,g)}deflate$4.Deflate=Deflate,deflate$4.deflate=deflate$1,deflate$4.deflateRaw=deflateRaw,deflate$4.gzip=gzip;var inflate$4={},inflate$3={},BAD$1=30,TYPE$1=12,inffast=function(g,l){var v,I,k,O,S,Y,L,z,Te,te,ge,Ee,be,Se,Ae,Ie,Re,ke,De,Le,Be,Fe,ve,Ze,Oe;v=g.state,I=g.next_in,Ze=g.input,k=I+(g.avail_in-5),O=g.next_out,Oe=g.output,S=O-(l-g.avail_out),Y=O+(g.avail_out-257),L=v.dmax,z=v.wsize,Te=v.whave,te=v.wnext,ge=v.window,Ee=v.hold,be=v.bits,Se=v.lencode,Ae=v.distcode,Ie=(1<<v.lenbits)-1,Re=(1<<v.distbits)-1;e:do{be<15&&(Ee+=Ze[I++]<<be,be+=8,Ee+=Ze[I++]<<be,be+=8),ke=Se[Ee&Ie];t:for(;;){if(De=ke>>>24,Ee>>>=De,be-=De,De=ke>>>16&255,De===0)Oe[O++]=ke&65535;else if(De&16){Le=ke&65535,De&=15,De&&(be<De&&(Ee+=Ze[I++]<<be,be+=8),Le+=Ee&(1<<De)-1,Ee>>>=De,be-=De),be<15&&(Ee+=Ze[I++]<<be,be+=8,Ee+=Ze[I++]<<be,be+=8),ke=Ae[Ee&Re];r:for(;;){if(De=ke>>>24,Ee>>>=De,be-=De,De=ke>>>16&255,De&16){if(Be=ke&65535,De&=15,be<De&&(Ee+=Ze[I++]<<be,be+=8,be<De&&(Ee+=Ze[I++]<<be,be+=8)),Be+=Ee&(1<<De)-1,Be>L){g.msg="invalid distance too far back",v.mode=BAD$1;break e}if(Ee>>>=De,be-=De,De=O-S,Be>De){if(De=Be-De,De>Te&&v.sane){g.msg="invalid distance too far back",v.mode=BAD$1;break e}if(Fe=0,ve=ge,te===0){if(Fe+=z-De,De<Le){Le-=De;do Oe[O++]=ge[Fe++];while(--De);Fe=O-Be,ve=Oe}}else if(te<De){if(Fe+=z+te-De,De-=te,De<Le){Le-=De;do Oe[O++]=ge[Fe++];while(--De);if(Fe=0,te<Le){De=te,Le-=De;do Oe[O++]=ge[Fe++];while(--De);Fe=O-Be,ve=Oe}}}else if(Fe+=te-De,De<Le){Le-=De;do Oe[O++]=ge[Fe++];while(--De);Fe=O-Be,ve=Oe}for(;Le>2;)Oe[O++]=ve[Fe++],Oe[O++]=ve[Fe++],Oe[O++]=ve[Fe++],Le-=3;Le&&(Oe[O++]=ve[Fe++],Le>1&&(Oe[O++]=ve[Fe++]))}else{Fe=O-Be;do Oe[O++]=Oe[Fe++],Oe[O++]=Oe[Fe++],Oe[O++]=Oe[Fe++],Le-=3;while(Le>2);Le&&(Oe[O++]=Oe[Fe++],Le>1&&(Oe[O++]=Oe[Fe++]))}}else if((De&64)===0){ke=Ae[(ke&65535)+(Ee&(1<<De)-1)];continue r}else{g.msg="invalid distance code",v.mode=BAD$1;break e}break}}else if((De&64)===0){ke=Se[(ke&65535)+(Ee&(1<<De)-1)];continue t}else if(De&32){v.mode=TYPE$1;break e}else{g.msg="invalid literal/length code",v.mode=BAD$1;break e}break}}while(I<k&&O<Y);Le=be>>3,I-=Le,be-=Le<<3,Ee&=(1<<be)-1,g.next_in=I,g.next_out=O,g.avail_in=I<k?5+(k-I):5-(I-k),g.avail_out=O<Y?257+(Y-O):257-(O-Y),v.hold=Ee,v.bits=be},utils$f=common,MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],lext=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],dbase=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],dext=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],inftrees=function(g,l,v,I,k,O,S,Y){var L=Y.bits,z=0,Te=0,te=0,ge=0,Ee=0,be=0,Se=0,Ae=0,Ie=0,Re=0,ke,De,Le,Be,Fe,ve=null,Ze=0,Oe,Me=new utils$f.Buf16(MAXBITS+1),et=new utils$f.Buf16(MAXBITS+1),Ge=null,tt=0,rt,Ue,it;for(z=0;z<=MAXBITS;z++)Me[z]=0;for(Te=0;Te<I;Te++)Me[l[v+Te]]++;for(Ee=L,ge=MAXBITS;ge>=1&&Me[ge]===0;ge--);if(Ee>ge&&(Ee=ge),ge===0)return k[O++]=1<<24|64<<16|0,k[O++]=1<<24|64<<16|0,Y.bits=1,0;for(te=1;te<ge&&Me[te]===0;te++);for(Ee<te&&(Ee=te),Ae=1,z=1;z<=MAXBITS;z++)if(Ae<<=1,Ae-=Me[z],Ae<0)return-1;if(Ae>0&&(g===CODES$1||ge!==1))return-1;for(et[1]=0,z=1;z<MAXBITS;z++)et[z+1]=et[z]+Me[z];for(Te=0;Te<I;Te++)l[v+Te]!==0&&(S[et[l[v+Te]]++]=Te);if(g===CODES$1?(ve=Ge=S,Oe=19):g===LENS$1?(ve=lbase,Ze-=257,Ge=lext,tt-=257,Oe=256):(ve=dbase,Ge=dext,Oe=-1),Re=0,Te=0,z=te,Fe=O,be=Ee,Se=0,Le=-1,Ie=1<<Ee,Be=Ie-1,g===LENS$1&&Ie>ENOUGH_LENS$1||g===DISTS$1&&Ie>ENOUGH_DISTS$1)return 1;for(;;){rt=z-Se,S[Te]<Oe?(Ue=0,it=S[Te]):S[Te]>Oe?(Ue=Ge[tt+S[Te]],it=ve[Ze+S[Te]]):(Ue=96,it=0),ke=1<<z-Se,De=1<<be,te=De;do De-=ke,k[Fe+(Re>>Se)+De]=rt<<24|Ue<<16|it|0;while(De!==0);for(ke=1<<z-1;Re&ke;)ke>>=1;if(ke!==0?(Re&=ke-1,Re+=ke):Re=0,Te++,--Me[z]===0){if(z===ge)break;z=l[v+S[Te]]}if(z>Ee&&(Re&Be)!==Le){for(Se===0&&(Se=Ee),Fe+=te,be=z-Se,Ae=1<<be;be+Se<ge&&(Ae-=Me[be+Se],!(Ae<=0));)be++,Ae<<=1;if(Ie+=1<<be,g===LENS$1&&Ie>ENOUGH_LENS$1||g===DISTS$1&&Ie>ENOUGH_DISTS$1)return 1;Le=Re&Be,k[Le]=Ee<<24|be<<16|Fe-O|0}}return Re!==0&&(k[Fe+Re]=z-Se<<24|64<<16|0),Y.bits=Ee,0},utils$e=common,adler32=adler32_1,crc32$1=crc32_1,inflate_fast=inffast,inflate_table=inftrees,CODES=0,LENS=1,DISTS=2,Z_FINISH=4,Z_BLOCK=5,Z_TREES=6,Z_OK=0,Z_STREAM_END=1,Z_NEED_DICT=2,Z_STREAM_ERROR=-2,Z_DATA_ERROR=-3,Z_MEM_ERROR=-4,Z_BUF_ERROR=-5,Z_DEFLATED=8,HEAD=1,FLAGS=2,TIME=3,OS=4,EXLEN=5,EXTRA=6,NAME=7,COMMENT=8,HCRC=9,DICTID=10,DICT=11,TYPE=12,TYPEDO=13,STORED=14,COPY_=15,COPY=16,TABLE=17,LENLENS=18,CODELENS=19,LEN_=20,LEN=21,LENEXT=22,DIST=23,DISTEXT=24,MATCH=25,LIT=26,CHECK=27,LENGTH=28,DONE=29,BAD=30,MEM=31,SYNC=32,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS;function zswap32(r){return(r>>>24&255)+(r>>>8&65280)+((r&65280)<<8)+((r&255)<<24)}function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new utils$e.Buf16(320),this.work=new utils$e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function inflateResetKeep(r){var g;return!r||!r.state?Z_STREAM_ERROR:(g=r.state,r.total_in=r.total_out=g.total=0,r.msg="",g.wrap&&(r.adler=g.wrap&1),g.mode=HEAD,g.last=0,g.havedict=0,g.dmax=32768,g.head=null,g.hold=0,g.bits=0,g.lencode=g.lendyn=new utils$e.Buf32(ENOUGH_LENS),g.distcode=g.distdyn=new utils$e.Buf32(ENOUGH_DISTS),g.sane=1,g.back=-1,Z_OK)}function inflateReset(r){var g;return!r||!r.state?Z_STREAM_ERROR:(g=r.state,g.wsize=0,g.whave=0,g.wnext=0,inflateResetKeep(r))}function inflateReset2(r,g){var l,v;return!r||!r.state||(v=r.state,g<0?(l=0,g=-g):(l=(g>>4)+1,g<48&&(g&=15)),g&&(g<8||g>15))?Z_STREAM_ERROR:(v.window!==null&&v.wbits!==g&&(v.window=null),v.wrap=l,v.wbits=g,inflateReset(r))}function inflateInit2(r,g){var l,v;return r?(v=new InflateState,r.state=v,v.window=null,l=inflateReset2(r,g),l!==Z_OK&&(r.state=null),l):Z_STREAM_ERROR}function inflateInit(r){return inflateInit2(r,DEF_WBITS)}var virgin=!0,lenfix,distfix;function fixedtables(r){if(virgin){var g;for(lenfix=new utils$e.Buf32(512),distfix=new utils$e.Buf32(32),g=0;g<144;)r.lens[g++]=8;for(;g<256;)r.lens[g++]=9;for(;g<280;)r.lens[g++]=7;for(;g<288;)r.lens[g++]=8;for(inflate_table(LENS,r.lens,0,288,lenfix,0,r.work,{bits:9}),g=0;g<32;)r.lens[g++]=5;inflate_table(DISTS,r.lens,0,32,distfix,0,r.work,{bits:5}),virgin=!1}r.lencode=lenfix,r.lenbits=9,r.distcode=distfix,r.distbits=5}function updatewindow(r,g,l,v){var I,k=r.state;return k.window===null&&(k.wsize=1<<k.wbits,k.wnext=0,k.whave=0,k.window=new utils$e.Buf8(k.wsize)),v>=k.wsize?(utils$e.arraySet(k.window,g,l-k.wsize,k.wsize,0),k.wnext=0,k.whave=k.wsize):(I=k.wsize-k.wnext,I>v&&(I=v),utils$e.arraySet(k.window,g,l-v,I,k.wnext),v-=I,v?(utils$e.arraySet(k.window,g,l-v,v,0),k.wnext=v,k.whave=k.wsize):(k.wnext+=I,k.wnext===k.wsize&&(k.wnext=0),k.whave<k.wsize&&(k.whave+=I))),0}function inflate$2(r,g){var l,v,I,k,O,S,Y,L,z,Te,te,ge,Ee,be,Se=0,Ae,Ie,Re,ke,De,Le,Be,Fe,ve=new utils$e.Buf8(4),Ze,Oe,Me=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!r||!r.state||!r.output||!r.input&&r.avail_in!==0)return Z_STREAM_ERROR;l=r.state,l.mode===TYPE&&(l.mode=TYPEDO),O=r.next_out,I=r.output,Y=r.avail_out,k=r.next_in,v=r.input,S=r.avail_in,L=l.hold,z=l.bits,Te=S,te=Y,Fe=Z_OK;e:for(;;)switch(l.mode){case HEAD:if(l.wrap===0){l.mode=TYPEDO;break}for(;z<16;){if(S===0)break e;S--,L+=v[k++]<<z,z+=8}if(l.wrap&2&&L===35615){l.check=0,ve[0]=L&255,ve[1]=L>>>8&255,l.check=crc32$1(l.check,ve,2,0),L=0,z=0,l.mode=FLAGS;break}if(l.flags=0,l.head&&(l.head.done=!1),!(l.wrap&1)||(((L&255)<<8)+(L>>8))%31){r.msg="incorrect header check",l.mode=BAD;break}if((L&15)!==Z_DEFLATED){r.msg="unknown compression method",l.mode=BAD;break}if(L>>>=4,z-=4,Be=(L&15)+8,l.wbits===0)l.wbits=Be;else if(Be>l.wbits){r.msg="invalid window size",l.mode=BAD;break}l.dmax=1<<Be,r.adler=l.check=1,l.mode=L&512?DICTID:TYPE,L=0,z=0;break;case FLAGS:for(;z<16;){if(S===0)break e;S--,L+=v[k++]<<z,z+=8}if(l.flags=L,(l.flags&255)!==Z_DEFLATED){r.msg="unknown compression method",l.mode=BAD;break}if(l.flags&57344){r.msg="unknown header flags set",l.mode=BAD;break}l.head&&(l.head.text=L>>8&1),l.flags&512&&(ve[0]=L&255,ve[1]=L>>>8&255,l.check=crc32$1(l.check,ve,2,0)),L=0,z=0,l.mode=TIME;case TIME:for(;z<32;){if(S===0)break e;S--,L+=v[k++]<<z,z+=8}l.head&&(l.head.time=L),l.flags&512&&(ve[0]=L&255,ve[1]=L>>>8&255,ve[2]=L>>>16&255,ve[3]=L>>>24&255,l.check=crc32$1(l.check,ve,4,0)),L=0,z=0,l.mode=OS;case OS:for(;z<16;){if(S===0)break e;S--,L+=v[k++]<<z,z+=8}l.head&&(l.head.xflags=L&255,l.head.os=L>>8),l.flags&512&&(ve[0]=L&255,ve[1]=L>>>8&255,l.check=crc32$1(l.check,ve,2,0)),L=0,z=0,l.mode=EXLEN;case EXLEN:if(l.flags&1024){for(;z<16;){if(S===0)break e;S--,L+=v[k++]<<z,z+=8}l.length=L,l.head&&(l.head.extra_len=L),l.flags&512&&(ve[0]=L&255,ve[1]=L>>>8&255,l.check=crc32$1(l.check,ve,2,0)),L=0,z=0}else l.head&&(l.head.extra=null);l.mode=EXTRA;case EXTRA:if(l.flags&1024&&(ge=l.length,ge>S&&(ge=S),ge&&(l.head&&(Be=l.head.extra_len-l.length,l.head.extra||(l.head.extra=new Array(l.head.extra_len)),utils$e.arraySet(l.head.extra,v,k,ge,Be)),l.flags&512&&(l.check=crc32$1(l.check,v,ge,k)),S-=ge,k+=ge,l.length-=ge),l.length))break e;l.length=0,l.mode=NAME;case NAME:if(l.flags&2048){if(S===0)break e;ge=0;do Be=v[k+ge++],l.head&&Be&&l.length<65536&&(l.head.name+=String.fromCharCode(Be));while(Be&&ge<S);if(l.flags&512&&(l.check=crc32$1(l.check,v,ge,k)),S-=ge,k+=ge,Be)break e}else l.head&&(l.head.name=null);l.length=0,l.mode=COMMENT;case COMMENT:if(l.flags&4096){if(S===0)break e;ge=0;do Be=v[k+ge++],l.head&&Be&&l.length<65536&&(l.head.comment+=String.fromCharCode(Be));while(Be&&ge<S);if(l.flags&512&&(l.check=crc32$1(l.check,v,ge,k)),S-=ge,k+=ge,Be)break e}else l.head&&(l.head.comment=null);l.mode=HCRC;case HCRC:if(l.flags&512){for(;z<16;){if(S===0)break e;S--,L+=v[k++]<<z,z+=8}if(L!==(l.check&65535)){r.msg="header crc mismatch",l.mode=BAD;break}L=0,z=0}l.head&&(l.head.hcrc=l.flags>>9&1,l.head.done=!0),r.adler=l.check=0,l.mode=TYPE;break;case DICTID:for(;z<32;){if(S===0)break e;S--,L+=v[k++]<<z,z+=8}r.adler=l.check=zswap32(L),L=0,z=0,l.mode=DICT;case DICT:if(l.havedict===0)return r.next_out=O,r.avail_out=Y,r.next_in=k,r.avail_in=S,l.hold=L,l.bits=z,Z_NEED_DICT;r.adler=l.check=1,l.mode=TYPE;case TYPE:if(g===Z_BLOCK||g===Z_TREES)break e;case TYPEDO:if(l.last){L>>>=z&7,z-=z&7,l.mode=CHECK;break}for(;z<3;){if(S===0)break e;S--,L+=v[k++]<<z,z+=8}switch(l.last=L&1,L>>>=1,z-=1,L&3){case 0:l.mode=STORED;break;case 1:if(fixedtables(l),l.mode=LEN_,g===Z_TREES){L>>>=2,z-=2;break e}break;case 2:l.mode=TABLE;break;case 3:r.msg="invalid block type",l.mode=BAD}L>>>=2,z-=2;break;case STORED:for(L>>>=z&7,z-=z&7;z<32;){if(S===0)break e;S--,L+=v[k++]<<z,z+=8}if((L&65535)!==(L>>>16^65535)){r.msg="invalid stored block lengths",l.mode=BAD;break}if(l.length=L&65535,L=0,z=0,l.mode=COPY_,g===Z_TREES)break e;case COPY_:l.mode=COPY;case COPY:if(ge=l.length,ge){if(ge>S&&(ge=S),ge>Y&&(ge=Y),ge===0)break e;utils$e.arraySet(I,v,k,ge,O),S-=ge,k+=ge,Y-=ge,O+=ge,l.length-=ge;break}l.mode=TYPE;break;case TABLE:for(;z<14;){if(S===0)break e;S--,L+=v[k++]<<z,z+=8}if(l.nlen=(L&31)+257,L>>>=5,z-=5,l.ndist=(L&31)+1,L>>>=5,z-=5,l.ncode=(L&15)+4,L>>>=4,z-=4,l.nlen>286||l.ndist>30){r.msg="too many length or distance symbols",l.mode=BAD;break}l.have=0,l.mode=LENLENS;case LENLENS:for(;l.have<l.ncode;){for(;z<3;){if(S===0)break e;S--,L+=v[k++]<<z,z+=8}l.lens[Me[l.have++]]=L&7,L>>>=3,z-=3}for(;l.have<19;)l.lens[Me[l.have++]]=0;if(l.lencode=l.lendyn,l.lenbits=7,Ze={bits:l.lenbits},Fe=inflate_table(CODES,l.lens,0,19,l.lencode,0,l.work,Ze),l.lenbits=Ze.bits,Fe){r.msg="invalid code lengths set",l.mode=BAD;break}l.have=0,l.mode=CODELENS;case CODELENS:for(;l.have<l.nlen+l.ndist;){for(;Se=l.lencode[L&(1<<l.lenbits)-1],Ae=Se>>>24,Ie=Se>>>16&255,Re=Se&65535,!(Ae<=z);){if(S===0)break e;S--,L+=v[k++]<<z,z+=8}if(Re<16)L>>>=Ae,z-=Ae,l.lens[l.have++]=Re;else{if(Re===16){for(Oe=Ae+2;z<Oe;){if(S===0)break e;S--,L+=v[k++]<<z,z+=8}if(L>>>=Ae,z-=Ae,l.have===0){r.msg="invalid bit length repeat",l.mode=BAD;break}Be=l.lens[l.have-1],ge=3+(L&3),L>>>=2,z-=2}else if(Re===17){for(Oe=Ae+3;z<Oe;){if(S===0)break e;S--,L+=v[k++]<<z,z+=8}L>>>=Ae,z-=Ae,Be=0,ge=3+(L&7),L>>>=3,z-=3}else{for(Oe=Ae+7;z<Oe;){if(S===0)break e;S--,L+=v[k++]<<z,z+=8}L>>>=Ae,z-=Ae,Be=0,ge=11+(L&127),L>>>=7,z-=7}if(l.have+ge>l.nlen+l.ndist){r.msg="invalid bit length repeat",l.mode=BAD;break}for(;ge--;)l.lens[l.have++]=Be}}if(l.mode===BAD)break;if(l.lens[256]===0){r.msg="invalid code -- missing end-of-block",l.mode=BAD;break}if(l.lenbits=9,Ze={bits:l.lenbits},Fe=inflate_table(LENS,l.lens,0,l.nlen,l.lencode,0,l.work,Ze),l.lenbits=Ze.bits,Fe){r.msg="invalid literal/lengths set",l.mode=BAD;break}if(l.distbits=6,l.distcode=l.distdyn,Ze={bits:l.distbits},Fe=inflate_table(DISTS,l.lens,l.nlen,l.ndist,l.distcode,0,l.work,Ze),l.distbits=Ze.bits,Fe){r.msg="invalid distances set",l.mode=BAD;break}if(l.mode=LEN_,g===Z_TREES)break e;case LEN_:l.mode=LEN;case LEN:if(S>=6&&Y>=258){r.next_out=O,r.avail_out=Y,r.next_in=k,r.avail_in=S,l.hold=L,l.bits=z,inflate_fast(r,te),O=r.next_out,I=r.output,Y=r.avail_out,k=r.next_in,v=r.input,S=r.avail_in,L=l.hold,z=l.bits,l.mode===TYPE&&(l.back=-1);break}for(l.back=0;Se=l.lencode[L&(1<<l.lenbits)-1],Ae=Se>>>24,Ie=Se>>>16&255,Re=Se&65535,!(Ae<=z);){if(S===0)break e;S--,L+=v[k++]<<z,z+=8}if(Ie&&(Ie&240)===0){for(ke=Ae,De=Ie,Le=Re;Se=l.lencode[Le+((L&(1<<ke+De)-1)>>ke)],Ae=Se>>>24,Ie=Se>>>16&255,Re=Se&65535,!(ke+Ae<=z);){if(S===0)break e;S--,L+=v[k++]<<z,z+=8}L>>>=ke,z-=ke,l.back+=ke}if(L>>>=Ae,z-=Ae,l.back+=Ae,l.length=Re,Ie===0){l.mode=LIT;break}if(Ie&32){l.back=-1,l.mode=TYPE;break}if(Ie&64){r.msg="invalid literal/length code",l.mode=BAD;break}l.extra=Ie&15,l.mode=LENEXT;case LENEXT:if(l.extra){for(Oe=l.extra;z<Oe;){if(S===0)break e;S--,L+=v[k++]<<z,z+=8}l.length+=L&(1<<l.extra)-1,L>>>=l.extra,z-=l.extra,l.back+=l.extra}l.was=l.length,l.mode=DIST;case DIST:for(;Se=l.distcode[L&(1<<l.distbits)-1],Ae=Se>>>24,Ie=Se>>>16&255,Re=Se&65535,!(Ae<=z);){if(S===0)break e;S--,L+=v[k++]<<z,z+=8}if((Ie&240)===0){for(ke=Ae,De=Ie,Le=Re;Se=l.distcode[Le+((L&(1<<ke+De)-1)>>ke)],Ae=Se>>>24,Ie=Se>>>16&255,Re=Se&65535,!(ke+Ae<=z);){if(S===0)break e;S--,L+=v[k++]<<z,z+=8}L>>>=ke,z-=ke,l.back+=ke}if(L>>>=Ae,z-=Ae,l.back+=Ae,Ie&64){r.msg="invalid distance code",l.mode=BAD;break}l.offset=Re,l.extra=Ie&15,l.mode=DISTEXT;case DISTEXT:if(l.extra){for(Oe=l.extra;z<Oe;){if(S===0)break e;S--,L+=v[k++]<<z,z+=8}l.offset+=L&(1<<l.extra)-1,L>>>=l.extra,z-=l.extra,l.back+=l.extra}if(l.offset>l.dmax){r.msg="invalid distance too far back",l.mode=BAD;break}l.mode=MATCH;case MATCH:if(Y===0)break e;if(ge=te-Y,l.offset>ge){if(ge=l.offset-ge,ge>l.whave&&l.sane){r.msg="invalid distance too far back",l.mode=BAD;break}ge>l.wnext?(ge-=l.wnext,Ee=l.wsize-ge):Ee=l.wnext-ge,ge>l.length&&(ge=l.length),be=l.window}else be=I,Ee=O-l.offset,ge=l.length;ge>Y&&(ge=Y),Y-=ge,l.length-=ge;do I[O++]=be[Ee++];while(--ge);l.length===0&&(l.mode=LEN);break;case LIT:if(Y===0)break e;I[O++]=l.length,Y--,l.mode=LEN;break;case CHECK:if(l.wrap){for(;z<32;){if(S===0)break e;S--,L|=v[k++]<<z,z+=8}if(te-=Y,r.total_out+=te,l.total+=te,te&&(r.adler=l.check=l.flags?crc32$1(l.check,I,te,O-te):adler32(l.check,I,te,O-te)),te=Y,(l.flags?L:zswap32(L))!==l.check){r.msg="incorrect data check",l.mode=BAD;break}L=0,z=0}l.mode=LENGTH;case LENGTH:if(l.wrap&&l.flags){for(;z<32;){if(S===0)break e;S--,L+=v[k++]<<z,z+=8}if(L!==(l.total&4294967295)){r.msg="incorrect length check",l.mode=BAD;break}L=0,z=0}l.mode=DONE;case DONE:Fe=Z_STREAM_END;break e;case BAD:Fe=Z_DATA_ERROR;break e;case MEM:return Z_MEM_ERROR;case SYNC:default:return Z_STREAM_ERROR}return r.next_out=O,r.avail_out=Y,r.next_in=k,r.avail_in=S,l.hold=L,l.bits=z,(l.wsize||te!==r.avail_out&&l.mode<BAD&&(l.mode<CHECK||g!==Z_FINISH))&&updatewindow(r,r.output,r.next_out,te-r.avail_out),Te-=r.avail_in,te-=r.avail_out,r.total_in+=Te,r.total_out+=te,l.total+=te,l.wrap&&te&&(r.adler=l.check=l.flags?crc32$1(l.check,I,te,r.next_out-te):adler32(l.check,I,te,r.next_out-te)),r.data_type=l.bits+(l.last?64:0)+(l.mode===TYPE?128:0)+(l.mode===LEN_||l.mode===COPY_?256:0),(Te===0&&te===0||g===Z_FINISH)&&Fe===Z_OK&&(Fe=Z_BUF_ERROR),Fe}function inflateEnd(r){if(!r||!r.state)return Z_STREAM_ERROR;var g=r.state;return g.window&&(g.window=null),r.state=null,Z_OK}function inflateGetHeader(r,g){var l;return!r||!r.state||(l=r.state,(l.wrap&2)===0)?Z_STREAM_ERROR:(l.head=g,g.done=!1,Z_OK)}function inflateSetDictionary(r,g){var l=g.length,v,I,k;return!r||!r.state||(v=r.state,v.wrap!==0&&v.mode!==DICT)?Z_STREAM_ERROR:v.mode===DICT&&(I=1,I=adler32(I,g,l,0),I!==v.check)?Z_DATA_ERROR:(k=updatewindow(r,g,l,l),k?(v.mode=MEM,Z_MEM_ERROR):(v.havedict=1,Z_OK))}inflate$3.inflateReset=inflateReset,inflate$3.inflateReset2=inflateReset2,inflate$3.inflateResetKeep=inflateResetKeep,inflate$3.inflateInit=inflateInit,inflate$3.inflateInit2=inflateInit2,inflate$3.inflate=inflate$2,inflate$3.inflateEnd=inflateEnd,inflate$3.inflateGetHeader=inflateGetHeader,inflate$3.inflateSetDictionary=inflateSetDictionary,inflate$3.inflateInfo="pako inflate (from Nodeca project)";var constants$1={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};function GZheader$1(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader=GZheader$1,zlib_inflate=inflate$3,utils$d=common,strings=strings$2,c$3=constants$1,msg=messages,ZStream=zstream,GZheader=gzheader,toString=Object.prototype.toString;function Inflate(r){if(!(this instanceof Inflate))return new Inflate(r);this.options=utils$d.assign({chunkSize:16384,windowBits:0,to:""},r||{});var g=this.options;g.raw&&g.windowBits>=0&&g.windowBits<16&&(g.windowBits=-g.windowBits,g.windowBits===0&&(g.windowBits=-15)),g.windowBits>=0&&g.windowBits<16&&!(r&&r.windowBits)&&(g.windowBits+=32),g.windowBits>15&&g.windowBits<48&&(g.windowBits&15)===0&&(g.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream,this.strm.avail_out=0;var l=zlib_inflate.inflateInit2(this.strm,g.windowBits);if(l!==c$3.Z_OK)throw new Error(msg[l]);if(this.header=new GZheader,zlib_inflate.inflateGetHeader(this.strm,this.header),g.dictionary&&(typeof g.dictionary=="string"?g.dictionary=strings.string2buf(g.dictionary):toString.call(g.dictionary)==="[object ArrayBuffer]"&&(g.dictionary=new Uint8Array(g.dictionary)),g.raw&&(l=zlib_inflate.inflateSetDictionary(this.strm,g.dictionary),l!==c$3.Z_OK)))throw new Error(msg[l])}Inflate.prototype.push=function(r,g){var l=this.strm,v=this.options.chunkSize,I=this.options.dictionary,k,O,S,Y,L,z=!1;if(this.ended)return!1;O=g===~~g?g:g===!0?c$3.Z_FINISH:c$3.Z_NO_FLUSH,typeof r=="string"?l.input=strings.binstring2buf(r):toString.call(r)==="[object ArrayBuffer]"?l.input=new Uint8Array(r):l.input=r,l.next_in=0,l.avail_in=l.input.length;do{if(l.avail_out===0&&(l.output=new utils$d.Buf8(v),l.next_out=0,l.avail_out=v),k=zlib_inflate.inflate(l,c$3.Z_NO_FLUSH),k===c$3.Z_NEED_DICT&&I&&(k=zlib_inflate.inflateSetDictionary(this.strm,I)),k===c$3.Z_BUF_ERROR&&z===!0&&(k=c$3.Z_OK,z=!1),k!==c$3.Z_STREAM_END&&k!==c$3.Z_OK)return this.onEnd(k),this.ended=!0,!1;l.next_out&&(l.avail_out===0||k===c$3.Z_STREAM_END||l.avail_in===0&&(O===c$3.Z_FINISH||O===c$3.Z_SYNC_FLUSH))&&(this.options.to==="string"?(S=strings.utf8border(l.output,l.next_out),Y=l.next_out-S,L=strings.buf2string(l.output,S),l.next_out=Y,l.avail_out=v-Y,Y&&utils$d.arraySet(l.output,l.output,S,Y,0),this.onData(L)):this.onData(utils$d.shrinkBuf(l.output,l.next_out))),l.avail_in===0&&l.avail_out===0&&(z=!0)}while((l.avail_in>0||l.avail_out===0)&&k!==c$3.Z_STREAM_END);return k===c$3.Z_STREAM_END&&(O=c$3.Z_FINISH),O===c$3.Z_FINISH?(k=zlib_inflate.inflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===c$3.Z_OK):(O===c$3.Z_SYNC_FLUSH&&(this.onEnd(c$3.Z_OK),l.avail_out=0),!0)},Inflate.prototype.onData=function(r){this.chunks.push(r)},Inflate.prototype.onEnd=function(r){r===c$3.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=utils$d.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function inflate$1(r,g){var l=new Inflate(g);if(l.push(r,!0),l.err)throw l.msg||msg[l.err];return l.result}function inflateRaw(r,g){return g=g||{},g.raw=!0,inflate$1(r,g)}inflate$4.Inflate=Inflate,inflate$4.inflate=inflate$1,inflate$4.inflateRaw=inflateRaw,inflate$4.ungzip=inflate$1;var assign=common.assign,deflate=deflate$4,inflate=inflate$4,constants=constants$1,pako$1={};assign(pako$1,deflate,inflate,constants);var pako_1=pako$1,USE_TYPEDARRAY=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",pako=pako_1,utils$c=utils$r,GenericWorker$4=GenericWorker_1,ARRAY_TYPE=USE_TYPEDARRAY?"uint8array":"array";flate.magic="\b\0";function FlateWorker(r,g){GenericWorker$4.call(this,"FlateWorker/"+r),this._pako=null,this._pakoAction=r,this._pakoOptions=g,this.meta={}}utils$c.inherits(FlateWorker,GenericWorker$4),FlateWorker.prototype.processChunk=function(r){this.meta=r.meta,this._pako===null&&this._createPako(),this._pako.push(utils$c.transformTo(ARRAY_TYPE,r.data),!1)},FlateWorker.prototype.flush=function(){GenericWorker$4.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},FlateWorker.prototype.cleanUp=function(){GenericWorker$4.prototype.cleanUp.call(this),this._pako=null},FlateWorker.prototype._createPako=function(){this._pako=new pako[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var r=this;this._pako.onData=function(g){r.push({data:g,meta:r.meta})}},flate.compressWorker=function(r){return new FlateWorker("Deflate",r)},flate.uncompressWorker=function(){return new FlateWorker("Inflate",{})};var GenericWorker$3=GenericWorker_1;compressions$2.STORE={magic:"\0\0",compressWorker:function(){return new GenericWorker$3("STORE compression")},uncompressWorker:function(){return new GenericWorker$3("STORE decompression")}},compressions$2.DEFLATE=flate;var signature$1={};signature$1.LOCAL_FILE_HEADER="PK",signature$1.CENTRAL_FILE_HEADER="PK",signature$1.CENTRAL_DIRECTORY_END="PK",signature$1.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",signature$1.ZIP64_CENTRAL_DIRECTORY_END="PK",signature$1.DATA_DESCRIPTOR="PK\x07\b";var utils$b=utils$r,GenericWorker$2=GenericWorker_1,utf8$3=utf8$5,crc32=crc32_1$1,signature=signature$1,decToHex=function(r,g){var l="",v;for(v=0;v<g;v++)l+=String.fromCharCode(r&255),r=r>>>8;return l},generateUnixExternalFileAttr=function(r,g){var l=r;return r||(l=g?16893:33204),(l&65535)<<16},generateDosExternalFileAttr=function(r){return(r||0)&63},generateZipParts=function(r,g,l,v,I,k){var O=r.file,S=r.compression,Y=k!==utf8$3.utf8encode,L=utils$b.transformTo("string",k(O.name)),z=utils$b.transformTo("string",utf8$3.utf8encode(O.name)),Te=O.comment,te=utils$b.transformTo("string",k(Te)),ge=utils$b.transformTo("string",utf8$3.utf8encode(Te)),Ee=z.length!==O.name.length,be=ge.length!==Te.length,Se,Ae,Ie="",Re="",ke="",De=O.dir,Le=O.date,Be={crc32:0,compressedSize:0,uncompressedSize:0};(!g||l)&&(Be.crc32=r.crc32,Be.compressedSize=r.compressedSize,Be.uncompressedSize=r.uncompressedSize);var Fe=0;g&&(Fe|=8),!Y&&(Ee||be)&&(Fe|=2048);var ve=0,Ze=0;De&&(ve|=16),I==="UNIX"?(Ze=798,ve|=generateUnixExternalFileAttr(O.unixPermissions,De)):(Ze=20,ve|=generateDosExternalFileAttr(O.dosPermissions)),Se=Le.getUTCHours(),Se=Se<<6,Se=Se|Le.getUTCMinutes(),Se=Se<<5,Se=Se|Le.getUTCSeconds()/2,Ae=Le.getUTCFullYear()-1980,Ae=Ae<<4,Ae=Ae|Le.getUTCMonth()+1,Ae=Ae<<5,Ae=Ae|Le.getUTCDate(),Ee&&(Re=decToHex(1,1)+decToHex(crc32(L),4)+z,Ie+="up"+decToHex(Re.length,2)+Re),be&&(ke=decToHex(1,1)+decToHex(crc32(te),4)+ge,Ie+="uc"+decToHex(ke.length,2)+ke);var Oe="";Oe+=`
\0`,Oe+=decToHex(Fe,2),Oe+=S.magic,Oe+=decToHex(Se,2),Oe+=decToHex(Ae,2),Oe+=decToHex(Be.crc32,4),Oe+=decToHex(Be.compressedSize,4),Oe+=decToHex(Be.uncompressedSize,4),Oe+=decToHex(L.length,2),Oe+=decToHex(Ie.length,2);var Me=signature.LOCAL_FILE_HEADER+Oe+L+Ie,et=signature.CENTRAL_FILE_HEADER+decToHex(Ze,2)+Oe+decToHex(te.length,2)+"\0\0\0\0"+decToHex(ve,4)+decToHex(v,4)+L+Ie+te;return{fileRecord:Me,dirRecord:et}},generateCentralDirectoryEnd=function(r,g,l,v,I){var k="",O=utils$b.transformTo("string",I(v));return k=signature.CENTRAL_DIRECTORY_END+"\0\0\0\0"+decToHex(r,2)+decToHex(r,2)+decToHex(g,4)+decToHex(l,4)+decToHex(O.length,2)+O,k},generateDataDescriptors=function(r){var g="";return g=signature.DATA_DESCRIPTOR+decToHex(r.crc32,4)+decToHex(r.compressedSize,4)+decToHex(r.uncompressedSize,4),g};function ZipFileWorker$1(r,g,l,v){GenericWorker$2.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=g,this.zipPlatform=l,this.encodeFileName=v,this.streamFiles=r,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}utils$b.inherits(ZipFileWorker$1,GenericWorker$2),ZipFileWorker$1.prototype.push=function(r){var g=r.meta.percent||0,l=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(r):(this.bytesWritten+=r.data.length,GenericWorker$2.prototype.push.call(this,{data:r.data,meta:{currentFile:this.currentFile,percent:l?(g+100*(l-v-1))/l:100}}))},ZipFileWorker$1.prototype.openedSource=function(r){this.currentSourceOffset=this.bytesWritten,this.currentFile=r.file.name;var g=this.streamFiles&&!r.file.dir;if(g){var l=generateZipParts(r,g,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:l.fileRecord,meta:{percent:0}})}else this.accumulate=!0},ZipFileWorker$1.prototype.closedSource=function(r){this.accumulate=!1;var g=this.streamFiles&&!r.file.dir,l=generateZipParts(r,g,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(l.dirRecord),g)this.push({data:generateDataDescriptors(r),meta:{percent:100}});else for(this.push({data:l.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},ZipFileWorker$1.prototype.flush=function(){for(var r=this.bytesWritten,g=0;g<this.dirRecords.length;g++)this.push({data:this.dirRecords[g],meta:{percent:100}});var l=this.bytesWritten-r,v=generateCentralDirectoryEnd(this.dirRecords.length,l,r,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},ZipFileWorker$1.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},ZipFileWorker$1.prototype.registerPrevious=function(r){this._sources.push(r);var g=this;return r.on("data",function(l){g.processChunk(l)}),r.on("end",function(){g.closedSource(g.previous.streamInfo),g._sources.length?g.prepareNextSource():g.end()}),r.on("error",function(l){g.error(l)}),this},ZipFileWorker$1.prototype.resume=function(){if(!GenericWorker$2.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},ZipFileWorker$1.prototype.error=function(r){var g=this._sources;if(!GenericWorker$2.prototype.error.call(this,r))return!1;for(var l=0;l<g.length;l++)try{g[l].error(r)}catch(v){}return!0},ZipFileWorker$1.prototype.lock=function(){GenericWorker$2.prototype.lock.call(this);for(var r=this._sources,g=0;g<r.length;g++)r[g].lock()};var ZipFileWorker_1=ZipFileWorker$1,compressions$1=compressions$2,ZipFileWorker=ZipFileWorker_1,getCompression=function(r,g){var l=r||g,v=compressions$1[l];if(!v)throw new Error(l+" is not a valid compression method !");return v};generate$1.generateWorker=function(r,g,l){var v=new ZipFileWorker(g.streamFiles,l,g.platform,g.encodeFileName),I=0;try{r.forEach(function(k,O){I++;var S=getCompression(O.options.compression,g.compression),Y=O.options.compressionOptions||g.compressionOptions||{},L=O.dir,z=O.date;O._compressWorker(S,Y).withStreamInfo("file",{name:k,dir:L,date:z,comment:O.comment||"",unixPermissions:O.unixPermissions,dosPermissions:O.dosPermissions}).pipe(v)}),v.entriesCount=I}catch(k){v.error(k)}return v};var utils$a=utils$r,GenericWorker$1=GenericWorker_1;function NodejsStreamInputAdapter$1(r,g){GenericWorker$1.call(this,"Nodejs stream input adapter for "+r),this._upstreamEnded=!1,this._bindStream(g)}utils$a.inherits(NodejsStreamInputAdapter$1,GenericWorker$1),NodejsStreamInputAdapter$1.prototype._bindStream=function(r){var g=this;this._stream=r,r.pause(),r.on("data",function(l){g.push({data:l,meta:{percent:0}})}).on("error",function(l){g.isPaused?this.generatedError=l:g.error(l)}).on("end",function(){g.isPaused?g._upstreamEnded=!0:g.end()})},NodejsStreamInputAdapter$1.prototype.pause=function(){return GenericWorker$1.prototype.pause.call(this)?(this._stream.pause(),!0):!1},NodejsStreamInputAdapter$1.prototype.resume=function(){return GenericWorker$1.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1};var NodejsStreamInputAdapter_1=NodejsStreamInputAdapter$1,utf8$2=utf8$5,utils$9=utils$r,GenericWorker=GenericWorker_1,StreamHelper=StreamHelper_1,defaults=defaults$1,CompressedObject$1=compressedObject,ZipObject=zipObject,generate=generate$1,nodejsUtils$1=nodejsUtils$2,NodejsStreamInputAdapter=NodejsStreamInputAdapter_1,fileAdd=function(r,g,l){var v=utils$9.getTypeOf(g),I,k=utils$9.extend(l||{},defaults);k.date=k.date||new Date,k.compression!==null&&(k.compression=k.compression.toUpperCase()),typeof k.unixPermissions=="string"&&(k.unixPermissions=parseInt(k.unixPermissions,8)),k.unixPermissions&&k.unixPermissions&16384&&(k.dir=!0),k.dosPermissions&&k.dosPermissions&16&&(k.dir=!0),k.dir&&(r=forceTrailingSlash(r)),k.createFolders&&(I=parentFolder(r))&&folderAdd.call(this,I,!0);var O=v==="string"&&k.binary===!1&&k.base64===!1;(!l||typeof l.binary=="undefined")&&(k.binary=!O);var S=g instanceof CompressedObject$1&&g.uncompressedSize===0;(S||k.dir||!g||g.length===0)&&(k.base64=!1,k.binary=!0,g="",k.compression="STORE",v="string");var Y=null;g instanceof CompressedObject$1||g instanceof GenericWorker?Y=g:nodejsUtils$1.isNode&&nodejsUtils$1.isStream(g)?Y=new NodejsStreamInputAdapter(r,g):Y=utils$9.prepareContent(r,g,k.binary,k.optimizedBinaryString,k.base64);var L=new ZipObject(r,Y,k);this.files[r]=L},parentFolder=function(r){r.slice(-1)==="/"&&(r=r.substring(0,r.length-1));var g=r.lastIndexOf("/");return g>0?r.substring(0,g):""},forceTrailingSlash=function(r){return r.slice(-1)!=="/"&&(r+="/"),r},folderAdd=function(r,g){return g=typeof g!="undefined"?g:defaults.createFolders,r=forceTrailingSlash(r),this.files[r]||fileAdd.call(this,r,null,{dir:!0,createFolders:g}),this.files[r]};function isRegExp(r){return Object.prototype.toString.call(r)==="[object RegExp]"}var out={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(r){var g,l,v;for(g in this.files)v=this.files[g],l=g.slice(this.root.length,g.length),l&&g.slice(0,this.root.length)===this.root&&r(l,v)},filter:function(r){var g=[];return this.forEach(function(l,v){r(l,v)&&g.push(v)}),g},file:function(r,g,l){if(arguments.length===1)if(isRegExp(r)){var v=r;return this.filter(function(k,O){return!O.dir&&v.test(k)})}else{var I=this.files[this.root+r];return I&&!I.dir?I:null}else r=this.root+r,fileAdd.call(this,r,g,l);return this},folder:function(r){if(!r)return this;if(isRegExp(r))return this.filter(function(I,k){return k.dir&&r.test(I)});var g=this.root+r,l=folderAdd.call(this,g),v=this.clone();return v.root=l.name,v},remove:function(r){r=this.root+r;var g=this.files[r];if(g||(r.slice(-1)!=="/"&&(r+="/"),g=this.files[r]),g&&!g.dir)delete this.files[r];else for(var l=this.filter(function(I,k){return k.name.slice(0,r.length)===r}),v=0;v<l.length;v++)delete this.files[l[v].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(r){var g,l={};try{if(l=utils$9.extend(r||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:utf8$2.utf8encode}),l.type=l.type.toLowerCase(),l.compression=l.compression.toUpperCase(),l.type==="binarystring"&&(l.type="string"),!l.type)throw new Error("No output type specified.");utils$9.checkSupport(l.type),(l.platform==="darwin"||l.platform==="freebsd"||l.platform==="linux"||l.platform==="sunos")&&(l.platform="UNIX"),l.platform==="win32"&&(l.platform="DOS");var v=l.comment||this.comment||"";g=generate.generateWorker(this,l,v)}catch(I){g=new GenericWorker("error"),g.error(I)}return new StreamHelper(g,l.type||"string",l.mimeType)},generateAsync:function(r,g){return this.generateInternalStream(r).accumulate(g)},generateNodeStream:function(r,g){return r=r||{},r.type||(r.type="nodebuffer"),this.generateInternalStream(r).toNodejsStream(g)}},object=out,utils$8=utils$r;function DataReader$2(r){this.data=r,this.length=r.length,this.index=0,this.zero=0}DataReader$2.prototype={checkOffset:function(r){this.checkIndex(this.index+r)},checkIndex:function(r){if(this.length<this.zero+r||r<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+r+"). Corrupted zip ?")},setIndex:function(r){this.checkIndex(r),this.index=r},skip:function(r){this.setIndex(this.index+r)},byteAt:function(){},readInt:function(r){var g=0,l;for(this.checkOffset(r),l=this.index+r-1;l>=this.index;l--)g=(g<<8)+this.byteAt(l);return this.index+=r,g},readString:function(r){return utils$8.transformTo("string",this.readData(r))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var r=this.readInt(4);return new Date(Date.UTC((r>>25&127)+1980,(r>>21&15)-1,r>>16&31,r>>11&31,r>>5&63,(r&31)<<1))}};var DataReader_1=DataReader$2,DataReader$1=DataReader_1,utils$7=utils$r;function ArrayReader$2(r){DataReader$1.call(this,r);for(var g=0;g<this.data.length;g++)r[g]=r[g]&255}utils$7.inherits(ArrayReader$2,DataReader$1),ArrayReader$2.prototype.byteAt=function(r){return this.data[this.zero+r]},ArrayReader$2.prototype.lastIndexOfSignature=function(r){for(var g=r.charCodeAt(0),l=r.charCodeAt(1),v=r.charCodeAt(2),I=r.charCodeAt(3),k=this.length-4;k>=0;--k)if(this.data[k]===g&&this.data[k+1]===l&&this.data[k+2]===v&&this.data[k+3]===I)return k-this.zero;return-1},ArrayReader$2.prototype.readAndCheckSignature=function(r){var g=r.charCodeAt(0),l=r.charCodeAt(1),v=r.charCodeAt(2),I=r.charCodeAt(3),k=this.readData(4);return g===k[0]&&l===k[1]&&v===k[2]&&I===k[3]},ArrayReader$2.prototype.readData=function(r){if(this.checkOffset(r),r===0)return[];var g=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,g};var ArrayReader_1=ArrayReader$2,DataReader=DataReader_1,utils$6=utils$r;function StringReader$1(r){DataReader.call(this,r)}utils$6.inherits(StringReader$1,DataReader),StringReader$1.prototype.byteAt=function(r){return this.data.charCodeAt(this.zero+r)},StringReader$1.prototype.lastIndexOfSignature=function(r){return this.data.lastIndexOf(r)-this.zero},StringReader$1.prototype.readAndCheckSignature=function(r){var g=this.readData(4);return r===g},StringReader$1.prototype.readData=function(r){this.checkOffset(r);var g=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,g};var StringReader_1=StringReader$1,ArrayReader$1=ArrayReader_1,utils$5=utils$r;function Uint8ArrayReader$2(r){ArrayReader$1.call(this,r)}utils$5.inherits(Uint8ArrayReader$2,ArrayReader$1),Uint8ArrayReader$2.prototype.readData=function(r){if(this.checkOffset(r),r===0)return new Uint8Array(0);var g=this.data.subarray(this.zero+this.index,this.zero+this.index+r);return this.index+=r,g};var Uint8ArrayReader_1=Uint8ArrayReader$2,Uint8ArrayReader$1=Uint8ArrayReader_1,utils$4=utils$r;function NodeBufferReader$1(r){Uint8ArrayReader$1.call(this,r)}utils$4.inherits(NodeBufferReader$1,Uint8ArrayReader$1),NodeBufferReader$1.prototype.readData=function(r){this.checkOffset(r);var g=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,g};var NodeBufferReader_1=NodeBufferReader$1,utils$3=utils$r,support$2=support$5,ArrayReader=ArrayReader_1,StringReader=StringReader_1,NodeBufferReader=NodeBufferReader_1,Uint8ArrayReader=Uint8ArrayReader_1,readerFor$2=function(r){var g=utils$3.getTypeOf(r);return utils$3.checkSupport(g),g==="string"&&!support$2.uint8array?new StringReader(r):g==="nodebuffer"?new NodeBufferReader(r):support$2.uint8array?new Uint8ArrayReader(utils$3.transformTo("uint8array",r)):new ArrayReader(utils$3.transformTo("array",r))},readerFor$1=readerFor$2,utils$2=utils$r,CompressedObject=compressedObject,crc32fn=crc32_1$1,utf8$1=utf8$5,compressions=compressions$2,support$1=support$5,MADE_BY_DOS=0,MADE_BY_UNIX=3,findCompression=function(r){for(var g in compressions)if(Object.prototype.hasOwnProperty.call(compressions,g)&&compressions[g].magic===r)return compressions[g];return null};function ZipEntry$1(r,g){this.options=r,this.loadOptions=g}ZipEntry$1.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(r){var g,l;if(r.skip(22),this.fileNameLength=r.readInt(2),l=r.readInt(2),this.fileName=r.readData(this.fileNameLength),r.skip(l),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(g=findCompression(this.compressionMethod),g===null)throw new Error("Corrupted zip : compression "+utils$2.pretty(this.compressionMethod)+" unknown (inner file : "+utils$2.transformTo("string",this.fileName)+")");this.decompressed=new CompressedObject(this.compressedSize,this.uncompressedSize,this.crc32,g,r.readData(this.compressedSize))},readCentralPart:function(r){this.versionMadeBy=r.readInt(2),r.skip(2),this.bitFlag=r.readInt(2),this.compressionMethod=r.readString(2),this.date=r.readDate(),this.crc32=r.readInt(4),this.compressedSize=r.readInt(4),this.uncompressedSize=r.readInt(4);var g=r.readInt(2);if(this.extraFieldsLength=r.readInt(2),this.fileCommentLength=r.readInt(2),this.diskNumberStart=r.readInt(2),this.internalFileAttributes=r.readInt(2),this.externalFileAttributes=r.readInt(4),this.localHeaderOffset=r.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");r.skip(g),this.readExtraFields(r),this.parseZIP64ExtraField(r),this.fileComment=r.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var r=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),r===MADE_BY_DOS&&(this.dosPermissions=this.externalFileAttributes&63),r===MADE_BY_UNIX&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var r=readerFor$1(this.extraFields[1].value);this.uncompressedSize===utils$2.MAX_VALUE_32BITS&&(this.uncompressedSize=r.readInt(8)),this.compressedSize===utils$2.MAX_VALUE_32BITS&&(this.compressedSize=r.readInt(8)),this.localHeaderOffset===utils$2.MAX_VALUE_32BITS&&(this.localHeaderOffset=r.readInt(8)),this.diskNumberStart===utils$2.MAX_VALUE_32BITS&&(this.diskNumberStart=r.readInt(4))}},readExtraFields:function(r){var g=r.index+this.extraFieldsLength,l,v,I;for(this.extraFields||(this.extraFields={});r.index+4<g;)l=r.readInt(2),v=r.readInt(2),I=r.readData(v),this.extraFields[l]={id:l,length:v,value:I};r.setIndex(g)},handleUTF8:function(){var r=support$1.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=utf8$1.utf8decode(this.fileName),this.fileCommentStr=utf8$1.utf8decode(this.fileComment);else{var g=this.findExtraFieldUnicodePath();if(g!==null)this.fileNameStr=g;else{var l=utils$2.transformTo(r,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(l)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var I=utils$2.transformTo(r,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(I)}}},findExtraFieldUnicodePath:function(){var r=this.extraFields[28789];if(r){var g=readerFor$1(r.value);return g.readInt(1)!==1||crc32fn(this.fileName)!==g.readInt(4)?null:utf8$1.utf8decode(g.readData(r.length-5))}return null},findExtraFieldUnicodeComment:function(){var r=this.extraFields[25461];if(r){var g=readerFor$1(r.value);return g.readInt(1)!==1||crc32fn(this.fileComment)!==g.readInt(4)?null:utf8$1.utf8decode(g.readData(r.length-5))}return null}};var zipEntry=ZipEntry$1,readerFor=readerFor$2,utils$1=utils$r,sig=signature$1,ZipEntry=zipEntry,support=support$5;function ZipEntries$1(r){this.files=[],this.loadOptions=r}ZipEntries$1.prototype={checkSignature:function(r){if(!this.reader.readAndCheckSignature(r)){this.reader.index-=4;var g=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+utils$1.pretty(g)+", expected "+utils$1.pretty(r)+")")}},isSignature:function(r,g){var l=this.reader.index;this.reader.setIndex(r);var v=this.reader.readString(4),I=v===g;return this.reader.setIndex(l),I},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var r=this.reader.readData(this.zipCommentLength),g=support.uint8array?"uint8array":"array",l=utils$1.transformTo(g,r);this.zipComment=this.loadOptions.decodeFileName(l)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var r=this.zip64EndOfCentralSize-44,g=0,l,v,I;g<r;)l=this.reader.readInt(2),v=this.reader.readInt(4),I=this.reader.readData(v),this.zip64ExtensibleData[l]={id:l,length:v,value:I}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var r,g;for(r=0;r<this.files.length;r++)g=this.files[r],this.reader.setIndex(g.localHeaderOffset),this.checkSignature(sig.LOCAL_FILE_HEADER),g.readLocalPart(this.reader),g.handleUTF8(),g.processAttributes()},readCentralDir:function(){var r;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(sig.CENTRAL_FILE_HEADER);)r=new ZipEntry({zip64:this.zip64},this.loadOptions),r.readCentralPart(this.reader),this.files.push(r);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var r=this.reader.lastIndexOfSignature(sig.CENTRAL_DIRECTORY_END);if(r<0){var g=!this.isSignature(0,sig.LOCAL_FILE_HEADER);throw g?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(r);var l=r;if(this.checkSignature(sig.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===utils$1.MAX_VALUE_16BITS||this.diskWithCentralDirStart===utils$1.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===utils$1.MAX_VALUE_16BITS||this.centralDirRecords===utils$1.MAX_VALUE_16BITS||this.centralDirSize===utils$1.MAX_VALUE_32BITS||this.centralDirOffset===utils$1.MAX_VALUE_32BITS){if(this.zip64=!0,r=this.reader.lastIndexOfSignature(sig.ZIP64_CENTRAL_DIRECTORY_LOCATOR),r<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(r),this.checkSignature(sig.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,sig.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(sig.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(sig.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var v=this.centralDirOffset+this.centralDirSize;this.zip64&&(v+=20,v+=12+this.zip64EndOfCentralSize);var I=l-v;if(I>0)this.isSignature(l,sig.CENTRAL_FILE_HEADER)||(this.reader.zero=I);else if(I<0)throw new Error("Corrupted zip: missing "+Math.abs(I)+" bytes.")},prepareReader:function(r){this.reader=readerFor(r)},load:function(r){this.prepareReader(r),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};var zipEntries=ZipEntries$1,utils=utils$r,external=external$3,utf8=utf8$5,ZipEntries=zipEntries,Crc32Probe=Crc32Probe_1,nodejsUtils=nodejsUtils$2;function checkEntryCRC32(r){return new external.Promise(function(g,l){var v=r.decompressed.getContentWorker().pipe(new Crc32Probe);v.on("error",function(I){l(I)}).on("end",function(){v.streamInfo.crc32!==r.decompressed.crc32?l(new Error("Corrupted zip : CRC32 mismatch")):g()}).resume()})}var load=function(r,g){var l=this;return g=utils.extend(g||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:utf8.utf8decode}),nodejsUtils.isNode&&nodejsUtils.isStream(r)?external.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):utils.prepareContent("the loaded zip file",r,!0,g.optimizedBinaryString,g.base64).then(function(v){var I=new ZipEntries(g);return I.load(v),I}).then(function(I){var k=[external.Promise.resolve(I)],O=I.files;if(g.checkCRC32)for(var S=0;S<O.length;S++)k.push(checkEntryCRC32(O[S]));return external.Promise.all(k)}).then(function(I){for(var k=I.shift(),O=k.files,S=0;S<O.length;S++){var Y=O[S],L=Y.fileNameStr,z=utils.resolve(Y.fileNameStr);l.file(z,Y.decompressed,{binary:!0,optimizedBinaryString:!0,date:Y.date,dir:Y.dir,comment:Y.fileCommentStr.length?Y.fileCommentStr:null,unixPermissions:Y.unixPermissions,dosPermissions:Y.dosPermissions,createFolders:g.createFolders}),Y.dir||(l.file(z).unsafeOriginalName=L)}return k.zipComment.length&&(l.comment=k.zipComment),l})};function JSZip(){if(!(this instanceof JSZip))return new JSZip;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var r=new JSZip;for(var g in this)typeof this[g]!="function"&&(r[g]=this[g]);return r}}JSZip.prototype=object,JSZip.prototype.loadAsync=load,JSZip.support=support$5,JSZip.defaults=defaults$1,JSZip.version="3.10.1",JSZip.loadAsync=function(r,g){return new JSZip().loadAsync(r,g)},JSZip.external=external$3;var lib=JSZip;const t=r=>lib.loadAsync(r),s$1=(r,g)=>{const l=r.file(g);return l?l.async("text"):null},o=(r,g,l)=>r.file(g,l,{binary:!1}),p$2=(r,g)=>r.generateAsync({type:"uint8array",compression:"DEFLATE",compressionOptions:{level:g}});var sax={},string_decoder={},safeBuffer={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(r,g){var l=buffer$1,v=l.Buffer;function I(O,S){for(var Y in O)S[Y]=O[Y]}v.from&&v.alloc&&v.allocUnsafe&&v.allocUnsafeSlow?r.exports=l:(I(l,g),g.Buffer=k);function k(O,S,Y){return v(O,S,Y)}k.prototype=Object.create(v.prototype),I(v,k),k.from=function(O,S,Y){if(typeof O=="number")throw new TypeError("Argument must not be a number");return v(O,S,Y)},k.alloc=function(O,S,Y){if(typeof O!="number")throw new TypeError("Argument must be a number");var L=v(O);return S!==void 0?typeof Y=="string"?L.fill(S,Y):L.fill(S):L.fill(0),L},k.allocUnsafe=function(O){if(typeof O!="number")throw new TypeError("Argument must be a number");return v(O)},k.allocUnsafeSlow=function(O){if(typeof O!="number")throw new TypeError("Argument must be a number");return l.SlowBuffer(O)}})(safeBuffer,safeBuffer.exports);var Buffer$1=safeBuffer.exports.Buffer,isEncoding=Buffer$1.isEncoding||function(r){switch(r=""+r,r&&r.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function _normalizeEncoding(r){if(!r)return"utf8";for(var g;;)switch(r){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return r;default:if(g)return;r=(""+r).toLowerCase(),g=!0}}function normalizeEncoding(r){var g=_normalizeEncoding(r);if(typeof g!="string"&&(Buffer$1.isEncoding===isEncoding||!isEncoding(r)))throw new Error("Unknown encoding: "+r);return g||r}string_decoder.StringDecoder=StringDecoder;function StringDecoder(r){this.encoding=normalizeEncoding(r);var g;switch(this.encoding){case"utf16le":this.text=utf16Text,this.end=utf16End,g=4;break;case"utf8":this.fillLast=utf8FillLast,g=4;break;case"base64":this.text=base64Text,this.end=base64End,g=3;break;default:this.write=simpleWrite,this.end=simpleEnd;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=Buffer$1.allocUnsafe(g)}StringDecoder.prototype.write=function(r){if(r.length===0)return"";var g,l;if(this.lastNeed){if(g=this.fillLast(r),g===void 0)return"";l=this.lastNeed,this.lastNeed=0}else l=0;return l<r.length?g?g+this.text(r,l):this.text(r,l):g||""},StringDecoder.prototype.end=utf8End,StringDecoder.prototype.text=utf8Text,StringDecoder.prototype.fillLast=function(r){if(this.lastNeed<=r.length)return r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,r.length),this.lastNeed-=r.length};function utf8CheckByte(r){return r<=127?0:r>>5===6?2:r>>4===14?3:r>>3===30?4:r>>6===2?-1:-2}function utf8CheckIncomplete(r,g,l){var v=g.length-1;if(v<l)return 0;var I=utf8CheckByte(g[v]);return I>=0?(I>0&&(r.lastNeed=I-1),I):--v<l||I===-2?0:(I=utf8CheckByte(g[v]),I>=0?(I>0&&(r.lastNeed=I-2),I):--v<l||I===-2?0:(I=utf8CheckByte(g[v]),I>=0?(I>0&&(I===2?I=0:r.lastNeed=I-3),I):0))}function utf8CheckExtraBytes(r,g,l){if((g[0]&192)!==128)return r.lastNeed=0,"\uFFFD";if(r.lastNeed>1&&g.length>1){if((g[1]&192)!==128)return r.lastNeed=1,"\uFFFD";if(r.lastNeed>2&&g.length>2&&(g[2]&192)!==128)return r.lastNeed=2,"\uFFFD"}}function utf8FillLast(r){var g=this.lastTotal-this.lastNeed,l=utf8CheckExtraBytes(this,r);if(l!==void 0)return l;if(this.lastNeed<=r.length)return r.copy(this.lastChar,g,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,g,0,r.length),this.lastNeed-=r.length}function utf8Text(r,g){var l=utf8CheckIncomplete(this,r,g);if(!this.lastNeed)return r.toString("utf8",g);this.lastTotal=l;var v=r.length-(l-this.lastNeed);return r.copy(this.lastChar,0,v),r.toString("utf8",g,v)}function utf8End(r){var g=r&&r.length?this.write(r):"";return this.lastNeed?g+"\uFFFD":g}function utf16Text(r,g){if((r.length-g)%2===0){var l=r.toString("utf16le",g);if(l){var v=l.charCodeAt(l.length-1);if(v>=55296&&v<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1],l.slice(0,-1)}return l}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=r[r.length-1],r.toString("utf16le",g,r.length-1)}function utf16End(r){var g=r&&r.length?this.write(r):"";if(this.lastNeed){var l=this.lastTotal-this.lastNeed;return g+this.lastChar.toString("utf16le",0,l)}return g}function base64Text(r,g){var l=(r.length-g)%3;return l===0?r.toString("base64",g):(this.lastNeed=3-l,this.lastTotal=3,l===1?this.lastChar[0]=r[r.length-1]:(this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1]),r.toString("base64",g,r.length-l))}function base64End(r){var g=r&&r.length?this.write(r):"";return this.lastNeed?g+this.lastChar.toString("base64",0,3-this.lastNeed):g}function simpleWrite(r){return r.toString(this.encoding)}function simpleEnd(r){return r&&r.length?this.write(r):""}(function(r){(function(g){g.parser=function(ee,U){return new v(ee,U)},g.SAXParser=v,g.SAXStream=z,g.createStream=L,g.MAX_BUFFER_LENGTH=64*1024;var l=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];g.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function v(ee,U){if(!(this instanceof v))return new v(ee,U);var Ce=this;k(Ce),Ce.q=Ce.c="",Ce.bufferCheckPosition=g.MAX_BUFFER_LENGTH,Ce.opt=U||{},Ce.opt.lowercase=Ce.opt.lowercase||Ce.opt.lowercasetags,Ce.looseCase=Ce.opt.lowercase?"toLowerCase":"toUpperCase",Ce.tags=[],Ce.closed=Ce.closedRoot=Ce.sawRoot=!1,Ce.tag=Ce.error=null,Ce.strict=!!ee,Ce.noscript=!!(ee||Ce.opt.noscript),Ce.state=ve.BEGIN,Ce.strictEntities=Ce.opt.strictEntities,Ce.ENTITIES=Ce.strictEntities?Object.create(g.XML_ENTITIES):Object.create(g.ENTITIES),Ce.attribList=[],Ce.opt.xmlns&&(Ce.ns=Object.create(be)),Ce.trackPosition=Ce.opt.position!==!1,Ce.trackPosition&&(Ce.position=Ce.line=Ce.column=0),Oe(Ce,"onready")}Object.create||(Object.create=function(ee){function U(){}U.prototype=ee;var Ce=new U;return Ce}),Object.keys||(Object.keys=function(ee){var U=[];for(var Ce in ee)ee.hasOwnProperty(Ce)&&U.push(Ce);return U});function I(ee){for(var U=Math.max(g.MAX_BUFFER_LENGTH,10),Ce=0,xe=0,ze=l.length;xe<ze;xe++){var Ye=ee[l[xe]].length;if(Ye>U)switch(l[xe]){case"textNode":et(ee);break;case"cdata":Me(ee,"oncdata",ee.cdata),ee.cdata="";break;case"script":Me(ee,"onscript",ee.script),ee.script="";break;default:tt(ee,"Max buffer length exceeded: "+l[xe])}Ce=Math.max(Ce,Ye)}var We=g.MAX_BUFFER_LENGTH-Ce;ee.bufferCheckPosition=We+ee.position}function k(ee){for(var U=0,Ce=l.length;U<Ce;U++)ee[l[U]]=""}function O(ee){et(ee),ee.cdata!==""&&(Me(ee,"oncdata",ee.cdata),ee.cdata=""),ee.script!==""&&(Me(ee,"onscript",ee.script),ee.script="")}v.prototype={end:function(){rt(this)},write:mt,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){O(this)}};var S;try{S=require("stream").Stream}catch(ee){S=function(){}}S||(S=function(){});var Y=g.EVENTS.filter(function(ee){return ee!=="error"&&ee!=="end"});function L(ee,U){return new z(ee,U)}function z(ee,U){if(!(this instanceof z))return new z(ee,U);S.apply(this),this._parser=new v(ee,U),this.writable=!0,this.readable=!0;var Ce=this;this._parser.onend=function(){Ce.emit("end")},this._parser.onerror=function(xe){Ce.emit("error",xe),Ce._parser.error=null},this._decoder=null,Y.forEach(function(xe){Object.defineProperty(Ce,"on"+xe,{get:function(){return Ce._parser["on"+xe]},set:function(ze){if(!ze)return Ce.removeAllListeners(xe),Ce._parser["on"+xe]=ze,ze;Ce.on(xe,ze)},enumerable:!0,configurable:!1})})}z.prototype=Object.create(S.prototype,{constructor:{value:z}}),z.prototype.write=function(ee){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(ee)){if(!this._decoder){var U=string_decoder.StringDecoder;this._decoder=new U("utf8")}ee=this._decoder.write(ee)}return this._parser.write(ee.toString()),this.emit("data",ee),!0},z.prototype.end=function(ee){return ee&&ee.length&&this.write(ee),this._parser.end(),!0},z.prototype.on=function(ee,U){var Ce=this;return!Ce._parser["on"+ee]&&Y.indexOf(ee)!==-1&&(Ce._parser["on"+ee]=function(){var xe=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);xe.splice(0,0,ee),Ce.emit.apply(Ce,xe)}),S.prototype.on.call(Ce,ee,U)};var Te="[CDATA[",te="DOCTYPE",ge="http://www.w3.org/XML/1998/namespace",Ee="http://www.w3.org/2000/xmlns/",be={xml:ge,xmlns:Ee},Se=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Ae=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,Ie=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Re=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function ke(ee){return ee===" "||ee===`
`||ee==="\r"||ee==="	"}function De(ee){return ee==='"'||ee==="'"}function Le(ee){return ee===">"||ke(ee)}function Be(ee,U){return ee.test(U)}function Fe(ee,U){return!Be(ee,U)}var ve=0;g.STATE={BEGIN:ve++,BEGIN_WHITESPACE:ve++,TEXT:ve++,TEXT_ENTITY:ve++,OPEN_WAKA:ve++,SGML_DECL:ve++,SGML_DECL_QUOTED:ve++,DOCTYPE:ve++,DOCTYPE_QUOTED:ve++,DOCTYPE_DTD:ve++,DOCTYPE_DTD_QUOTED:ve++,COMMENT_STARTING:ve++,COMMENT:ve++,COMMENT_ENDING:ve++,COMMENT_ENDED:ve++,CDATA:ve++,CDATA_ENDING:ve++,CDATA_ENDING_2:ve++,PROC_INST:ve++,PROC_INST_BODY:ve++,PROC_INST_ENDING:ve++,OPEN_TAG:ve++,OPEN_TAG_SLASH:ve++,ATTRIB:ve++,ATTRIB_NAME:ve++,ATTRIB_NAME_SAW_WHITE:ve++,ATTRIB_VALUE:ve++,ATTRIB_VALUE_QUOTED:ve++,ATTRIB_VALUE_CLOSED:ve++,ATTRIB_VALUE_UNQUOTED:ve++,ATTRIB_VALUE_ENTITY_Q:ve++,ATTRIB_VALUE_ENTITY_U:ve++,CLOSE_TAG:ve++,CLOSE_TAG_SAW_WHITE:ve++,SCRIPT:ve++,SCRIPT_ENDING:ve++},g.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},g.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(g.ENTITIES).forEach(function(ee){var U=g.ENTITIES[ee],Ce=typeof U=="number"?String.fromCharCode(U):U;g.ENTITIES[ee]=Ce});for(var Ze in g.STATE)g.STATE[g.STATE[Ze]]=Ze;ve=g.STATE;function Oe(ee,U,Ce){ee[U]&&ee[U](Ce)}function Me(ee,U,Ce){ee.textNode&&et(ee),Oe(ee,U,Ce)}function et(ee){ee.textNode=Ge(ee.opt,ee.textNode),ee.textNode&&Oe(ee,"ontext",ee.textNode),ee.textNode=""}function Ge(ee,U){return ee.trim&&(U=U.trim()),ee.normalize&&(U=U.replace(/\s+/g," ")),U}function tt(ee,U){return et(ee),ee.trackPosition&&(U+=`
Line: `+ee.line+`
Column: `+ee.column+`
Char: `+ee.c),U=new Error(U),ee.error=U,Oe(ee,"onerror",U),ee}function rt(ee){return ee.sawRoot&&!ee.closedRoot&&Ue(ee,"Unclosed root tag"),ee.state!==ve.BEGIN&&ee.state!==ve.BEGIN_WHITESPACE&&ee.state!==ve.TEXT&&tt(ee,"Unexpected end"),et(ee),ee.c="",ee.closed=!0,Oe(ee,"onend"),v.call(ee,ee.strict,ee.opt),ee}function Ue(ee,U){if(typeof ee!="object"||!(ee instanceof v))throw new Error("bad call to strictFail");ee.strict&&tt(ee,U)}function it(ee){ee.strict||(ee.tagName=ee.tagName[ee.looseCase]());var U=ee.tags[ee.tags.length-1]||ee,Ce=ee.tag={name:ee.tagName,attributes:{}};ee.opt.xmlns&&(Ce.ns=U.ns),ee.attribList.length=0,Me(ee,"onopentagstart",Ce)}function st(ee,U){var Ce=ee.indexOf(":"),xe=Ce<0?["",ee]:ee.split(":"),ze=xe[0],Ye=xe[1];return U&&ee==="xmlns"&&(ze="xmlns",Ye=""),{prefix:ze,local:Ye}}function lt(ee){if(ee.strict||(ee.attribName=ee.attribName[ee.looseCase]()),ee.attribList.indexOf(ee.attribName)!==-1||ee.tag.attributes.hasOwnProperty(ee.attribName)){ee.attribName=ee.attribValue="";return}if(ee.opt.xmlns){var U=st(ee.attribName,!0),Ce=U.prefix,xe=U.local;if(Ce==="xmlns")if(xe==="xml"&&ee.attribValue!==ge)Ue(ee,"xml: prefix must be bound to "+ge+`
Actual: `+ee.attribValue);else if(xe==="xmlns"&&ee.attribValue!==Ee)Ue(ee,"xmlns: prefix must be bound to "+Ee+`
Actual: `+ee.attribValue);else{var ze=ee.tag,Ye=ee.tags[ee.tags.length-1]||ee;ze.ns===Ye.ns&&(ze.ns=Object.create(Ye.ns)),ze.ns[xe]=ee.attribValue}ee.attribList.push([ee.attribName,ee.attribValue])}else ee.tag.attributes[ee.attribName]=ee.attribValue,Me(ee,"onattribute",{name:ee.attribName,value:ee.attribValue});ee.attribName=ee.attribValue=""}function He(ee,U){if(ee.opt.xmlns){var Ce=ee.tag,xe=st(ee.tagName);Ce.prefix=xe.prefix,Ce.local=xe.local,Ce.uri=Ce.ns[xe.prefix]||"",Ce.prefix&&!Ce.uri&&(Ue(ee,"Unbound namespace prefix: "+JSON.stringify(ee.tagName)),Ce.uri=xe.prefix);var ze=ee.tags[ee.tags.length-1]||ee;Ce.ns&&ze.ns!==Ce.ns&&Object.keys(Ce.ns).forEach(function(at){Me(ee,"onopennamespace",{prefix:at,uri:Ce.ns[at]})});for(var Ye=0,We=ee.attribList.length;Ye<We;Ye++){var Qe=ee.attribList[Ye],nt=Qe[0],ft=Qe[1],Je=st(nt,!0),ot=Je.prefix,gt=Je.local,pt=ot===""?"":Ce.ns[ot]||"",ut={name:nt,value:ft,prefix:ot,local:gt,uri:pt};ot&&ot!=="xmlns"&&!pt&&(Ue(ee,"Unbound namespace prefix: "+JSON.stringify(ot)),ut.uri=ot),ee.tag.attributes[nt]=ut,Me(ee,"onattribute",ut)}ee.attribList.length=0}ee.tag.isSelfClosing=!!U,ee.sawRoot=!0,ee.tags.push(ee.tag),Me(ee,"onopentag",ee.tag),U||(!ee.noscript&&ee.tagName.toLowerCase()==="script"?ee.state=ve.SCRIPT:ee.state=ve.TEXT,ee.tag=null,ee.tagName=""),ee.attribName=ee.attribValue="",ee.attribList.length=0}function qe(ee){if(!ee.tagName){Ue(ee,"Weird empty close tag."),ee.textNode+="</>",ee.state=ve.TEXT;return}if(ee.script){if(ee.tagName!=="script"){ee.script+="</"+ee.tagName+">",ee.tagName="",ee.state=ve.SCRIPT;return}Me(ee,"onscript",ee.script),ee.script=""}var U=ee.tags.length,Ce=ee.tagName;ee.strict||(Ce=Ce[ee.looseCase]());for(var xe=Ce;U--;){var ze=ee.tags[U];if(ze.name!==xe)Ue(ee,"Unexpected close tag");else break}if(U<0){Ue(ee,"Unmatched closing tag: "+ee.tagName),ee.textNode+="</"+ee.tagName+">",ee.state=ve.TEXT;return}ee.tagName=Ce;for(var Ye=ee.tags.length;Ye-- >U;){var We=ee.tag=ee.tags.pop();ee.tagName=ee.tag.name,Me(ee,"onclosetag",ee.tagName);var Qe={};for(var nt in We.ns)Qe[nt]=We.ns[nt];var ft=ee.tags[ee.tags.length-1]||ee;ee.opt.xmlns&&We.ns!==ft.ns&&Object.keys(We.ns).forEach(function(Je){var ot=We.ns[Je];Me(ee,"onclosenamespace",{prefix:Je,uri:ot})})}U===0&&(ee.closedRoot=!0),ee.tagName=ee.attribValue=ee.attribName="",ee.attribList.length=0,ee.state=ve.TEXT}function dt(ee){var U=ee.entity,Ce=U.toLowerCase(),xe,ze="";return ee.ENTITIES[U]?ee.ENTITIES[U]:ee.ENTITIES[Ce]?ee.ENTITIES[Ce]:(U=Ce,U.charAt(0)==="#"&&(U.charAt(1)==="x"?(U=U.slice(2),xe=parseInt(U,16),ze=xe.toString(16)):(U=U.slice(1),xe=parseInt(U,10),ze=xe.toString(10))),U=U.replace(/^0+/,""),isNaN(xe)||ze.toLowerCase()!==U?(Ue(ee,"Invalid character entity"),"&"+ee.entity+";"):String.fromCodePoint(xe))}function ht(ee,U){U==="<"?(ee.state=ve.OPEN_WAKA,ee.startTagPosition=ee.position):ke(U)||(Ue(ee,"Non-whitespace before first tag."),ee.textNode=U,ee.state=ve.TEXT)}function _t(ee,U){var Ce="";return U<ee.length&&(Ce=ee.charAt(U)),Ce}function mt(ee){var U=this;if(this.error)throw this.error;if(U.closed)return tt(U,"Cannot write after close. Assign an onready handler.");if(ee===null)return rt(U);typeof ee=="object"&&(ee=ee.toString());for(var Ce=0,xe="";xe=_t(ee,Ce++),U.c=xe,!!xe;)switch(U.trackPosition&&(U.position++,xe===`
`?(U.line++,U.column=0):U.column++),U.state){case ve.BEGIN:if(U.state=ve.BEGIN_WHITESPACE,xe==="\uFEFF")continue;ht(U,xe);continue;case ve.BEGIN_WHITESPACE:ht(U,xe);continue;case ve.TEXT:if(U.sawRoot&&!U.closedRoot){for(var ze=Ce-1;xe&&xe!=="<"&&xe!=="&";)xe=_t(ee,Ce++),xe&&U.trackPosition&&(U.position++,xe===`
`?(U.line++,U.column=0):U.column++);U.textNode+=ee.substring(ze,Ce-1)}xe==="<"&&!(U.sawRoot&&U.closedRoot&&!U.strict)?(U.state=ve.OPEN_WAKA,U.startTagPosition=U.position):(!ke(xe)&&(!U.sawRoot||U.closedRoot)&&Ue(U,"Text data outside of root node."),xe==="&"?U.state=ve.TEXT_ENTITY:U.textNode+=xe);continue;case ve.SCRIPT:xe==="<"?U.state=ve.SCRIPT_ENDING:U.script+=xe;continue;case ve.SCRIPT_ENDING:xe==="/"?U.state=ve.CLOSE_TAG:(U.script+="<"+xe,U.state=ve.SCRIPT);continue;case ve.OPEN_WAKA:if(xe==="!")U.state=ve.SGML_DECL,U.sgmlDecl="";else if(!ke(xe))if(Be(Se,xe))U.state=ve.OPEN_TAG,U.tagName=xe;else if(xe==="/")U.state=ve.CLOSE_TAG,U.tagName="";else if(xe==="?")U.state=ve.PROC_INST,U.procInstName=U.procInstBody="";else{if(Ue(U,"Unencoded <"),U.startTagPosition+1<U.position){var Ye=U.position-U.startTagPosition;xe=new Array(Ye).join(" ")+xe}U.textNode+="<"+xe,U.state=ve.TEXT}continue;case ve.SGML_DECL:(U.sgmlDecl+xe).toUpperCase()===Te?(Me(U,"onopencdata"),U.state=ve.CDATA,U.sgmlDecl="",U.cdata=""):U.sgmlDecl+xe==="--"?(U.state=ve.COMMENT,U.comment="",U.sgmlDecl=""):(U.sgmlDecl+xe).toUpperCase()===te?(U.state=ve.DOCTYPE,(U.doctype||U.sawRoot)&&Ue(U,"Inappropriately located doctype declaration"),U.doctype="",U.sgmlDecl=""):xe===">"?(Me(U,"onsgmldeclaration",U.sgmlDecl),U.sgmlDecl="",U.state=ve.TEXT):(De(xe)&&(U.state=ve.SGML_DECL_QUOTED),U.sgmlDecl+=xe);continue;case ve.SGML_DECL_QUOTED:xe===U.q&&(U.state=ve.SGML_DECL,U.q=""),U.sgmlDecl+=xe;continue;case ve.DOCTYPE:xe===">"?(U.state=ve.TEXT,Me(U,"ondoctype",U.doctype),U.doctype=!0):(U.doctype+=xe,xe==="["?U.state=ve.DOCTYPE_DTD:De(xe)&&(U.state=ve.DOCTYPE_QUOTED,U.q=xe));continue;case ve.DOCTYPE_QUOTED:U.doctype+=xe,xe===U.q&&(U.q="",U.state=ve.DOCTYPE);continue;case ve.DOCTYPE_DTD:U.doctype+=xe,xe==="]"?U.state=ve.DOCTYPE:De(xe)&&(U.state=ve.DOCTYPE_DTD_QUOTED,U.q=xe);continue;case ve.DOCTYPE_DTD_QUOTED:U.doctype+=xe,xe===U.q&&(U.state=ve.DOCTYPE_DTD,U.q="");continue;case ve.COMMENT:xe==="-"?U.state=ve.COMMENT_ENDING:U.comment+=xe;continue;case ve.COMMENT_ENDING:xe==="-"?(U.state=ve.COMMENT_ENDED,U.comment=Ge(U.opt,U.comment),U.comment&&Me(U,"oncomment",U.comment),U.comment=""):(U.comment+="-"+xe,U.state=ve.COMMENT);continue;case ve.COMMENT_ENDED:xe!==">"?(Ue(U,"Malformed comment"),U.comment+="--"+xe,U.state=ve.COMMENT):U.state=ve.TEXT;continue;case ve.CDATA:xe==="]"?U.state=ve.CDATA_ENDING:U.cdata+=xe;continue;case ve.CDATA_ENDING:xe==="]"?U.state=ve.CDATA_ENDING_2:(U.cdata+="]"+xe,U.state=ve.CDATA);continue;case ve.CDATA_ENDING_2:xe===">"?(U.cdata&&Me(U,"oncdata",U.cdata),Me(U,"onclosecdata"),U.cdata="",U.state=ve.TEXT):xe==="]"?U.cdata+="]":(U.cdata+="]]"+xe,U.state=ve.CDATA);continue;case ve.PROC_INST:xe==="?"?U.state=ve.PROC_INST_ENDING:ke(xe)?U.state=ve.PROC_INST_BODY:U.procInstName+=xe;continue;case ve.PROC_INST_BODY:if(!U.procInstBody&&ke(xe))continue;xe==="?"?U.state=ve.PROC_INST_ENDING:U.procInstBody+=xe;continue;case ve.PROC_INST_ENDING:xe===">"?(Me(U,"onprocessinginstruction",{name:U.procInstName,body:U.procInstBody}),U.procInstName=U.procInstBody="",U.state=ve.TEXT):(U.procInstBody+="?"+xe,U.state=ve.PROC_INST_BODY);continue;case ve.OPEN_TAG:Be(Ae,xe)?U.tagName+=xe:(it(U),xe===">"?He(U):xe==="/"?U.state=ve.OPEN_TAG_SLASH:(ke(xe)||Ue(U,"Invalid character in tag name"),U.state=ve.ATTRIB));continue;case ve.OPEN_TAG_SLASH:xe===">"?(He(U,!0),qe(U)):(Ue(U,"Forward-slash in opening tag not followed by >"),U.state=ve.ATTRIB);continue;case ve.ATTRIB:if(ke(xe))continue;xe===">"?He(U):xe==="/"?U.state=ve.OPEN_TAG_SLASH:Be(Se,xe)?(U.attribName=xe,U.attribValue="",U.state=ve.ATTRIB_NAME):Ue(U,"Invalid attribute name");continue;case ve.ATTRIB_NAME:xe==="="?U.state=ve.ATTRIB_VALUE:xe===">"?(Ue(U,"Attribute without value"),U.attribValue=U.attribName,lt(U),He(U)):ke(xe)?U.state=ve.ATTRIB_NAME_SAW_WHITE:Be(Ae,xe)?U.attribName+=xe:Ue(U,"Invalid attribute name");continue;case ve.ATTRIB_NAME_SAW_WHITE:if(xe==="=")U.state=ve.ATTRIB_VALUE;else{if(ke(xe))continue;Ue(U,"Attribute without value"),U.tag.attributes[U.attribName]="",U.attribValue="",Me(U,"onattribute",{name:U.attribName,value:""}),U.attribName="",xe===">"?He(U):Be(Se,xe)?(U.attribName=xe,U.state=ve.ATTRIB_NAME):(Ue(U,"Invalid attribute name"),U.state=ve.ATTRIB)}continue;case ve.ATTRIB_VALUE:if(ke(xe))continue;De(xe)?(U.q=xe,U.state=ve.ATTRIB_VALUE_QUOTED):(Ue(U,"Unquoted attribute value"),U.state=ve.ATTRIB_VALUE_UNQUOTED,U.attribValue=xe);continue;case ve.ATTRIB_VALUE_QUOTED:if(xe!==U.q){xe==="&"?U.state=ve.ATTRIB_VALUE_ENTITY_Q:U.attribValue+=xe;continue}lt(U),U.q="",U.state=ve.ATTRIB_VALUE_CLOSED;continue;case ve.ATTRIB_VALUE_CLOSED:ke(xe)?U.state=ve.ATTRIB:xe===">"?He(U):xe==="/"?U.state=ve.OPEN_TAG_SLASH:Be(Se,xe)?(Ue(U,"No whitespace between attributes"),U.attribName=xe,U.attribValue="",U.state=ve.ATTRIB_NAME):Ue(U,"Invalid attribute name");continue;case ve.ATTRIB_VALUE_UNQUOTED:if(!Le(xe)){xe==="&"?U.state=ve.ATTRIB_VALUE_ENTITY_U:U.attribValue+=xe;continue}lt(U),xe===">"?He(U):U.state=ve.ATTRIB;continue;case ve.CLOSE_TAG:if(U.tagName)xe===">"?qe(U):Be(Ae,xe)?U.tagName+=xe:U.script?(U.script+="</"+U.tagName,U.tagName="",U.state=ve.SCRIPT):(ke(xe)||Ue(U,"Invalid tagname in closing tag"),U.state=ve.CLOSE_TAG_SAW_WHITE);else{if(ke(xe))continue;Fe(Se,xe)?U.script?(U.script+="</"+xe,U.state=ve.SCRIPT):Ue(U,"Invalid tagname in closing tag."):U.tagName=xe}continue;case ve.CLOSE_TAG_SAW_WHITE:if(ke(xe))continue;xe===">"?qe(U):Ue(U,"Invalid characters in closing tag");continue;case ve.TEXT_ENTITY:case ve.ATTRIB_VALUE_ENTITY_Q:case ve.ATTRIB_VALUE_ENTITY_U:var We,Qe;switch(U.state){case ve.TEXT_ENTITY:We=ve.TEXT,Qe="textNode";break;case ve.ATTRIB_VALUE_ENTITY_Q:We=ve.ATTRIB_VALUE_QUOTED,Qe="attribValue";break;case ve.ATTRIB_VALUE_ENTITY_U:We=ve.ATTRIB_VALUE_UNQUOTED,Qe="attribValue";break}if(xe===";")if(U.opt.unparsedEntities){var nt=dt(U);U.entity="",U.state=We,U.write(nt)}else U[Qe]+=dt(U),U.entity="",U.state=We;else Be(U.entity.length?Re:Ie,xe)?U.entity+=xe:(Ue(U,"Invalid character in entity name"),U[Qe]+="&"+U.entity+xe,U.entity="",U.state=We);continue;default:throw new Error(U,"Unknown state: "+U.state)}return U.position>=U.bufferCheckPosition&&I(U),U}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var ee=String.fromCharCode,U=Math.floor,Ce=function(){var xe=16384,ze=[],Ye,We,Qe=-1,nt=arguments.length;if(!nt)return"";for(var ft="";++Qe<nt;){var Je=Number(arguments[Qe]);if(!isFinite(Je)||Je<0||Je>1114111||U(Je)!==Je)throw RangeError("Invalid code point: "+Je);Je<=65535?ze.push(Je):(Je-=65536,Ye=(Je>>10)+55296,We=Je%1024+56320,ze.push(Ye,We)),(Qe+1===nt||ze.length>xe)&&(ft+=ee.apply(null,ze),ze.length=0)}return ft};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:Ce,configurable:!0,writable:!0}):String.fromCodePoint=Ce}()})(r)})(sax);const logger={debug:()=>{}},_$2=r=>{const g=sax.parser(!0,{trim:!1,normalize:!1});let l,v=null;return new Promise((I,k)=>{g.onopentag=O=>{const S={_parent:v||void 0,_children:[],_fTextNode:!1,_tag:O.name,_attrs:O.attributes};v!=null?v._children.push(S):l=S,v=S},g.onclosetag=()=>{v=v!=null?v._parent:null},g.ontext=O=>{v!=null&&v._children.push({_parent:v,_children:[],_fTextNode:!0,_text:O})},g.onend=()=>{I(l)},g.onerror=O=>{k(O)},g.write(r),g.end()})};function m$1(r,g,l="",v=!0){const I=l.length||!v?"":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>',k=[Buffer.from(I,"utf-8")];if(r._fTextNode)k.push(Buffer.from(N(r._text,g)));else{let O="";const S=r._attrs;Object.keys(S).forEach(te=>{O+=` ${te}="${x$1(S[te])}"`});const Y=r._children.length>0,L=Y?"":"/",z=g.indentXml?`
${l}`:"";k.push(Buffer.from(`${z}<${r._tag}${O}${L}>`));let Te=!1;if(r._children.forEach(te=>{k.push(m$1(te,g,g.indentXml?`${l}  `:"",!1)),Te=!te._fTextNode}),Y){const te=g.indentXml&&Te?`
${l}`:"";k.push(Buffer.from(`${te}</${r._tag}>`))}}return Buffer.concat(k)}const h$2={"&":"&amp;","<":"&lt;",">":"&gt;"},T=/[&<>]/g,E$1={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"},X$2=/[&<>'"]/g,N=(r,g)=>{const l=r.split(g.literalXmlDelimiter),v=[];let I=!1;for(let k=0;k<l.length;k++){const O=l[k];v.push(I?O:O.replace(T,S=>h$2[S])),I=!I}return v.join("")},x$1=r=>(typeof r=="string"?r:r.value).replace(X$2,g=>E$1[g]);var n=Object.defineProperty,c$2=(r,g,l)=>g in r?n(r,g,{enumerable:!0,configurable:!0,writable:!0,value:l}):r[g]=l,e=(r,g,l)=>c$2(r,typeof g!="symbol"?g+"":g,l);function isError(r){return r instanceof Error||typeof r=="object"&&!!r&&"name"in r&&"message"in r}class NullishCommandResultError extends Error{constructor(g){super(`Result of command ${g} is null or undefined and rejectNullish is set`),e(this,"command"),Object.setPrototypeOf(this,NullishCommandResultError.prototype),this.command=g}}class ObjectCommandResultError extends Error{constructor(g,l){super(`Result of command '${g}' is an object`),e(this,"command"),e(this,"result"),Object.setPrototypeOf(this,ObjectCommandResultError.prototype),this.command=g,this.result=l}}class CommandSyntaxError extends Error{constructor(g){super(`Invalid command syntax: ${g}`),e(this,"command"),Object.setPrototypeOf(this,CommandSyntaxError.prototype),this.command=g}}class InvalidCommandError extends Error{constructor(g,l){super(`${g}: ${l}`),e(this,"command"),Object.setPrototypeOf(this,InvalidCommandError.prototype),this.command=l}}class CommandExecutionError extends Error{constructor(g,l){super(`Error executing command '${l}': ${g.name}: ${g.message}`),e(this,"command"),e(this,"err"),Object.setPrototypeOf(this,CommandExecutionError.prototype),this.command=l,this.err=g}}class ImageError extends CommandExecutionError{}class InternalError extends Error{constructor(g){super(`INTERNAL ERROR: ${g}`)}}class TemplateParseError extends Error{}class IncompleteConditionalStatementError extends Error{constructor(){super("Incomplete IF/END-IF statement. Make sure each IF-statement has a corresponding END-IF command.")}}class UnterminatedForLoopError extends Error{constructor(g){super(`Unterminated FOR-loop ('FOR ${g.varName}'). Make sure each FOR loop has a corresponding END-FOR command.`)}}const i=r=>r._fTextNode?{_children:[],_fTextNode:!0,_text:r._text}:{_children:[],_fTextNode:!1,_tag:r._tag,_attrs:r._attrs},_$1=r=>{const g=r._parent;if(g==null)return null;const l=g._children,v=l.indexOf(r);return v<0||v>=l.length-1?null:l[v+1]},a$1=r=>{const g=r._parent;if(!(g&&!g._fTextNode&&g._tag==="w:t"))throw new TemplateParseError("Template syntax error: text node not within w:t");const l=g._parent;if(l==null)throw new TemplateParseError("Template syntax error: w:t node has no parent");const v=l._children.indexOf(g);if(v<0)throw new TemplateParseError("Template syntax error");const I=i(g);I._parent=l;const k={_parent:I,_children:[],_fTextNode:!0,_text:""};return I._children=[k],l._children.splice(v+1,0,I),k},c$1=(r,g={},l=[])=>{const v={_fTextNode:!1,_tag:r,_attrs:g,_children:l};return v._children.forEach(I=>{I._parent=v}),v},u=r=>({_children:[],_fTextNode:!0,_text:r}),p$1=(r,g)=>(r._children.push(g),g._parent=r,g),s=r=>r.loops.length?r.loops[r.loops.length-1]:null,f$1=r=>{const g=s(r);return g!=null&&g.idx<0},h$1=r=>{if(!r.length)return;const g=r.length-1,{varName:l,idx:v,loopOver:I,isIf:k}=r[g],O=v>=0?v+1:"EXPLORATION";logger.debug(`${k?"IF":"FOR"} loop on ${g}:${l}${O}/${I.length}`)},p=(r,g,l)=>{let v=r,I=!1,k=null,O=0;const S=`${g[0]}CMD_NODE${g[1]}`;for(;v!=null;){if(l&&!v._fTextNode&&v._tag==="w:t"&&(v._attrs["xml:space"]="preserve"),!v._fTextNode&&v._tag==="w:p"&&k&&(k._text+=" "),v._fTextNode&&v._parent&&!v._parent._fTextNode&&v._parent._tag==="w:t"){k==null&&(k=v);const Y=v._text;v._text="";for(let L=0;L<Y.length;L++){const z=Y[L],Te=I?g[1]:g[0];if(z===Te[O]){if(O+=1,O===Te.length){I=!I;const te=v===k;I&&k._text.length&&(k=a$1(k),te&&(v=k)),k._text+=Te,!I&&L<Y.length-1&&(k=a$1(k),te&&(v=k)),O=0,I||(k=v)}}else O&&(k._text+=Te.slice(0,O),O=0,I||(k=v)),k._text+=z}!I&&!O&&(k=null),Y.length&&!v._text.length&&(v._text=S)}if(v._children.length)v=v._children[0];else{let Y=!1;for(;v._parent!=null;){const L=v._parent,z=_$1(v);if(z){Y=!0,v=z;break}v=L}Y||(v=null)}}return r};var vmBrowserify={};(function(exports){var indexOf=function(r,g){if(r.indexOf)return r.indexOf(g);for(var l=0;l<r.length;l++)if(r[l]===g)return l;return-1},Object_keys=function(r){if(Object.keys)return Object.keys(r);var g=[];for(var l in r)g.push(l);return g},forEach=function(r,g){if(r.forEach)return r.forEach(g);for(var l=0;l<r.length;l++)g(r[l],l,r)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(r,g,l){Object.defineProperty(r,g,{writable:!0,enumerable:!1,configurable:!0,value:l})}}catch(r){return function(g,l,v){g[l]=v}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}Context.prototype={};var Script=exports.Script=function(g){if(!(this instanceof Script))return new Script(g);this.code=g};Script.prototype.runInContext=function(r){if(!(r instanceof Context))throw new TypeError("needs a 'context' argument.");var g=document.createElement("iframe");g.style||(g.style={}),g.style.display="none",document.body.appendChild(g);var l=g.contentWindow,v=l.eval,I=l.execScript;!v&&I&&(I.call(l,"null"),v=l.eval),forEach(Object_keys(r),function(S){l[S]=r[S]}),forEach(globals,function(S){r[S]&&(l[S]=r[S])});var k=Object_keys(l),O=v.call(l,this.code);return forEach(Object_keys(l),function(S){(S in r||indexOf(k,S)===-1)&&(r[S]=l[S])}),forEach(globals,function(S){S in r||defineProp(r,S,l[S])}),document.body.removeChild(g),O},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(r){var g=Script.createContext(r),l=this.runInContext(g);return r&&forEach(Object_keys(g),function(v){r[v]=g[v]}),l},forEach(Object_keys(Script.prototype),function(r){exports[r]=Script[r]=function(g){var l=Script(g);return l[r].apply(l,[].slice.call(arguments,1))}}),exports.isContext=function(r){return r instanceof Context},exports.createScript=function(r){return exports.Script(r)},exports.createContext=Script.createContext=function(r){var g=new Context;return typeof r=="object"&&forEach(Object_keys(r),function(l){g[l]=r[l]}),g}})(vmBrowserify);var w=Object.defineProperty,C=Object.defineProperties,c=Object.getOwnPropertyDescriptors,_=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable,m=(r,g,l)=>g in r?w(r,g,{enumerable:!0,configurable:!0,writable:!0,value:l}):r[g]=l,a=(r,g)=>{for(var l in g||(g={}))h.call(g,l)&&m(r,l,g[l]);if(_)for(var l of _(g))b.call(g,l)&&m(r,l,g[l]);return r},d=(r,g)=>C(r,c(g));async function runUserJsAndGetRaw(r,g,l){var v;const I=a(a(d(a({},l.jsSandbox||{}),{__code__:g,__result__:void 0}),r),l.options.additionalJsContext),k=s(l);k&&(I.$idx=k.idx),Object.keys(l.vars).forEach(Y=>{I[`$${Y}`]=l.vars[Y]});let O,S;try{if(l.options.runJs){const Y=l.options.runJs({sandbox:I,ctx:l});O=Y.modifiedSandbox,S=await Y.result}else if(l.options.noSandbox)O=I,S=await new Function("with(this) { return eval(__code__); }").call(O);else{const Y=new vmBrowserify.Script((v=I.__code__)!=null?v:"");O=vmBrowserify.createContext(I),S=await Y.runInContext(O)}}catch(Y){const L=isError(Y)?Y:new Error(`${Y}`);if(l.options.errorHandler!=null)O=I,S=await l.options.errorHandler(L,g);else throw new CommandExecutionError(L,g)}if(l.options.rejectNullish&&S==null){const Y=new NullishCommandResultError(g);if(l.options.errorHandler!=null)S=await l.options.errorHandler(Y,g);else throw Y}return l.jsSandbox=d(a({},O),{__code__:void 0,__result__:void 0}),S}const ImageExtensions=[".png",".gif",".jpg",".jpeg",".svg"],BUILT_IN_COMMANDS=["QUERY","CMD_NODE","ALIAS","FOR","END-FOR","IF","END-IF","INS","EXEC","IMAGE","LINK","HTML"];class Node{constructor(g){this.value=g,this.next=void 0}}let Queue$1=class{constructor(){this.clear()}enqueue(g){const l=new Node(g);this._head?(this._tail.next=l,this._tail=l):(this._head=l,this._tail=l),this._size++}dequeue(){const g=this._head;if(g)return this._head=this._head.next,this._size--,g.value}clear(){this._head=void 0,this._tail=void 0,this._size=0}get size(){return this._size}*[Symbol.iterator](){let g=this._head;for(;g;)yield g.value,g=g.next}};var yoctoQueue=Queue$1;const Queue=yoctoQueue,pLimit=r=>{if(!((Number.isInteger(r)||r===1/0)&&r>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");const g=new Queue;let l=0;const v=()=>{l--,g.size>0&&g.dequeue()()},I=async(S,Y,...L)=>{l++;const z=(async()=>S(...L))();Y(z);try{await z}catch(Te){}v()},k=(S,Y,...L)=>{g.enqueue(I.bind(null,S,Y,...L)),(async()=>(await Promise.resolve(),l<r&&g.size>0&&g.dequeue()()))()},O=(S,...Y)=>new Promise(L=>{k(S,L,...Y)});return Object.defineProperties(O,{activeCount:{get:()=>l},pendingCount:{get:()=>g.size},clearQueue:{value:()=>{g.clear()}}}),O};var pLimit_1=pLimit,W=Object.defineProperty,X$1=Object.defineProperties,V=Object.getOwnPropertyDescriptors,$=Object.getOwnPropertySymbols,q=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable,F$1=(r,g,l)=>g in r?W(r,g,{enumerable:!0,configurable:!0,writable:!0,value:l}):r[g]=l,x=(r,g)=>{for(var l in g||(g={}))q.call(g,l)&&F$1(r,l,g[l]);if($)for(var l of $(g))K.call(g,l)&&F$1(r,l,g[l]);return r},M=(r,g)=>X$1(r,V(g));const oe$1=10;function newContext(r,g=0){return{gCntIf:0,gCntEndIf:0,level:1,fCmd:!1,cmd:"",fSeekQuery:!1,buffers:{"w:p":{text:"",cmds:"",fInsertedText:!1},"w:tr":{text:"",cmds:"",fInsertedText:!1},"w:tc":{text:"",cmds:"",fInsertedText:!1}},imageAndShapeIdIncrement:g,images:{},linkId:0,links:{},htmlId:0,htmls:{},vars:{},loops:[],fJump:!1,shorthands:{},options:r,pIfCheckMap:new Map,trIfCheckMap:new Map,pendingImageDownloads:[]}}async function extractQuery(r,g){const l=newContext(g);l.fSeekQuery=!0;let v=r;for(;;){if(v._children.length)v=v._children[0];else{let k=!1;for(;v._parent!=null;){const O=v._parent,S=_$1(v);if(S){v=S,k=!0;break}v=O}if(!k)break}if(!v)break;const I=v._parent;if(v._fTextNode&&I&&!I._fTextNode&&I._tag==="w:t"&&await G(null,v,l,J$1),l.query!=null)break}return l.query}async function produceJsReport(r,g,l){return walkTemplate(r,g,l,J$1)}function findHighestImgId(r){const g=[],l=v=>{for(const I of v._children){const k=I._fTextNode?null:I._tag;if(k!=null){if(k==="wp:docPr"){if(I._fTextNode)continue;const O=I._attrs.id;if(typeof O!="string")continue;const S=Number.parseInt(O,10);Number.isSafeInteger(S)&&g.push(S)}I._children.length>0&&l(I)}}};return l(r),g.length>0?Math.max(...g):0}const P=r=>JSON.stringify(r._fTextNode?{_ifName:r._ifName,_fTextNode:r._fTextNode,_text:r==null?void 0:r._text}:{_ifName:r._ifName,_fTextNode:r._fTextNode,_tag:r==null?void 0:r._tag,_attrs:r==null?void 0:r._attrs}),H=r=>{let g=r._parent,l=null;for(;g!=null&&l==null;){if((g._fTextNode?null:g._tag)==="w:p"){const v=g._parent!=null?g._parent._parent:null;v!=null&&!v._fTextNode&&v._tag==="w:tr"?l=v:l=g}g=g._parent}return l};async function walkTemplate(r,g,l,v){var I;const k=i(g);let O=g,S=k,Y,L=0;const z=[];let Te=0;const te=((I=l.options)==null?void 0:I.maximumWalkingDepth)||1e6;for(;;){const ge=s(l);let Ee=null;if(l.fJump){if(!ge)throw new InternalError("jumping while curLoop is null");logger.debug(`Jumping to level ${ge.refNodeLevel}...`,P(ge.refNode)),L=l.level-ge.refNodeLevel,O=ge.refNode,l.level=ge.refNodeLevel,l.fJump=!1,Y="JUMP"}else if(O._children.length&&Y!=="UP")O=O._children[0],l.level+=1,Y="DOWN";else if(Ee=_$1(O))O=Ee,Y="SIDE";else{const be=O._parent;if(be==null)break;if(Te>te)throw logger.debug(`=== parent is still not null after ${Te} loops, something must be wrong ...`,P(be)),new InternalError("infinite loop or massive dataset detected. Please review and try again");O=be,l.level-=1,Y="UP"}if(logger.debug(`Next node [${Y}, level ${l.level}]`,P(O)),Y!=="DOWN"){const be=S._fTextNode?null:S._tag;let Se=!1;if((be==="w:p"||be==="w:tbl"||be==="w:tr"||be==="w:tc")&&f$1(l))Se=!0;else if(be==="w:p"||be==="w:tr"||be==="w:tc"){const Ae=l.buffers[be];Se=Ae.text===""&&Ae.cmds!==""&&!Ae.fInsertedText,be==="w:tr"&&Se&&(Se=O._children.filter(Ie=>!Ie._fTextNode&&Ie._tag==="w:tr").length!==1),be==="w:tc"&&Se&&(Se=!(S._children.filter(Ie=>!Ie._fTextNode&&Ie._tag==="w:tbl").length>0))}Se&&S._parent!=null&&S._parent._children.pop()}if(Y==="UP"){f$1(l)&&ge&&O===ge.refNode._parent&&(ge.refNode=O,ge.refNodeLevel-=1,logger.debug(`Updated loop '${ge.varName}' refNode: `+P(O)));const be=S._parent;if(be==null)throw new InternalError("node parent is null");if(S=be,l.pendingImageNode&&!S._fTextNode&&S._tag==="w:t"){const Se=l.pendingImageNode.image,Ae=l.pendingImageNode.caption,Ie=S._parent;if(Ie){Se._parent=Ie,Ie._children.pop(),Ie._children.push(Se),Ae&&Ie._children.push(...Ae);const Re=l.pendingImageDownloads[l.pendingImageDownloads.length-1];Re&&Re.drawingNode===Se&&(Re.captionParent=Ie),l.buffers["w:p"].fInsertedText=!0,l.buffers["w:tr"].fInsertedText=!0,l.buffers["w:tc"].fInsertedText=!0}delete l.pendingImageNode}if(l.pendingLinkNode&&!S._fTextNode&&S._tag==="w:r"){const Se=l.pendingLinkNode,Ae=S._parent;Ae&&(Se._parent=Ae,Ae._children.pop(),Ae._children.push(Se),l.buffers["w:p"].fInsertedText=!0,l.buffers["w:tr"].fInsertedText=!0,l.buffers["w:tc"].fInsertedText=!0),delete l.pendingLinkNode}if(l.pendingHtmlNode&&!S._fTextNode&&S._tag==="w:p"){const Se=l.pendingHtmlNode,Ae=S._parent;Ae&&(Se._parent=Ae,Ae._children.pop(),Ae._children.push(Se),l.buffers["w:p"].fInsertedText=!0,l.buffers["w:tr"].fInsertedText=!0,l.buffers["w:tc"].fInsertedText=!0),delete l.pendingHtmlNode}!S._fTextNode&&S._tag==="w:tc"&&!S._children.filter(Se=>!Se._fTextNode&&(Se._tag==="w:p"||Se._tag==="w:altChunk")).length&&S._children.push({_parent:S,_children:[],_fTextNode:!1,_tag:"w:p",_attrs:{}}),!S._fTextNode&&S._tag==="w:rPr"&&(l.textRunPropsNode=S),!O._fTextNode&&O._tag==="w:r"&&delete l.textRunPropsNode}if(Y==="DOWN"||Y==="SIDE"){if(Y==="SIDE"){if(S._parent==null)throw new InternalError("node parent is null");S=S._parent}const be=O._fTextNode?null:O._tag;(be==="w:p"||be==="w:tr"||be==="w:tc")&&(l.buffers[be]={text:"",cmds:"",fInsertedText:!1});const Se=i(O);Se._parent=S,S._children.push(Se);const Ae=Se._tag;!f$1(l)&&(Ae==="wp:docPr"||Ae==="v:shape")&&(logger.debug("detected a - ",P(Se)),ue(Se,l));const Ie=O._parent;if(O._fTextNode&&Ie&&!Ie._fTextNode&&Ie._tag==="w:t"){const Re=await G(r,O,l,v);typeof Re=="string"?(Se._text=Re,logger.debug("Inserted command result string into node. Updated node: "+P(Se))):z.push(...Re)}S=Se}if(Y==="JUMP")for(;L>0;){if(S._parent==null)throw new InternalError("node parent is null");S=S._parent,L-=1}Te++}if(l.gCntIf!==l.gCntEndIf){const ge=new IncompleteConditionalStatementError;if(l.options.failFast)throw ge;z.push(ge)}if(l.loops.filter(ge=>!ge.isIf).length>0){const ge=l.loops[l.loops.length-1],Ee=new UnterminatedForLoopError(ge);if(l.options.failFast)throw Ee;z.push(Ee)}return z.length>0?{status:"errors",errors:z}:{status:"success",report:k,images:l.images,links:l.links,htmls:l.htmls}}const G=async(r,g,l,v)=>{const{cmdDelimiter:I,failFast:k}=l.options,O=g._text;if(O==null||O==="")return"";const S=O.split(I[0]).map(z=>z.split(I[1])).reduce((z,Te)=>z.concat(Te)),Y=[],L=[];for(let z=0;z<S.length;z++){z>0&&R(I[0],l,{fCmd:!0});const Te=S[z];if(l.fCmd?l.cmd+=Te:f$1(l)||Y.push(Te),R(Te,l,{fCmd:l.fCmd}),z<S.length-1){if(l.fCmd){const te=await v(r,g,l);if(te!=null)if(typeof te=="string")Y.push(te),R(te,l,{fCmd:!1,fInsertedText:!0});else{if(k)throw te;L.push(te)}}l.fCmd=!l.fCmd}}return L.length>0?L:Y.join("")},J$1=async(r,g,l)=>{var v;const I=getCommand(l.cmd,l.shorthands,l.options.fixSmartQuotes);l.cmd="";const{cmdName:k,cmdRest:O}=splitCommand(I);try{if(k!=="CMD_NODE"&&logger.debug(`Processing cmd: ${I}`),l.fSeekQuery){k==="QUERY"&&(l.query=O);return}if(!(k==="QUERY"||k==="CMD_NODE"))if(k==="ALIAS"){const S=/^(\S+)\s+(.+)/.exec(O);if(!S)throw new InvalidCommandError("Invalid ALIAS command",I);const Y=S[1],L=S[2];l.shorthands[Y]=L,logger.debug(`Defined alias '${Y}' for: ${L}`)}else if(k==="FOR"||k==="IF")await ae$1(r,g,l,I,k,O);else if(k==="END-FOR"||k==="END-IF")le(g,l,I,k,O);else if(k==="INS"){if(!f$1(l)){let S=await runUserJsAndGetRaw(r,O,l);if(S==null)return"";if(typeof S=="object"&&!Array.isArray(S)){const L=new ObjectCommandResultError(O,S);if(l.options.errorHandler!=null)S=await l.options.errorHandler(L,O);else throw L}let Y=String(S);if(l.options.processLineBreaks){const{literalXmlDelimiter:L}=l.options;if(l.options.processLineBreaksAsNewText){const z=Y.split(`
`),Te=`${L}<w:br/>${L}`,te=`${L}</w:t>${L}`,ge=`${L}<w:t xml:space="preserve">${L}`;Y=z.join(`${te}${Te}${ge}`)}else Y=Y.replace(/\n/g,`${L}<w:br/>${L}`)}return Y}}else if(k==="EXEC")f$1(l)||await runUserJsAndGetRaw(r,O,l);else if(k==="IMAGE"){if(!f$1(l))if(l.options.imageConcurrency!=null){l.imageAndShapeIdIncrement+=1;const S=String(l.imageAndShapeIdIncrement),Y=`img${S}`,L=de(l,Y,S,I),z=l.loops.length>0,Te=z?x({},l.vars):null,te=z?(v=s(l))==null?void 0:v.idx:void 0;L.fetchImage=()=>{if(Te!==null){const ge=l.vars,Ee=s(l),be=Ee==null?void 0:Ee.idx;l.vars=Te,Ee&&te!==void 0&&(Ee.idx=te);try{return runUserJsAndGetRaw(r,O,l)}finally{l.vars=ge,Ee&&be!==void 0&&(Ee.idx=be)}}return runUserJsAndGetRaw(r,O,l)},l.pendingImageDownloads.push(L)}else{const S=await runUserJsAndGetRaw(r,O,l);if(S!=null)try{fe(l,S)}catch(Y){throw isError(Y)?new ImageError(Y,I):Y}}}else if(k==="LINK"){if(!f$1(l)){const S=await runUserJsAndGetRaw(r,O,l);S!=null&&await pe(l,S)}}else if(k==="HTML"){if(!f$1(l)){const S=await runUserJsAndGetRaw(r,O,l);S!=null&&await me(l,S)}}else throw new CommandSyntaxError(I);return}catch(S){if(!isError(S))throw S;return l.options.errorHandler!=null?l.options.errorHandler(S,O):S}},ie$1=BUILT_IN_COMMANDS.map(r=>new RegExp(`^${r}\\b`)),se$1=r=>!ie$1.some(g=>g.test(r.toUpperCase()));function getCommand(r,g,l){let v=r.trim();if(v[0]==="*"){const I=v.slice(1).trim();if(!g[I])throw new InvalidCommandError("Unknown alias",v);v=g[I]}else v[0]==="="?v=`INS ${v.slice(1).trim()}`:v[0]==="!"?v=`EXEC ${v.slice(1).trim()}`:se$1(v)&&(v=`INS ${v.trim()}`);return l&&(v=v.replace(/[\u201C\u201D\u201E]/g,'"').replace(/[\u2018\u2019\u201A]/g,"'")),v.trim()}function splitCommand(r){const g=/^(\S+)\s*/.exec(r);let l,v="";return g!=null&&(l=g[1].toUpperCase(),v=r.slice(l.length).trim()),{cmdName:l,cmdRest:v}}const ae$1=async(r,g,l,v,I,k)=>{const O=I==="IF";let S=null,Y;if(O)g._ifName||(g._ifName=`__if_${l.gCntIf}`,l.gCntIf+=1),Y=g._ifName;else{if(S=/^(\S+)\s+IN\s+(.+)/i.exec(k),!S)throw new InvalidCommandError("Invalid FOR command",v);Y=S[1]}const L=s(l);if(!(L&&L.varName===Y)){if(O&&!l.options.allowNestedIf){const ge=H(g),Ee=ge!=null?ge._fTextNode?null:ge._tag:null;if(ge!=null){if(Ee==="w:p"){if(l.pIfCheckMap.has(ge)&&l.pIfCheckMap.get(ge)!==v)throw new InvalidCommandError("Invalid IF command nested into another IF command on the same line",v);l.pIfCheckMap.set(ge,v)}else if(Ee==="w:tr"){if(l.trIfCheckMap.has(ge)&&l.trIfCheckMap.get(ge)!==v)throw new InvalidCommandError("Invalid IF command nested into another IF command on the same table row",v);l.trIfCheckMap.set(ge,v)}}}const z=l.loops.length-1,Te=z>=0&&l.loops[z].idx===-1;let te;if(Te)te=[];else if(O)te=await runUserJsAndGetRaw(r,k,l)?[1]:[];else{if(!S)throw new InvalidCommandError("Invalid FOR command",v);if(te=await runUserJsAndGetRaw(r,S[2],l),!Array.isArray(te))throw new InvalidCommandError("Invalid FOR command (can only iterate over Array)",v)}l.loops.push({refNode:g,refNodeLevel:l.level,varName:Y,loopOver:te,isIf:O,idx:-1})}h$1(l.loops)},le=(r,g,l,v,I)=>{const k=v==="END-IF",O=s(g);if(!O)throw new InvalidCommandError(`Unexpected ${v} outside of ${k?"IF statement":"FOR loop"} context`,l);const S=H(r),Y=S!=null?S._fTextNode?null:S._tag:null;Y==="w:p"?g.pIfCheckMap.delete(S):Y==="w:tr"&&g.trIfCheckMap.delete(S),k&&!r._ifName&&(r._ifName=O.varName,g.gCntEndIf+=1);const L=k?r._ifName:I;if(O.varName!==L){if(g.loops.find(te=>te.varName===L)==null){logger.debug(`Ignoring ${l} (${L}, but we're expecting ${O.varName})`);return}throw new InvalidCommandError("Invalid command",l)}const z=O.idx+1,Te=O.loopOver[z];Te!=null?(g.vars[L]=Te,g.fJump=!0,O.idx=z):g.loops.pop()},Q=(r,g)=>{E(g),r.imageAndShapeIdIncrement+=1;const l=`img${String(r.imageAndShapeIdIncrement)}`;return r.images[l]=g,l};function E(r){if(!(r.data instanceof Uint8Array||r.data instanceof ArrayBuffer||typeof r.data=="string"))throw new Error("image .data property needs to be provided as Uint8Array (e.g. Buffer), ArrayBuffer, or as a base64-encoded string");if(!ImageExtensions.includes(r.extension))throw new Error(`An extension (one of ${ImageExtensions}) needs to be provided when providing an image or a thumbnail.`)}function j(r){if(!Number.isFinite(r.width))throw new Error(`invalid image width: ${r.width} (in cm)`);if(!Number.isFinite(r.height))throw new Error(`invalid image height: ${r.height} (in cm)`);E(r),r.thumbnail&&E(r.thumbnail)}const de=(r,g,l,v)=>{const I=c$1,k=I("wp:extent",{cx:"0",cy:"0"}),O=I("a:ext",{cx:"0",cy:"0"}),S=I("a:xfrm",{},[I("a:off",{x:"0",y:"0"}),O]),Y=I("wp:docPr",{id:l,name:`Picture ${l}`,descr:""}),L=I("pic:cNvPr",{id:"0",name:`Picture ${l}`,descr:""}),z=I("a:extLst",{},[I("a:ext",{uri:"{28A0092B-C50C-407E-A947-70E740481C1C}"},[I("a14:useLocalDpi",{"xmlns:a14":"http://schemas.microsoft.com/office/drawing/2010/main",val:"0"})])]),Te=I("a:blip",{"r:embed":g,cstate:"print"},[z]),te=I("pic:pic",{"xmlns:pic":"http://schemas.openxmlformats.org/drawingml/2006/picture"},[I("pic:nvPicPr",{},[L,I("pic:cNvPicPr",{},[I("a:picLocks",{noChangeAspect:"1",noChangeArrowheads:"1"})])]),I("pic:blipFill",{},[Te,I("a:srcRect"),I("a:stretch",{},[I("a:fillRect")])]),I("pic:spPr",{bwMode:"auto"},[S,I("a:prstGeom",{prst:"rect"},[I("a:avLst")]),I("a:noFill"),I("a:ln",{},[I("a:noFill")])])]),ge=I("w:drawing",{},[I("wp:inline",{distT:"0",distB:"0",distL:"0",distR:"0"},[k,Y,I("wp:cNvGraphicFramePr",{},[I("a:graphicFrameLocks",{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main",noChangeAspect:"1"})]),I("a:graphic",{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},[I("a:graphicData",{uri:"http://schemas.openxmlformats.org/drawingml/2006/picture"},[te])])])]);return r.pendingImageNode={image:ge},{id:g,fetchImage:()=>Promise.resolve(void 0),cmd:v,extentNode:k,picExtNode:O,xfrmNode:S,blipNode:Te,extLstNode:z,docPrNode:Y,cNvPrNode:L,drawingNode:ge}};async function resolvePendingImages(r,g=oe$1){var l;const v=r.pendingImageDownloads;if(v.length===0)return;logger.debug(`Resolving ${v.length} pending image downloads with concurrency limit of ${g}...`);const I=pLimit_1(g),k=await Promise.allSettled(v.map(O=>I(()=>O.fetchImage())));for(let O=0;O<k.length;O++){const S=k[O],Y=v[O];if(S.status==="rejected"){const z=S.reason;if(r.options.errorHandler!=null)await r.options.errorHandler(z instanceof Error?z:new Error(String(z)),Y.cmd);else if(r.options.failFast)throw new ImageError(z instanceof Error?z:new Error(String(z)),Y.cmd);continue}const L=S.value;if(L!=null)try{j(L);const z=(L.width*36e4).toFixed(0),Te=(L.height*36e4).toFixed(0);if(Y.extentNode&&(Y.extentNode._attrs.cx=z,Y.extentNode._attrs.cy=Te),Y.picExtNode&&(Y.picExtNode._attrs.cx=z,Y.picExtNode._attrs.cy=Te),L.rotation&&Y.xfrmNode){const Ee=(L.rotation*6e4).toString();Y.xfrmNode._attrs.rot=Ee}const te=L.alt||"";Y.docPrNode&&(Y.docPrNode._attrs.descr=te),Y.cNvPrNode&&(Y.cNvPrNode._attrs.descr=te);const ge=A(L);if(E(ge),ge.extension===".svg"){const Ee=(l=L.thumbnail)!=null?l:{data:"bm90aGluZwo=",extension:".png"};r.images[Y.id]=ge,r.imageAndShapeIdIncrement+=1;const be=`img${String(r.imageAndShapeIdIncrement)}`;if(E(Ee),r.images[be]=Ee,Y.extLstNode){const Se=c$1("asvg:svgBlip",{"xmlns:asvg":"http://schemas.microsoft.com/office/drawing/2016/SVG/main","r:embed":Y.id}),Ae=c$1("a:ext",{uri:"{96DAC541-7B7A-43D3-8B79-37D633B846F1}"},[Se]);Ae._parent=Y.extLstNode,Se._parent=Ae,Y.extLstNode._children.push(Ae)}Y.blipNode&&(Y.blipNode._attrs["r:embed"]=be)}else r.images[Y.id]=ge;if(L.caption&&Y.captionParent){const Ee=c$1("w:br",{}),be=u(L.caption),Se=c$1("w:t",{},[be]);Ee._parent=Y.captionParent,Se._parent=Y.captionParent,be._parent=Se,Y.captionParent._children.push(Ee),Y.captionParent._children.push(Se)}}catch(z){if(!isError(z))throw z;if(r.options.errorHandler!=null)await r.options.errorHandler(z,Y.cmd);else if(r.options.failFast)throw new ImageError(z,Y.cmd)}}r.pendingImageDownloads=[]}function A(r){const{data:g,extension:l}=r;if(!l)throw new Error("If you return image `data`, make sure you return an extension as well!");return{extension:l,data:g}}const fe=(r,g,l)=>{var v;j(g);const I=(g.width*36e4).toFixed(0),k=(g.height*36e4).toFixed(0);let O,S;if(l){O=l,S=l.replace("img","");const Ee=A(g);E(Ee),r.images[O]=Ee}else O=Q(r,A(g)),S=String(r.imageAndShapeIdIncrement);const Y=g.alt||"",L=c$1,z=[];z.push(L("a:ext",{uri:"{28A0092B-C50C-407E-A947-70E740481C1C}"},[L("a14:useLocalDpi",{"xmlns:a14":"http://schemas.microsoft.com/office/drawing/2010/main",val:"0"})]));const Te=g.rotation?(g.rotation*6e4).toString():void 0;if(r.images[O].extension===".svg"){const Ee=(v=g.thumbnail)!=null?v:{data:"bm90aGluZwo=",extension:".png"},be=Q(r,Ee);z.push(L("a:ext",{uri:"{96DAC541-7B7A-43D3-8B79-37D633B846F1}"},[L("asvg:svgBlip",{"xmlns:asvg":"http://schemas.microsoft.com/office/drawing/2016/SVG/main","r:embed":O})])),O=be}const te=L("pic:pic",{"xmlns:pic":"http://schemas.openxmlformats.org/drawingml/2006/picture"},[L("pic:nvPicPr",{},[L("pic:cNvPr",{id:"0",name:`Picture ${S}`,descr:Y}),L("pic:cNvPicPr",{},[L("a:picLocks",{noChangeAspect:"1",noChangeArrowheads:"1"})])]),L("pic:blipFill",{},[L("a:blip",{"r:embed":O,cstate:"print"},[L("a:extLst",{},z)]),L("a:srcRect"),L("a:stretch",{},[L("a:fillRect")])]),L("pic:spPr",{bwMode:"auto"},[L("a:xfrm",Te?{rot:Te}:{},[L("a:off",{x:"0",y:"0"}),L("a:ext",{cx:I,cy:k})]),L("a:prstGeom",{prst:"rect"},[L("a:avLst")]),L("a:noFill"),L("a:ln",{},[L("a:noFill")])])]),ge=L("w:drawing",{},[L("wp:inline",{distT:"0",distB:"0",distL:"0",distR:"0"},[L("wp:extent",{cx:I,cy:k}),L("wp:docPr",{id:S,name:`Picture ${S}`,descr:Y}),L("wp:cNvGraphicFramePr",{},[L("a:graphicFrameLocks",{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main",noChangeAspect:"1"})]),L("a:graphic",{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},[L("a:graphicData",{uri:"http://schemas.openxmlformats.org/drawingml/2006/picture"},[te])])])]);r.pendingImageNode={image:ge},g.caption&&(r.pendingImageNode.caption=[L("w:br"),L("w:t",{},[u(g.caption)])])},pe=async(r,g)=>{const{url:l,label:v=l}=g;r.linkId+=1;const I=`link${String(r.linkId)}`;r.links[I]={url:l};const k=c$1,{textRunPropsNode:O}=r,S=k("w:hyperlink",{"r:id":I,"w:history":"1"},[k("w:r",{},[O||k("w:rPr",{},[k("w:u",{"w:val":"single"})]),k("w:t",{},[u(v)])])]);r.pendingLinkNode=S},me=async(r,g)=>{r.htmlId+=1;const l=`html${String(r.htmlId)}`;r.htmls[l]=g;const v=c$1("w:altChunk",{"r:id":l});r.pendingHtmlNode=v},ce=["w:p","w:tr","w:tc"],R=(r,g,l)=>{if(g.fSeekQuery)return;const{fCmd:v,fInsertedText:I}=l,k=v?"cmds":"text";ce.forEach(O=>{const S=g.buffers[O];S[k]+=r,I&&(S.fInsertedText=!0)})};function ue(r,g){g.imageAndShapeIdIncrement+=1;const l=String(g.imageAndShapeIdIncrement);r._attrs=M(x({},r._attrs),{id:`${l}`})}const ne="+++",X="||",J="[Content_Types].xml",f="word",he=new RegExp(`${f}\\/[^\\/]+\\.xml`);async function parseTemplate(r){const g=await t(r),l=await readContentTypes(g),v=getMainDoc(l),I=`${f}/${v}`,k=await s$1(g,I);if(k==null)throw new TemplateParseError(`${v} could not be found`);logger.debug(`${I} file length: ${k.length}`),new Date().getTime();const O=await _$2(k);return new Date().getTime(),{jsTemplate:O,mainDocument:v,zip:g,contentTypes:l}}async function re(r,g,l){const v=[];r.forEach(async k=>{he.test(k)&&k!==`${f}/${g}`&&k.indexOf(`${f}/template`)!==0&&v.push(k)}),v.sort();const I=[];for(const k of v){const O=await s$1(r,k);if(O==null)throw new TemplateParseError(`${k} could not be read`);logger.debug(`${k} file length: ${O.length}`);const S=await _$2(O),Y=p(S,l.cmdDelimiter,l.preserveSpace);I.push([Y,k])}return I}async function ye(r,g){var l,v,I,k,O;const{template:S,data:Y,queryVars:L}=r,z=r.literalXmlDelimiter||X,Te={cmdDelimiter:ie(r.cmdDelimiter),literalXmlDelimiter:z,processLineBreaks:r.processLineBreaks!=null?r.processLineBreaks:!0,noSandbox:r.noSandbox||!1,runJs:r.runJs,additionalJsContext:r.additionalJsContext||{},failFast:r.failFast==null?!0:r.failFast,rejectNullish:r.rejectNullish==null?!1:r.rejectNullish,errorHandler:typeof r.errorHandler=="function"?r.errorHandler:null,fixSmartQuotes:r.fixSmartQuotes==null?!1:r.fixSmartQuotes,processLineBreaksAsNewText:r.processLineBreaksAsNewText==null?!1:r.processLineBreaksAsNewText,maximumWalkingDepth:r.maximumWalkingDepth,indentXml:(l=r.indentXml)!=null?l:!0,preserveSpace:(v=r.preserveSpace)!=null?v:!0,compressionLevel:(I=r.compressionLevel)!=null?I:1,allowNestedIf:(k=r.allowNestedIf)!=null?k:!1,imageConcurrency:(O=r.imageConcurrency)!=null?O:10},te={literalXmlDelimiter:z,indentXml:Te.indentXml},{jsTemplate:ge,mainDocument:Ee,zip:be,contentTypes:Se}=await parseTemplate(S),Ae=p(ge,Te.cmdDelimiter,Te.preserveSpace);let Ie=null;if(typeof Y=="function"){const Ge=await extractQuery(Ae,Te);Ie=await Y(Ge,L)}else Ie=Y;const Re=await re(be,Ee,Te),ke=Math.max(...Re.map(([Ge,tt])=>findHighestImgId(Ge)),findHighestImgId(Ae));let De=newContext(Te,ke);const Le=await produceJsReport(Ie,Ae,De);if(Le.status==="errors")throw Le.errors;Te.imageConcurrency!=null&&await resolvePendingImages(De,Te.imageConcurrency);const{report:Be,images:Fe,links:ve,htmls:Ze}=Le;if(g==="JS")return Be;const Oe=m$1(Be,te);if(g==="XML")return Oe.toString("utf-8");o(be,`${f}/${Ee}`,Oe);let Me=Object.keys(Fe).length,et=Object.keys(Ze).length;await se(Fe,Ee,be,Te.indentXml),await oe(ve,Ee,be,Te.indentXml),await ae(Ze,Ee,be,Te.indentXml);for(const[Ge,tt]of Re){De=newContext(Te,De.imageAndShapeIdIncrement);const rt=await produceJsReport(Ie,Ge,De);if(rt.status==="errors")throw rt.errors;Te.imageConcurrency!=null&&await resolvePendingImages(De,Te.imageConcurrency);const{report:Ue,images:it,links:st,htmls:lt}=rt,He=m$1(Ue,te);o(be,tt,He),Me+=Object.keys(it).length,et+=Object.keys(lt).length;const qe=tt.split("/"),dt=qe[qe.length-1];await se(it,dt,be,Te.indentXml),await oe(st,Ee,be,Te.indentXml),await ae(lt,Ee,be,Te.indentXml)}if(Me||et){const Ge=(rt,Ue)=>{Se._children.filter(it=>{var st;return!it._fTextNode&&((st=it._attrs.Extension)==null?void 0:st.toLowerCase())===(rt==null?void 0:rt.toLowerCase())}).length||p$1(Se,c$1("Default",{Extension:rt,ContentType:Ue}))};Me&&(Ge("png","image/png"),Ge("jpg","image/jpeg"),Ge("jpeg","image/jpeg"),Ge("gif","image/gif"),Ge("bmp","image/bmp"),Ge("svg","image/svg+xml")),et&&Ge("html","text/html");const tt=m$1(Se,te);o(be,J,tt)}return await p$2(be,Te.compressionLevel)}async function listCommands(r,g){const l={cmdDelimiter:ie(g),literalXmlDelimiter:X,processLineBreaks:!0,noSandbox:!1,additionalJsContext:{},failFast:!1,rejectNullish:!1,errorHandler:null,fixSmartQuotes:!1,processLineBreaksAsNewText:!1,indentXml:!0,preserveSpace:!0,compressionLevel:1,allowNestedIf:!1,imageConcurrency:10},{jsTemplate:v,mainDocument:I,zip:k}=await parseTemplate(r),O=await re(k,I,l),S=[v,...O.map(([L,z])=>L)],Y=[];for(const L of S){const z=p(L,l.cmdDelimiter,l.preserveSpace),Te=newContext(l);await walkTemplate(void 0,z,Te,async(te,ge,Ee)=>{const be=getCommand(Ee.cmd,Ee.shorthands,Ee.options.fixSmartQuotes);Ee.cmd="";const{cmdName:Se,cmdRest:Ae}=splitCommand(be),Ie=Se;Ie!=null&&Ie!=="CMD_NODE"&&Y.push({raw:be,type:Ie,code:Ae})})}return Y}async function getMetadata(r){const g="docProps/app.xml",l="docProps/core.xml",v=await t(r),I=await B(v,g),k=await B(v,l);function O(L){if(L._children.length===0)return;const z=L._children[0];if(z._fTextNode)return z._text;throw new Error("Not a text node")}function S(L,z){for(const Te of L._children)if(!Te._fTextNode&&Te._tag===z)return O(Te)}const Y=L=>{const z=Number(L);if(Number.isFinite(z))return z};return{pages:Y(S(I,"Pages")),words:Y(S(I,"Words")),characters:Y(S(I,"Characters")),lines:Y(S(I,"Lines")),paragraphs:Y(S(I,"Paragraphs")),company:S(I,"Company"),template:S(I,"Template"),title:S(k,"dc:title"),subject:S(k,"dc:subject"),creator:S(k,"dc:creator"),description:S(k,"dc:description"),lastModifiedBy:S(k,"cp:lastModifiedBy"),revision:S(k,"cp:revision"),lastPrinted:S(k,"cp:lastPrinted"),created:S(k,"dcterms:created"),modified:S(k,"dcterms:modified"),category:S(k,"cp:category")}}async function B(r,g){const l=await s$1(r,g);if(l==null)throw new TemplateParseError(`${g} could not be read`);const v=await _$2(l);if(v._fTextNode)throw new TemplateParseError(`${g} is a text node when parsed`);return v}async function readContentTypes(r){return await B(r,J)}function getMainDoc(r){const g=["application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","application/vnd.ms-word.document.macroEnabled.main+xml"];for(const l of r._children)if(!l._fTextNode&&l._attrs.ContentType!=null&&g.includes(l._attrs.ContentType)){const v=l._attrs.PartName;if(v)return v.replace("/word/","")}throw new TemplateParseError(`Could not find main document (e.g. document.xml) in ${J}`)}const se=async(r,g,l,v)=>{const I=Object.keys(r);if(!I.length)return;const k=`${f}/_rels/${g}.rels`,O=await F(l,k);for(const Y of I){const{extension:L,data:z}=r[Y],Te=`template_${g}_${Y}${L}`,te=`${f}/media/${Te}`;typeof z=="string"?l.file(te,z,{base64:!0}):l.file(te,z,{binary:!0}),p$1(O,c$1("Relationship",{Id:Y,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`media/${Te}`})),delete r[Y]}const S=m$1(O,{literalXmlDelimiter:X,indentXml:v});o(l,k,S)},oe=async(r,g,l,v)=>{const I=Object.keys(r);if(I.length){const k=`${f}/_rels/${g}.rels`,O=await F(l,k);for(const Y of I){const{url:L}=r[Y];p$1(O,c$1("Relationship",{Id:Y,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Target:L,TargetMode:"External"}))}const S=m$1(O,{literalXmlDelimiter:X,indentXml:v});o(l,k,S)}},ae=async(r,g,l,v)=>{const I=Object.keys(r);if(I.length){const k=`${f}/_rels/${g}.rels`,O=await F(l,k);for(const Y of I){const L=r[Y],z=`template_${g.replace(/\./g,"_")}_${Y}.html`,Te=`${f}/${z}`;o(l,Te,Buffer.from(L)),p$1(O,c$1("Relationship",{Id:Y,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk",Target:`${z}`}))}const S=m$1(O,{literalXmlDelimiter:X,indentXml:v});o(l,k,S)}},F=async(r,g)=>{let l=await s$1(r,g);return l||(l=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
        <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
        </Relationships>`),_$2(l)},ie=r=>r?typeof r=="string"?[r,r]:r:[ne,ne];export{CommandExecutionError,CommandSyntaxError,ImageError,IncompleteConditionalStatementError,InternalError,InvalidCommandError,NullishCommandResultError,ObjectCommandResultError,TemplateParseError,UnterminatedForLoopError,ye as createReport,getMetadata,isError,listCommands};
//# sourceMappingURL=browser.js.map
